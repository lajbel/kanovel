var kanovel=(()=>{var Oa=Object.defineProperty;var s=(i,E)=>Oa(i,"name",{value:E,configurable:!0});var Ka=Object.defineProperty,A=s((i,E)=>Ka(i,"name",{value:E,configurable:!0}),"s"),Ds=Object.defineProperty,La=A((i,E,y)=>E in i?Ds(i,E,{enumerable:!0,configurable:!0,writable:!0,value:y}):i[E]=y,"cs"),V=A((i,E)=>Ds(i,"name",{value:E,configurable:!0}),"u"),Ja=A((i,E)=>{for(var y in E)Ds(i,y,{get:E[y],enumerable:!0})},"ls"),Jt=A((i,E,y)=>(La(i,typeof E!="symbol"?E+"":E,y),y),"Z"),za=(()=>{for(var i=new Uint8Array(128),E=0;E<64;E++)i[E<26?E+65:E<52?E+71:E<62?E-4:E*4-205]=E;return y=>{for(var v=y.length,h=new Uint8Array((v-(y[v-1]=="=")-(y[v-2]=="="))*3/4|0),P=0,W=0;P<v;){var _=i[y.charCodeAt(P++)],j=i[y.charCodeAt(P++)],ee=i[y.charCodeAt(P++)],Ae=i[y.charCodeAt(P++)];h[W++]=_<<2|j>>4,h[W++]=j<<4|ee>>2,h[W++]=ee<<6|Ae}return h}})();function Or(i){return i*Math.PI/180}s(Or,"vt");A(Or,"me");V(Or,"deg2rad");function bo(i){return i*180/Math.PI}s(bo,"Br");A(bo,"Bt");V(bo,"rad2deg");function Ft(i,E,y){return E>y?Ft(i,y,E):Math.min(Math.max(i,E),y)}s(Ft,"ot");A(Ft,"te");V(Ft,"clamp");function en(i,E,y){return i+(E-i)*y}s(en,"Qt");A(en,"ze");V(en,"lerp");function Wn(i,E,y,v,h){return v+(i-E)/(y-E)*(h-v)}s(Wn,"Fe");A(Wn,"dt");V(Wn,"map");function qs(i,E,y,v,h){return Ft(Wn(i,E,y,v,h),v,h)}s(qs,"Ii");A(qs,"qn");V(qs,"mapc");var mt=A(class{x=0;y=0;constructor(i=0,E=i){this.x=i,this.y=E}static fromAngle(i){let E=Or(i);return new mt(Math.cos(E),Math.sin(E))}clone(){return new mt(this.x,this.y)}add(...i){let E=B(...i);return new mt(this.x+E.x,this.y+E.y)}sub(...i){let E=B(...i);return new mt(this.x-E.x,this.y-E.y)}scale(...i){let E=B(...i);return new mt(this.x*E.x,this.y*E.y)}dist(...i){let E=B(...i);return Math.sqrt((this.x-E.x)*(this.x-E.x)+(this.y-E.y)*(this.y-E.y))}len(){return this.dist(new mt(0,0))}unit(){let i=this.len();return i===0?new mt(0):this.scale(1/i)}normal(){return new mt(this.y,-this.x)}dot(i){return this.x*i.x+this.y*i.y}angle(...i){let E=B(...i);return bo(Math.atan2(this.y-E.y,this.x-E.x))}lerp(i,E){return new mt(en(this.x,i.x,E),en(this.y,i.y,E))}isZero(){return this.x===0&&this.y===0}toFixed(i){return new mt(Number(this.x.toFixed(i)),Number(this.y.toFixed(i)))}eq(i){return this.x===i.x&&this.y===i.y}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}},"H"),Oe=mt;V(Oe,"Vec2"),Jt(Oe,"LEFT",new mt(-1,0)),Jt(Oe,"RIGHT",new mt(1,0)),Jt(Oe,"UP",new mt(0,-1)),Jt(Oe,"DOWN",new mt(0,1));function B(...i){if(i.length===1){if(i[0]instanceof Oe)return B(i[0].x,i[0].y);if(Array.isArray(i[0])&&i[0].length===2)return B(...i[0])}return new Oe(...i)}s(B,"p");A(B,"f");V(B,"vec2");var Os=A(class{x=0;y=0;z=0;constructor(i,E,y){this.x=i,this.y=E,this.z=y}xy(){return B(this.x,this.y)}},"je");V(Os,"Vec3");var Hi=V((i,E,y)=>new Os(i,E,y),"vec3"),Dr=A(class{r=255;g=255;b=255;constructor(i,E,y){this.r=Ft(i,0,255),this.g=Ft(E,0,255),this.b=Ft(y,0,255)}static fromArray(i){return new Dr(i[0],i[1],i[2])}static fromHex(i){if(typeof i=="number")return new Dr(i>>16&255,i>>8&255,i>>0&255);{let E=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);return new Dr(parseInt(E[1],16),parseInt(E[2],16),parseInt(E[3],16))}}static fromHSL(i,E,y){if(E==0)return ie(255*y,255*y,255*y);let v=V((ee,Ae,p)=>(p<0&&(p+=1),p>1&&(p-=1),p<1/6?ee+(Ae-ee)*6*p:p<1/2?Ae:p<2/3?ee+(Ae-ee)*(2/3-p)*6:ee),"hue2rgb"),h=y<.5?y*(1+E):y+E-y*E,P=2*y-h,W=v(P,h,i+1/3),_=v(P,h,i),j=v(P,h,i-1/3);return new Dr(Math.round(W*255),Math.round(_*255),Math.round(j*255))}clone(){return new Dr(this.r,this.g,this.b)}lighten(i){return new Dr(this.r+i,this.g+i,this.b+i)}darken(i){return this.lighten(-i)}invert(){return new Dr(255-this.r,255-this.g,255-this.b)}mult(i){return new Dr(this.r*i.r/255,this.g*i.g/255,this.b*i.b/255)}eq(i){return this.r===i.r&&this.g===i.g&&this.b===i.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}toHex(){return"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}},"se"),le=Dr;V(le,"Color"),Jt(le,"RED",ie(255,0,0)),Jt(le,"GREEN",ie(0,255,0)),Jt(le,"BLUE",ie(0,0,255)),Jt(le,"YELLOW",ie(255,255,0)),Jt(le,"MAGENTA",ie(255,0,255)),Jt(le,"CYAN",ie(0,255,255)),Jt(le,"WHITE",ie(255,255,255)),Jt(le,"BLACK",ie(0,0,0));function ie(...i){if(i.length===0)return new le(255,255,255);if(i.length===1){if(i[0]instanceof le)return i[0].clone();if(Array.isArray(i[0])&&i[0].length===3)return le.fromArray(i[0])}return new le(...i)}s(ie,"T");A(ie,"x");V(ie,"rgb");var Ya=V((i,E,y)=>le.fromHSL(i,E,y),"hsl2rgb"),ht=A(class{x=0;y=0;w=1;h=1;constructor(i,E,y,v){this.x=i,this.y=E,this.w=y,this.h=v}scale(i){return new ht(this.x+this.w*i.x,this.y+this.h*i.y,this.w*i.w,this.h*i.h)}clone(){return new ht(this.x,this.y,this.w,this.h)}eq(i){return this.x===i.x&&this.y===i.y&&this.w===i.w&&this.h===i.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}},"j");V(ht,"Quad");function Ks(i,E,y,v){return new ht(i,E,y,v)}s(Ks,"Ni");A(Ks,"Hn");V(Ks,"quad");var Pe=A(class{m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];constructor(i){i&&(this.m=i)}static translate(i){return new Pe([1,0,0,0,0,1,0,0,0,0,1,0,i.x,i.y,0,1])}static scale(i){return new Pe([i.x,0,0,0,0,i.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(i){return i=Or(-i),new Pe([1,0,0,0,0,Math.cos(i),-Math.sin(i),0,0,Math.sin(i),Math.cos(i),0,0,0,0,1])}static rotateY(i){return i=Or(-i),new Pe([Math.cos(i),0,Math.sin(i),0,0,1,0,0,-Math.sin(i),0,Math.cos(i),0,0,0,0,1])}static rotateZ(i){return i=Or(-i),new Pe([Math.cos(i),-Math.sin(i),0,0,Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1])}translate(i){return this.mult(Pe.translate(i))}scale(i){return this.mult(Pe.scale(i))}rotateX(i){return this.mult(Pe.rotateX(i))}rotateY(i){return this.mult(Pe.rotateY(i))}rotateZ(i){return this.mult(Pe.rotateZ(i))}mult(i){let E=[];for(let y=0;y<4;y++)for(let v=0;v<4;v++)E[y*4+v]=this.m[0*4+v]*i.m[y*4+0]+this.m[1*4+v]*i.m[y*4+1]+this.m[2*4+v]*i.m[y*4+2]+this.m[3*4+v]*i.m[y*4+3];return new Pe(E)}multVec4(i){return{x:i.x*this.m[0]+i.y*this.m[4]+i.z*this.m[8]+i.w*this.m[12],y:i.x*this.m[1]+i.y*this.m[5]+i.z*this.m[9]+i.w*this.m[13],z:i.x*this.m[2]+i.y*this.m[6]+i.z*this.m[10]+i.w*this.m[14],w:i.x*this.m[3]+i.y*this.m[7]+i.z*this.m[11]+i.w*this.m[15]}}multVec3(i){let E=this.multVec4({x:i.x,y:i.y,z:i.z,w:1});return Hi(E.x,E.y,E.z)}multVec2(i){return B(i.x*this.m[0]+i.y*this.m[4]+0*this.m[8]+1*this.m[12],i.x*this.m[1]+i.y*this.m[5]+0*this.m[9]+1*this.m[13])}invert(){let i=[],E=this.m[10]*this.m[15]-this.m[14]*this.m[11],y=this.m[9]*this.m[15]-this.m[13]*this.m[11],v=this.m[9]*this.m[14]-this.m[13]*this.m[10],h=this.m[8]*this.m[15]-this.m[12]*this.m[11],P=this.m[8]*this.m[14]-this.m[12]*this.m[10],W=this.m[8]*this.m[13]-this.m[12]*this.m[9],_=this.m[6]*this.m[15]-this.m[14]*this.m[7],j=this.m[5]*this.m[15]-this.m[13]*this.m[7],ee=this.m[5]*this.m[14]-this.m[13]*this.m[6],Ae=this.m[4]*this.m[15]-this.m[12]*this.m[7],p=this.m[4]*this.m[14]-this.m[12]*this.m[6],q=this.m[5]*this.m[15]-this.m[13]*this.m[7],se=this.m[4]*this.m[13]-this.m[12]*this.m[5],Se=this.m[6]*this.m[11]-this.m[10]*this.m[7],Je=this.m[5]*this.m[11]-this.m[9]*this.m[7],it=this.m[5]*this.m[10]-this.m[9]*this.m[6],Be=this.m[4]*this.m[11]-this.m[8]*this.m[7],K=this.m[4]*this.m[10]-this.m[8]*this.m[6],ne=this.m[4]*this.m[9]-this.m[8]*this.m[5];i[0]=this.m[5]*E-this.m[6]*y+this.m[7]*v,i[4]=-(this.m[4]*E-this.m[6]*h+this.m[7]*P),i[8]=this.m[4]*y-this.m[5]*h+this.m[7]*W,i[12]=-(this.m[4]*v-this.m[5]*P+this.m[6]*W),i[1]=-(this.m[1]*E-this.m[2]*y+this.m[3]*v),i[5]=this.m[0]*E-this.m[2]*h+this.m[3]*P,i[9]=-(this.m[0]*y-this.m[1]*h+this.m[3]*W),i[13]=this.m[0]*v-this.m[1]*P+this.m[2]*W,i[2]=this.m[1]*_-this.m[2]*j+this.m[3]*ee,i[6]=-(this.m[0]*_-this.m[2]*Ae+this.m[3]*p),i[10]=this.m[0]*q-this.m[1]*Ae+this.m[3]*se,i[14]=-(this.m[0]*ee-this.m[1]*p+this.m[2]*se),i[3]=-(this.m[1]*Se-this.m[2]*Je+this.m[3]*it),i[7]=this.m[0]*Se-this.m[2]*Be+this.m[3]*K,i[11]=-(this.m[0]*Je-this.m[1]*Be+this.m[3]*ne),i[15]=this.m[0]*it-this.m[1]*K+this.m[2]*ne;let _e=this.m[0]*i[0]+this.m[1]*i[4]+this.m[2]*i[8]+this.m[3]*i[12];for(let ye=0;ye<4;ye++)for(let ue=0;ue<4;ue++)i[ye*4+ue]*=1/_e;return new Pe(i)}clone(){return new Pe(this.m)}toString(){return this.m.toString()}},"A");V(Pe,"Mat4");function vo(i,E,y,v=Math.sin){return i+(v(y)+1)/2*(E-i)}s(vo,"Sr");A(vo,"Vt");V(vo,"wave");var Ga=1103515245,Qa=12345,ua=2147483648,Ls=A(class{seed;constructor(i){this.seed=i}gen(){return this.seed=(Ga*this.seed+Qa)%ua,this.seed/ua}genNumber(i,E){return i+this.gen()*(E-i)}genVec2(i,E){return new Oe(this.genNumber(i.x,E.x),this.genNumber(i.y,E.y))}genColor(i,E){return new le(this.genNumber(i.r,E.r),this.genNumber(i.g,E.g),this.genNumber(i.b,E.b))}genAny(...i){if(i.length===0)return this.gen();if(i.length===1){if(typeof i[0]=="number")return this.genNumber(0,i[0]);if(i[0]instanceof Oe)return this.genVec2(B(0,0),i[0]);if(i[0]instanceof le)return this.genColor(ie(0,0,0),i[0])}else if(i.length===2){if(typeof i[0]=="number"&&typeof i[1]=="number")return this.genNumber(i[0],i[1]);if(i[0]instanceof Oe&&i[1]instanceof Oe)return this.genVec2(i[0],i[1]);if(i[0]instanceof le&&i[1]instanceof le)return this.genColor(i[0],i[1])}}},"ke");V(Ls,"RNG");var Is=new Ls(Date.now());function Js(i){return i!=null&&(Is.seed=i),Is.seed}s(Js,"Di");A(Js,"$n");V(Js,"randSeed");function Fn(...i){return Is.genAny(...i)}s(Fn,"le");A(Fn,"et");V(Fn,"rand");function So(...i){return Math.floor(Fn(...i))}s(So,"Cr");A(So,"Gt");V(So,"randi");function zs(i){return Fn()<=i}s(zs,"Oi");A(zs,"Yn");V(zs,"chance");function Ys(i){return i[So(i.length)]}s(Ys,"qi");A(Ys,"Xn");V(Ys,"choose");function Gs(i,E){return i.pos.x+i.width>E.pos.x&&i.pos.x<E.pos.x+E.width&&i.pos.y+i.height>E.pos.y&&i.pos.y<E.pos.y+E.height}s(Gs,"Ki");A(Gs,"Kn");V(Gs,"testRectRect");function Qs(i,E){if(i.p1.x===i.p2.x&&i.p1.y===i.p2.y||E.p1.x===E.p2.x&&E.p1.y===E.p2.y)return null;let y=(E.p2.y-E.p1.y)*(i.p2.x-i.p1.x)-(E.p2.x-E.p1.x)*(i.p2.y-i.p1.y);if(y===0)return null;let v=((E.p2.x-E.p1.x)*(i.p1.y-E.p1.y)-(E.p2.y-E.p1.y)*(i.p1.x-E.p1.x))/y,h=((i.p2.x-i.p1.x)*(i.p1.y-E.p1.y)-(i.p2.y-i.p1.y)*(i.p1.x-E.p1.x))/y;return v<0||v>1||h<0||h>1?null:v}s(Qs,"ki");A(Qs,"ms");V(Qs,"testLineLineT");function _i(i,E){let y=Qs(i,E);return y?B(i.p1.x+y*(i.p2.x-i.p1.x),i.p1.y+y*(i.p2.y-i.p1.y)):null}s(_i,"Yt");A(_i,"Ne");V(_i,"testLineLine");function js(i,E){if(tn(i,E.p1)||tn(i,E.p2))return!0;let y=i.points();return!!_i(E,new $i(y[0],y[1]))||!!_i(E,new $i(y[1],y[2]))||!!_i(E,new $i(y[2],y[3]))||!!_i(E,new $i(y[3],y[0]))}s(js,"Li");A(js,"Qn");V(js,"testRectLine");function tn(i,E){return E.x>i.pos.x&&E.x<i.pos.x+i.width&&E.y>i.pos.y&&E.y<i.pos.y+i.height}s(tn,"Ht");A(tn,"He");V(tn,"testRectPoint");function Zs(i,E){return i.center.dist(E)<i.radius}s(Zs,"Ji");A(Zs,"Jn");V(Zs,"testCirclePoint");function Xs(i,E){let y=!1,v=i.pts;for(let h=0,P=v.length-1;h<v.length;P=h++)v[h].y>E.y!=v[P].y>E.y&&E.x<(v[P].x-v[h].x)*(E.y-v[h].y)/(v[P].y-v[h].y)+v[h].x&&(y=!y);return y}s(Xs,"zi");A(Xs,"Zn");V(Xs,"testPolygonPoint");var $i=A(class{p1;p2;constructor(i,E){this.p1=i,this.p2=E}transform(i){return new $i(i.multVec2(this.p1),i.multVec2(this.p2))}bbox(){return rt.fromPoints(this.p1,this.p2)}},"ie");V($i,"Line");var rt=A(class{pos;width;height;constructor(i,E,y){this.pos=i,this.width=E,this.height=y}static fromPoints(i,E){return new rt(i.clone(),E.x-i.x,E.y-i.y)}center(){return new Oe(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(i){return new Tn(this.points().map(E=>i.multVec2(E)))}bbox(){return new rt(this.pos.clone(),this.width,this.height)}distToPoint(i){let E=this.pos,y=this.pos.add(this.width,this.height),v=Math.max(E.x-i.x,0,i.x-y.x),h=Math.max(E.y-i.y,0,i.y-y.y);return Math.sqrt(v*v+h*h)}},"I");V(rt,"Rect");var Qn=A(class{center;radius;constructor(i,E){this.center=i,this.radius=E}transform(i){return new Hs(this.center,this.radius,this.radius).transform(i)}bbox(){return rt.fromPoints(this.center.sub(B(this.radius)),this.center.add(B(this.radius)))}},"pe");V(Qn,"Circle");var Hs=A(class{center;radiusX;radiusY;constructor(i,E,y){this.center=i,this.radiusX=E,this.radiusY=y}transform(i){return new Hs(i.multVec2(this.center),i.m[0]*this.radiusX,i.m[5]*this.radiusY)}bbox(){return rt.fromPoints(this.center.sub(B(this.radiusX,this.radiusY)),this.center.add(B(this.radiusX,this.radiusY)))}},"_e");V(Hs,"Ellipse");var Tn=A(class{pts;constructor(i){if(i.length<3)throw new Error("Polygons should have at least 3 vertices");this.pts=i}transform(i){return new Tn(this.pts.map(E=>i.multVec2(E)))}bbox(){let i=B(Number.MAX_VALUE),E=B(-Number.MAX_VALUE);for(let y of this.pts)i.x=Math.min(i.x,y.x),E.x=Math.max(E.x,y.x),i.y=Math.min(i.y,y.y),E.y=Math.max(E.y,y.y);return rt.fromPoints(i,E)}},"oe");V(Tn,"Polygon");function Ws(i,E){let y=Number.MAX_VALUE,v=B(0);for(let h of[i,E])for(let P=0;P<h.pts.length;P++){let W=h.pts[P],_=h.pts[(P+1)%h.pts.length].sub(W).normal().unit(),j=Number.MAX_VALUE,ee=-Number.MAX_VALUE;for(let se=0;se<i.pts.length;se++){let Se=i.pts[se].dot(_);j=Math.min(j,Se),ee=Math.max(ee,Se)}let Ae=Number.MAX_VALUE,p=-Number.MAX_VALUE;for(let se=0;se<E.pts.length;se++){let Se=E.pts[se].dot(_);Ae=Math.min(Ae,Se),p=Math.max(p,Se)}let q=Math.min(ee,p)-Math.max(j,Ae);if(q<0)return null;if(q<Math.abs(y)){let se=p-j,Se=Ae-ee;y=Math.abs(se)<Math.abs(Se)?se:Se,v=_.scale(y)}}return v}s(Ws,"Gi");A(Ws,"Wn");V(Ws,"sat");var Zn={linear:i=>i,easeInSine:i=>1-Math.cos(i*Math.PI/2),easeOutSine:i=>Math.sin(i*Math.PI/2),easeInOutSine:i=>-(Math.cos(Math.PI*i)-1)/2,easeInQuad:i=>i*i,easeOutQuad:i=>1-(1-i)*(1-i),easeInOutQuad:i=>i<.5?2*i*i:1-Math.pow(-2*i+2,2)/2,easeInCubic:i=>i*i*i,easeOutCubic:i=>1-Math.pow(1-i,3),easeInOutCubic:i=>i<.5?4*i*i*i:1-Math.pow(-2*i+2,3)/2,easeInQuart:i=>i*i*i*i,easeOutQuart:i=>1-Math.pow(1-i,4),easeInOutQuart:i=>i<.5?8*i*i*i*i:1-Math.pow(-2*i+2,4)/2,easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>1-Math.pow(1-i,5),easeInOutQuint:i=>i<.5?16*i*i*i*i*i:1-Math.pow(-2*i+2,5)/2,easeInExpo:i=>i===0?0:Math.pow(2,10*i-10),easeOutExpo:i=>i===1?1:1-Math.pow(2,-10*i),easeInOutExpo:i=>i===0?0:i===1?1:i<.5?Math.pow(2,20*i-10)/2:(2-Math.pow(2,-20*i+10))/2,easeInCirc:i=>1-Math.sqrt(1-Math.pow(i,2)),easeOutCirc:i=>Math.sqrt(1-Math.pow(i-1,2)),easeInOutCirc:i=>i<.5?(1-Math.sqrt(1-Math.pow(2*i,2)))/2:(Math.sqrt(1-Math.pow(-2*i+2,2))+1)/2,easeInBack:i=>2.70158*i*i*i-1.70158*i*i,easeOutBack:i=>1+2.70158*Math.pow(i-1,3)+1.70158*Math.pow(i-1,2),easeInOutBack:i=>{let E=2.5949095;return i<.5?Math.pow(2*i,2)*((E+1)*2*i-E)/2:(Math.pow(2*i-2,2)*((E+1)*(i*2-2)+E)+2)/2},easeInBounce:i=>1-Zn.easeOutBounce(1-i),easeOutBounce:i=>i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375,easeInOutBounce:i=>i<.5?(1-Zn.easeOutBounce(1-2*i))/2:(1+Zn.easeOutBounce(2*i-1))/2},Rn=A(class extends Map{lastID;constructor(...i){super(...i),this.lastID=0}push(i){let E=this.lastID;return this.set(E,i),this.lastID++,E}pushd(i){let E=this.push(i);return()=>this.delete(E)}},"ce");V(Rn,"IDList");var qr=A(class{handlers=new Rn;add(i){return this.handlers.pushd(i)}addOnce(i){let E=this.add((...y)=>{i(...y),E()});return E}trigger(...i){this.handlers.forEach(E=>E(...i))}numListeners(){return this.handlers.size}},"ne");V(qr,"Event");var Sn=A(class{handlers=new Map;on(i,E){return this.handlers.get(i)||this.handlers.set(i,new qr),this.handlers.get(i).add(E)}onOnce(i,E){let y=this.on(i,(...v)=>{E(...v),y()});return y}trigger(i,...E){this.handlers.get(i)&&this.handlers.get(i).trigger(...E)}remove(i){this.handlers.delete(i)}clear(){this.handlers=new Map}numListeners(i){return this.handlers.get(i)?.numListeners()??0}},"le");V(Sn,"EventHandler");function Ro(i,E){let y=typeof i,v=typeof E;if(y!==v)return!1;if(y==="object"&&v==="object"){let h=Object.keys(i),P=Object.keys(E);if(h.length!==P.length)return!1;for(let W of h){let _=i[W],j=E[W];if(!(typeof _=="function"&&typeof j=="function")&&!Ro(_,j))return!1}return!0}return i===E}s(Ro,"Nr");A(Ro,"It");V(Ro,"deepEq");function _s(i){let E=window.atob(i),y=E.length,v=new Uint8Array(y);for(let h=0;h<y;h++)v[h]=E.charCodeAt(h);return v.buffer}s(_s,"Yi");A(_s,"ps");V(_s,"base64ToArrayBuffer");function $s(i){return _s(i.split(",")[1])}s($s,"ji");A($s,"er");V($s,"dataURLToArrayBuffer");function _n(i,E){let y=document.createElement("a");y.href=E,y.download=i,y.click()}s(_n,"Be");A(_n,"ft");V(_n,"download");function To(i,E){_n(i,"data:text/plain;charset=utf-8,"+E)}s(To,"Dr");A(To,"Nt");V(To,"downloadText");function ea(i,E){To(i,JSON.stringify(E))}s(ea,"Qi");A(ea,"tr");V(ea,"downloadJSON");function Eo(i,E){let y=URL.createObjectURL(E);_n(i,y),URL.revokeObjectURL(y)}s(Eo,"Tr");A(Eo,"jt");V(Eo,"downloadBlob");function xo(i){return i.match(/^data:\w+\/\w+;base64,.+/)}s(xo,"Mr");A(xo,"kt");V(xo,"isDataURL");var ja=(()=>{let i=0;return()=>i++})(),Va=A(class{dts=[];timer=0;fps=0;tick(i){this.dts.push(i),this.timer+=i,this.timer>=1&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((E,y)=>E+y)/this.dts.length)),this.dts=[])}},"$e");V(Va,"FPSCounter");var jn=A(class{time;action;finished=!1;paused=!1;constructor(i,E){this.time=i,this.action=E}tick(i){return this.finished||this.paused?!1:(this.time-=i,this.time<=0?(this.action(),this.finished=!0,this.time=0,!0):!1)}reset(i){this.time=i,this.finished=!1}},"he");V(jn,"Timer");var Za="data:image/png;base64,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",Xa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA1CAYAAADyMeOEAAAAAXNSR0IArs4c6QAAAoVJREFUaIHdm7txwkAQhheGAqACiCHzOKQDQrqgILpwSAeEDBnEUAF0gCMxZ7G72qce/mec2Lpf9+3unaS78wgSNZ8uX5729+d1FNWXUuGmXlBOUUEIMckEpeQJgBu6C+BSFngztBR2vd+ovY+7g+p6LbgaWgJrAeUkDYIUXgXdBBwNi6kpABJwMTQH3AZsXRR8GHTfgEth8E3gjdAUcNewpbTgY85sCMCUuOokozE0YM0YRzM9NGAAXd8+omAF5h4lnmBRvpSnZHyLoLEbaN+aKB9KWv/KWw0tAbbANnlG+UvB2dm77NxxdwgBpjrF/d7rW9cbmpvio2A5z8iAYpVU8pGZlo6/2+MSco2lHfd3rv9jAP038e1xef9o2mjvYb2OqpqKE81028/jeietlSEVO5FRWsxWsJit1G3aFpW8iWe5RwpiCZAk25QvV6nz6fIlynRGuTd5WqpJ4guAlDfVKBK87hXljflgv1ON6fV+4+5gVlA17SfeG0heKqQd4l4jI/wrmaA9N9R4ar+wpHJDZyrrfcH0nB66PqAzPi76pn+faSyJk/vzOorYhGurQrzj/P68jtBMawHaHBIR9xoD5O34dy0qQOSYHvqExq2TpT2nf76+w7y251OYF0CRaU+J920TwLUa6inx6OxE6g80lu2ux7Y2eJLF/rCXE6zEPdnenk9o+4ih9AEdnW2q81HXl5LuU6OTl2fXUhqganbXAGq3g6jJOWV/OnoesO6YqqEB/GdNsjf7uHtwj2DzmRNpp7iOZfm6D9oAxB6Yi1gC4oIYeo4MIPdopEQRB+cAko5J1tW386HpB2Kz1eop4Epdwls/kgZ1sh8gZsEjdcWkr//D8Qu3Z3l5Nl1NtAAAAABJRU5ErkJggg==",Ha={};Ja(Ha,{default:()=>ya});var ya=za("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L5QNSqT5iiySS9Ja2SV//5ME0ak//+4KgAAABgQBAADAMDgYCAEgCteQ0fZH6+ICXA357+MPfhR/+ywRf/U///LVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+5JknQAFoWhGLm5gBClBmT3GiAAAAAGkHAAAIAAANIOAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"),Wa="data:image/png;base64,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",_a="data:image/png;base64,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",$a="3000.0.0-alpha.4",ha={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"},la=["left","middle","right","back","forward"],eu=["space","left","right","up","down","tab","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","s"],da=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",ca=0,fa=3,tu=0,ru=3,iu=-1200,nu=1200,go="topleft",pa=64,ou="happy",wo="monospace",su=36,Aa=64,Vo=1024,ma=.1,au=1,va=[{name:"a_pos",size:3},{name:"a_uv",size:2},{name:"a_color",size:4}],yo=va.reduce((i,E)=>i+E.size,0),Ea=2048,ga=Ea*4*yo,wa=Ea*6,uu=`
attribute vec3 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,hu=`
precision mediump float;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	return v_color * texture2D(u_tex, v_uv);
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,ks=`
vec4 vert(vec3 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,Cs=`
vec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`,lu=new Set(["id","require"]),du=new Set(["add","update","draw","destroy","inspect","drawInspect"]);function Xn(i){return i==="pressed"||i==="rpressed"?"down":i==="released"?"up":i}s(Xn,"Te");A(Xn,"Ht");V(Xn,"processButtonState");function ta(i){i.requestFullscreen?i.requestFullscreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen()}s(ta,"_i");A(ta,"Bs");V(ta,"enterFullscreen");function ra(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}s(ra,"$i");A(ra,"Vs");V(ra,"exitFullscreen");function ia(){return document.fullscreenElement||document.webkitFullscreenElement}s(ia,"to");A(ia,"Gs");V(ia,"getFullscreenElement");function Wi(i){switch(i){case"topleft":return B(-1,-1);case"top":return B(0,-1);case"topright":return B(1,-1);case"left":return B(-1,0);case"center":return B(0,0);case"right":return B(1,0);case"botleft":return B(-1,1);case"bot":return B(0,1);case"botright":return B(1,1);default:return i}}s(Wi,"Gt");A(Wi,"tt");V(Wi,"anchorPt");function na(i){switch(i){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}s(na,"eo");A(na,"Is");V(na,"alignPt");function Hn(){return new AudioBuffer({length:1,numberOfChannels:1,sampleRate:44100})}s(Hn,"Me");A(Hn,"$t");V(Hn,"createEmptyAudioBuffer");var cu=V((i={})=>{let E=[],y=(()=>{let e=i.root??document.body;e===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");let n=i.canvas??(()=>{let L=document.createElement("canvas");return e.appendChild(L),L})(),a=i.scale??1,l=!(i.width&&i.height&&!i.stretch&&!i.letterbox),b=n.parentElement.offsetWidth,c=n.parentElement.offsetHeight;l?(n.width=b,n.height=c):(n.width=i.width*a,n.height=i.height*a);let x=n.width,T=n.height,C=i.pixelDensity||window.devicePixelRatio;n.width*=C,n.height*=C;let k=[`width: ${x}px`,`height: ${T}px`,"outline: none","cursor: default"];return i.crisp&&(k.push("image-rendering: pixelated"),k.push("image-rendering: crisp-edges")),n.style.cssText=k.join(";"),n.tabIndex=0,{canvas:n,canvas2:n.cloneNode(),pixelDensity:C,stretchToParent:l,lastParentWidth:b,lastParentHeight:c,keyStates:{},mouseStates:{},virtualButtonStates:{},charInputted:[],numKeyDown:0,isMouseMoved:!1,isKeyPressed:!1,isKeyPressedRepeat:!1,isKeyReleased:!1,mouseStarted:!1,mousePos:B(0,0),mouseDeltaPos:B(0,0),time:0,realTime:0,skipTime:!1,dt:0,numFrames:0,isTouchScreen:"ontouchstart"in window||navigator.maxTouchPoints>0,loopID:null,stopped:!1,paused:!1,fpsCounter:new Va}})(),v=y.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});class h{glTex;width;height;constructor(n,a,l={}){this.glTex=v.createTexture(),E.push(()=>this.free()),this.bind(),n&&a&&v.texImage2D(v.TEXTURE_2D,0,v.RGBA,n,a,0,v.RGBA,v.UNSIGNED_BYTE,null),this.width=n,this.height=a;let b=(()=>{switch(l.filter??i.texFilter){case"linear":return v.LINEAR;case"nearest":return v.NEAREST;default:return v.NEAREST}})(),c=(()=>{switch(l.wrap){case"repeat":return v.REPEAT;case"clampToEdge":return v.CLAMP_TO_EDGE;default:return v.CLAMP_TO_EDGE}})();v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,b),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,b),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,c),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,c),this.unbind()}static fromImage(n,a={}){let l=new h(0,0,a);return l.bind(),v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,n),l.width=n.width,l.height=n.height,l.unbind(),l}update(n,a,l){this.bind(),v.texSubImage2D(v.TEXTURE_2D,0,n,a,v.RGBA,v.UNSIGNED_BYTE,l),this.unbind()}bind(){v.bindTexture(v.TEXTURE_2D,this.glTex)}unbind(){v.bindTexture(v.TEXTURE_2D,null)}free(){v.deleteTexture(this.glTex)}}s(h,"V"),A(h,"b"),V(h,"Texture");let P=(()=>{let e=wr(ks,Cs),n=h.fromImage(new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1));if(i.background){let c=le.fromArray(i.background);v.clearColor(c.r/255,c.g/255,c.b/255,i.background[3]??1)}v.enable(v.BLEND),v.enable(v.SCISSOR_TEST),v.blendFuncSeparate(v.SRC_ALPHA,v.ONE_MINUS_SRC_ALPHA,v.ONE,v.ONE_MINUS_SRC_ALPHA);let a=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,a),v.bufferData(v.ARRAY_BUFFER,ga*4,v.DYNAMIC_DRAW),va.reduce((c,x,T)=>(v.vertexAttribPointer(T,x.size,v.FLOAT,!1,yo*4,c),v.enableVertexAttribArray(T),c+x.size*4),0),v.bindBuffer(v.ARRAY_BUFFER,null);let l=v.createBuffer();v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,l),v.bufferData(v.ELEMENT_ARRAY_BUFFER,wa*4,v.DYNAMIC_DRAW),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,null);let b=h.fromImage(new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"});return{drawCalls:0,lastDrawCalls:0,defShader:e,curShader:e,defTex:n,curTex:n,curUniform:{},vbuf:a,ibuf:l,vqueue:[],iqueue:[],transform:new Pe,transformStack:[],bgTex:b,width:i.width,height:i.height,viewport:{x:0,y:0,width:v.drawingBufferWidth,height:v.drawingBufferHeight}}})();class W{tex;frames=[new ht(0,0,1,1)];anims={};constructor(n,a,l={}){this.tex=n,a&&(this.frames=a),this.anims=l}static from(n,a={}){return typeof n=="string"?W.fromURL(n,a):Promise.resolve(W.fromImage(n,a))}static fromImage(n,a={}){return new W(h.fromImage(n,a),F(a.sliceX||1,a.sliceY||1),a.anims??{})}static fromURL(n,a={}){return _e(n).then(l=>W.fromImage(l,a))}}s(W,"b"),A(W,"C"),V(W,"SpriteData");class _{buf;constructor(n){this.buf=n}static fromArrayBuffer(n){return new Promise((a,l)=>j.ctx.decodeAudioData(n,a,l)).then(a=>new _(a))}static fromURL(n){return xo(n)?_.fromArrayBuffer($s(n)):ne(n).then(a=>_.fromArrayBuffer(a))}}s(_,"S"),A(_,"R"),V(_,"SoundData");let j=(()=>{let e=new(window.AudioContext||window.webkitAudioContext),n=e.createGain();n.connect(e.destination);let a=new _(Hn());return e.decodeAudioData(ya.buffer.slice(0)).then(l=>{a.buf=l}).catch(l=>{console.error("Failed to load burp: ",l)}),{ctx:e,masterNode:n,burpSnd:a}})();class ee{done=!1;data=null;error=null;onLoadEvents=new qr;onErrorEvents=new qr;onFinishEvents=new qr;constructor(n){n.then(a=>{this.data=a,this.onLoadEvents.trigger(a)}).catch(a=>{if(this.error=a,this.onErrorEvents.numListeners()>0)this.onErrorEvents.trigger(a);else throw a}).finally(()=>{this.onFinishEvents.trigger(),this.done=!0})}static loaded(n){let a=new ee(Promise.resolve(n));return a.data=n,a.done=!0,a}onLoad(n){return this.onLoadEvents.add(n),this}onError(n){return this.onErrorEvents.add(n),this}onFinish(n){return this.onFinishEvents.add(n),this}then(n){return this.onLoad(n)}catch(n){return this.onError(n)}finally(n){return this.onFinish(n)}}s(ee,"M"),A(ee,"O"),V(ee,"Asset");class Ae{assets=new Map;lastUID=0;add(n,a){let l=n??this.lastUID+++"",b=new ee(a);return this.assets.set(l,b),b}addLoaded(n,a){let l=n??this.lastUID+++"",b=ee.loaded(a);this.assets.set(l,b)}get(n){return this.assets.get(n)}progress(){if(this.assets.size===0)return 1;let n=0;return this.assets.forEach(a=>{a.done&&n++}),n/this.assets.size}}s(Ae,"C"),A(Ae,"M"),V(Ae,"AssetBucket");let p={urlPrefix:"",sprites:new Ae,fonts:new Ae,bitmapFonts:new Ae,sounds:new Ae,shaders:new Ae,custom:new Ae,loaded:!1},q={ev:new Sn,objEvents:new Sn,root:ki([]),timers:new Rn,gravity:0,scenes:{},logs:[],cam:{pos:null,scale:B(1),angle:0,shake:0,transform:new Pe}};function se(e){return p.custom.add(null,e)}s(se,"z"),A(se,"de"),V(se,"load");function Se(){let e=[p.sprites,p.sounds,p.shaders,p.fonts,p.bitmapFonts,p.custom];return e.reduce((n,a)=>n+a.progress(),0)/e.length}s(Se,"q"),A(Se,"V"),V(Se,"loadProgress");function Je(e){return e!==void 0&&(p.urlPrefix=e),p.urlPrefix}s(Je,"xt"),A(Je,"Y"),V(Je,"loadRoot");function it(e){let n=p.urlPrefix+e;return fetch(n).then(a=>{if(!a.ok)throw new Error(`Failed to fetch ${n}`);return a})}s(it,"dt"),A(it,"Se"),V(it,"fetchURL");function Be(e){return it(e).then(n=>n.json())}s(Be,"ct"),A(Be,"Ce"),V(Be,"fetchJSON");function K(e){return it(e).then(n=>n.text())}s(K,"y"),A(K,"nt"),V(K,"fetchText");function ne(e){return it(e).then(n=>n.arrayBuffer())}s(ne,"B"),A(ne,"rt"),V(ne,"fetchArrayBuffer");function _e(e){let n=new Image;return n.crossOrigin="anonymous",n.src=xo(e)?e:p.urlPrefix+e,new Promise((a,l)=>{n.onload=()=>a(n),n.onerror=()=>l(new Error(`Failed to load image from "${e}"`))})}s(_e,"rt"),A(_e,"Te"),V(_e,"loadImg");function ye(e,n){let a=new FontFace(e,typeof n=="string"?`url(${n})`:n);return document.fonts.add(a),p.fonts.add(e,a.load().catch(()=>{throw new Error(`Failed to load font from "${n}"`)}))}s(ye,"at"),A(ye,"bt"),V(ye,"loadFont");function ue(e,n,a,l,b={}){return p.bitmapFonts.add(e,_e(n).then(c=>gi(h.fromImage(c,b),a,l,b.chars??da)))}s(ue,"ut"),A(ue,"Ae"),V(ue,"loadBitmapFont");function F(e=1,n=1,a=0,l=0,b=1,c=1){let x=[],T=b/e,C=c/n;for(let k=0;k<n;k++)for(let L=0;L<e;L++)x.push(new ht(a+L*T,l+k*C,T,C));return x}s(F,"Zt"),A(F,"Oe"),V(F,"slice");function Kr(e,n){return se(typeof n=="string"?new Promise((a,l)=>{Be(n).then(b=>{Kr(e,b).onLoad(a).onError(l)})}):W.from(e).then(a=>{let l={};for(let b in n){let c=a.tex.width,x=a.tex.height,T=n[b],C=new W(a.tex,F(T.sliceX,T.sliceY,T.x/c,T.y/x,T.width/c,T.height/x),T.anims);p.sprites.addLoaded(b,C),l[b]=C}return l}))}s(Kr,"Ue"),A(Kr,"Yt"),V(Kr,"loadSpriteAtlas");function nt(e,n,a={sliceX:1,sliceY:1,anims:{}}){return p.sprites.add(e,typeof n=="string"?W.fromURL(n,a):Promise.resolve(W.fromImage(n,a)))}s(nt,"Et"),A(nt,"Pe"),V(nt,"loadSprite");function yt(e,n){return p.sprites.add(e,new Promise(async a=>{let l=typeof n=="string"?await Be(n):n,b=await Promise.all(l.frames.map(_e)),c=document.createElement("canvas");c.width=l.width,c.height=l.height*l.frames.length;let x=c.getContext("2d");b.forEach((C,k)=>{x.drawImage(C,0,k*l.height)});let T=await nt(null,c,{sliceY:l.frames.length,anims:l.anims});a(T)}))}s(yt,"qr"),A(yt,"vr"),V(yt,"loadPedit");function oe(e,n,a){return p.sprites.add(e,new Promise(async l=>{let b=await nt(null,n),c=typeof a=="string"?await Be(a):a,x=c.meta.size;b.frames=c.frames.map(T=>new ht(T.frame.x/x.w,T.frame.y/x.h,T.frame.w/x.w,T.frame.h/x.h));for(let T of c.meta.frameTags)T.from===T.to?b.anims[T.name]=T.from:b.anims[T.name]={from:T.from,to:T.to,speed:10,loop:!0,pingpong:T.direction==="pingpong"};l(b)}))}s(oe,"Kr"),A(oe,"yr"),V(oe,"loadAseprite");function $(e,n,a,l=!1){return p.shaders.add(e,new Promise((b,c)=>{let x=V(T=>T?K(T):new Promise(C=>C(null)),"resolveUrl");if(l)Promise.all([x(n),x(a)]).then(([T,C])=>{b(wr(T,C))}).catch(c);else try{b(wr(n,a))}catch(T){c(T)}}))}s($,"kr"),A($,"Ur"),V($,"loadShader");function Bn(e,n){return p.sounds.add(e,typeof n=="string"?_.fromURL(n):_.fromArrayBuffer(n))}s(Bn,"Lr"),A(Bn,"xr"),V(Bn,"loadSound");function Ke(e="bean"){return nt(e,Xa)}s(Ke,"Jr"),A(Ke,"Er"),V(Ke,"loadBean");function Lr(e){return p.sprites.get(e)}s(Lr,"Pe"),A(Lr,"Xt"),V(Lr,"getSprite");function pe(e){return p.sounds.get(e)}s(pe,"Ce"),A(pe,"Kt"),V(pe,"getSound");function Jr(e){return p.fonts.get(e)}s(Jr,"zr"),A(Jr,"Sr"),V(Jr,"getFont");function rn(e){return p.bitmapFonts.get(e)}s(rn,"Ie"),A(rn,"Qt"),V(rn,"getBitmapFont");function nn(e){return p.shaders.get(e)}s(nn,"Ne"),A(nn,"Jt"),V(nn,"getShader");function pi(e){if(typeof e=="string"){let n=Lr(e);if(n)return n;if(Se()<1)return null;throw new Error(`Sprite not found: ${e}`)}else{if(e instanceof W)return ee.loaded(e);if(e instanceof ee)return e;throw new Error(`Invalid sprite: ${e}`)}}s(pi,"De"),A(pi,"Zt"),V(pi,"resolveSprite");function Ai(e){if(typeof e=="string"){let n=pe(e);if(n)return n.data?n.data:n;if(Se()<1)return null;throw new Error(`Sound not found: ${e}`)}else{if(e instanceof _)return e;if(e instanceof ee)return e.data?e.data:e;throw new Error(`Invalid sound: ${e}`)}}s(Ai,"Gr"),A(Ai,"Cr"),V(Ai,"resolveSound");function mi(e){if(!e)return P.defShader;if(typeof e=="string"){let n=nn(e);if(n)return n.data?n.data:n;if(Se()<1)return null;throw new Error(`Shader not found: ${e}`)}else if(e instanceof ee)return e.data?e.data:e;return e}s(mi,"Yr"),A(mi,"Tr"),V(mi,"resolveShader");function zr(e){if(!e)return zr(i.font??ou);if(typeof e=="string"){let n=rn(e);if(n)return n.data?n.data:n;if(document.fonts.check(`${Aa}px ${e}`))return e;if(Se()<1)return null;throw new Error(`Font not found: ${e}`)}else if(e instanceof ee)return e.data?e.data:e;return e}s(zr,"Oe"),A(zr,"Wt"),V(zr,"resolveFont");function sr(e){return e!==void 0&&(j.masterNode.gain.value=Ft(e,ca,fa)),j.masterNode.gain.value}s(sr,"jr"),A(sr,"Ar"),V(sr,"volume");function Bt(e,n={loop:!1,volume:1,speed:1,detune:0,seek:0}){let a=Ai(e);if(a instanceof ee){let H=Bt(new _(Hn())),we=V(fe=>{let De=Bt(fe,n);for(let et in De)H[et]=De[et]},"doPlay");return a.onLoad(we),H}else if(a===null){let H=Bt(new _(Hn()));return Gi(()=>{}),H}let l=j.ctx,b=!1,c=l.createBufferSource();c.buffer=a.buf,c.loop=!!n.loop;let x=l.createGain();c.connect(x),x.connect(j.masterNode);let T=n.seek??0;c.start(0,T);let C=l.currentTime-T,k=null,L={stop(){b||(this.pause(),C=l.currentTime)},play(H){if(!b)return;let we=c;c=l.createBufferSource(),c.buffer=we.buffer,c.loop=we.loop,c.playbackRate.value=we.playbackRate.value,c.detune&&(c.detune.value=we.detune.value),c.connect(x);let fe=H??this.time();c.start(0,fe),C=l.currentTime-fe,b=!1,k=null},pause(){b||(c.stop(),b=!0,k=l.currentTime)},isPaused(){return b},isStopped(){return b},speed(H){return H!==void 0&&(c.playbackRate.value=Ft(H,tu,ru)),c.playbackRate.value},detune(H){return c.detune?(H!==void 0&&(c.detune.value=Ft(H,iu,nu)),c.detune.value):0},volume(H){return H!==void 0&&(x.gain.value=Ft(H,ca,fa)),x.gain.value},loop(){c.loop=!0},unloop(){c.loop=!1},duration(){return a.buf.duration},time(){return b?k-C:l.currentTime-C}};return L.speed(n.speed),L.detune(n.detune),L.volume(n.volume),L}s(Bt,"It"),A(Bt,"Ye"),V(Bt,"play");function Yr(e){return Bt(j.burpSnd,e)}s(Yr,"qe"),A(Yr,"en"),V(Yr,"burp");function wr(e=ks,n=Cs){let a=uu.replace("{{user}}",e??ks),l=hu.replace("{{user}}",n??Cs),b=v.createShader(v.VERTEX_SHADER),c=v.createShader(v.FRAGMENT_SHADER);v.shaderSource(b,a),v.shaderSource(c,l),v.compileShader(b),v.compileShader(c);let x=v.createProgram();if(E.push(()=>v.deleteProgram(x)),v.attachShader(x,b),v.attachShader(x,c),v.bindAttribLocation(x,0,"a_pos"),v.bindAttribLocation(x,1,"a_uv"),v.bindAttribLocation(x,2,"a_color"),v.linkProgram(x),!v.getProgramParameter(x,v.LINK_STATUS)){let T=V(H=>{let we=/^ERROR:\s0:(?<line>\d+):\s(?<msg>.+)/,fe=H.match(we);return{line:Number(fe.groups.line),msg:fe.groups.msg.replace(/\n\0$/,"")}},"formatShaderError"),C=v.getShaderInfoLog(b),k=v.getShaderInfoLog(c),L="";if(C){let H=T(C);L+=`Vertex shader line ${H.line-14}: ${H.msg}`}if(k){let H=T(k);L+=`Fragment shader line ${H.line-14}: ${H.msg}`}throw new Error(L)}return v.deleteShader(b),v.deleteShader(c),{bind(){v.useProgram(x)},unbind(){v.useProgram(null)},free(){v.deleteProgram(x)},send(T){for(let C in T){let k=T[C],L=v.getUniformLocation(x,C);typeof k=="number"?v.uniform1f(L,k):k instanceof Pe?v.uniformMatrix4fv(L,!1,new Float32Array(k.m)):k instanceof le?v.uniform3f(L,k.r,k.g,k.b):k instanceof Os?v.uniform3f(L,k.x,k.y,k.z):k instanceof Oe&&v.uniform2f(L,k.x,k.y)}}}}s(wr,"de"),A(wr,"vt"),V(wr,"makeShader");function gi(e,n,a,l){let b=e.width/n,c={},x=l.split("").entries();for(let[T,C]of x)c[C]=new ht(T%b*n,Math.floor(T/b)*a,n,a);return{tex:e,map:c,size:a}}s(gi,"Qr"),A(gi,"Or"),V(gi,"makeFont");function Vr(e,n,a,l=P.defTex,b=P.defShader,c={}){let x=mi(b);if(!(!x||x instanceof ee)){(l!==P.curTex||x!==P.curShader||!Ro(P.curUniform,c)||P.vqueue.length+e.length*yo>ga||P.iqueue.length+n.length>wa)&&Ze();for(let T of e){let C=a?P.transform:q.cam.transform.mult(P.transform),k=Vi(C.multVec2(T.pos.xy()));P.vqueue.push(k.x,k.y,T.pos.z,T.uv.x,T.uv.y,T.color.r/255,T.color.g/255,T.color.b/255,T.opacity)}for(let T of n)P.iqueue.push(T+P.vqueue.length/yo-e.length);P.curTex=l,P.curShader=x,P.curUniform=c}}s(Vr,"ce"),A(Vr,"yt"),V(Vr,"drawRaw");function Ze(){!P.curTex||!P.curShader||P.vqueue.length===0||P.iqueue.length===0||(v.bindBuffer(v.ARRAY_BUFFER,P.vbuf),v.bufferSubData(v.ARRAY_BUFFER,0,new Float32Array(P.vqueue)),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,P.ibuf),v.bufferSubData(v.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(P.iqueue)),P.curShader.bind(),P.curShader.send(P.curUniform),P.curTex.bind(),v.drawElements(v.TRIANGLES,P.iqueue.length,v.UNSIGNED_SHORT,0),P.curTex.unbind(),P.curShader.unbind(),v.bindBuffer(v.ARRAY_BUFFER,null),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,null),P.vqueue=[],P.iqueue=[],P.drawCalls++)}s(Ze,"ft"),A(Ze,"fe"),V(Ze,"flush");function wi(){sn(),v.clear(v.COLOR_BUFFER_BIT),i.background||Et(()=>{Xe({width:Ue(),height:ve(),quad:new ht(0,0,Ue()/pa,ve()/pa),tex:P.bgTex,fixed:!0})}),P.drawCalls=0,P.transformStack=[],P.transform=new Pe}s(wi,"Hr"),A(wi,"Pr"),V(wi,"frameStart");function zt(){Ze(),P.lastDrawCalls=P.drawCalls}s(zt,"Xr"),A(zt,"Rr"),V(zt,"frameEnd");function Vi(e){return B(e.x/Ue()*2-1,-e.y/ve()*2+1)}s(Vi,"Zr"),A(Vi,"Dr"),V(Vi,"screen2ndc");function yi(e){P.transform=e.clone()}s(yi,"Wr"),A(yi,"Mr"),V(yi,"pushMatrix");function de(...e){if(e[0]===void 0)return;let n=B(...e);n.x===0&&n.y===0||(P.transform=P.transform.translate(n))}s(de,"K"),A(de,"G"),V(de,"pushTranslate");function Re(...e){if(e[0]===void 0)return;let n=B(...e);n.x===1&&n.y===1||(P.transform=P.transform.scale(n))}s(Re,"bt"),A(Re,"Re"),V(Re,"pushScale");function yr(e){!e||(P.transform=P.transform.rotateX(e))}s(yr,"_r"),A(yr,"Fr"),V(yr,"pushRotateX");function vi(e){!e||(P.transform=P.transform.rotateY(e))}s(vi,"$r"),A(vi,"Lr"),V(vi,"pushRotateY");function ot(e){!e||(P.transform=P.transform.rotateZ(e))}s(ot,"mt"),A(ot,"we"),V(ot,"pushRotateZ");let Un=ot;function Le(){P.transformStack.push(P.transform.clone())}s(Le,"tt"),A(Le,"W"),V(Le,"pushTransform");function Ie(){P.transformStack.length>0&&(P.transform=P.transformStack.pop())}s(Ie,"X"),A(Ie,"X"),V(Ie,"popTransform");function Xe(e){if(e.width===void 0||e.height===void 0)throw new Error('drawUVQuad() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let n=e.width,a=e.height,l=Wi(e.anchor||go).scale(B(n,a).scale(-.5)),b=e.quad||new ht(0,0,1,1),c=e.color||ie(255,255,255),x=e.opacity??1,T=e.tex?ma/e.tex.width:0,C=e.tex?ma/e.tex.height:0,k=b.x+T,L=b.y+C,H=b.w-T*2,we=b.h-C*2;Le(),de(e.pos),ot(e.angle),Re(e.scale),de(l),Vr([{pos:Hi(-n/2,a/2,0),uv:B(e.flipX?k+H:k,e.flipY?L:L+we),color:c,opacity:x},{pos:Hi(-n/2,-a/2,0),uv:B(e.flipX?k+H:k,e.flipY?L+we:L),color:c,opacity:x},{pos:Hi(n/2,-a/2,0),uv:B(e.flipX?k:k+H,e.flipY?L+we:L),color:c,opacity:x},{pos:Hi(n/2,a/2,0),uv:B(e.flipX?k:k+H,e.flipY?L:L+we),color:c,opacity:x}],[0,1,3,1,2,3],e.fixed,e.tex,e.shader,e.uniform),Ie()}s(Xe,"St"),A(Xe,"De"),V(Xe,"drawUVQuad");function ar(e){if(!e.tex)throw new Error('drawTexture() requires property "tex".');let n=e.quad??new ht(0,0,1,1),a=e.tex.width*n.w,l=e.tex.height*n.h,b=B(1);if(e.tiled){let c=Math.ceil((e.width||a)/a),x=Math.ceil((e.height||l)/l),T=Wi(e.anchor||go).add(B(1,1)).scale(.5).scale(c*a,x*l);for(let C=0;C<c;C++)for(let k=0;k<x;k++)Xe({...e,pos:(e.pos||B(0)).add(B(a*C,l*k)).sub(T),scale:b.scale(e.scale||B(1)),tex:e.tex,quad:n,width:a,height:l,anchor:"topleft"})}else e.width&&e.height?(b.x=e.width/a,b.y=e.height/l):e.width?(b.x=e.width/a,b.y=b.x):e.height&&(b.y=e.height/l,b.x=b.y),Xe({...e,scale:b.scale(e.scale||B(1)),tex:e.tex,quad:n,width:a,height:l})}s(ar,"tn"),A(ar,"Vr"),V(ar,"drawTexture");function vr(e){if(!e.sprite)throw new Error('drawSprite() requires property "sprite"');let n=pi(e.sprite);if(!n||!n.data)return;let a=n.data.frames[e.frame??0];if(!a)throw new Error(`Frame not found: ${e.frame??0}`);ar({...e,tex:n.data.tex,quad:a.scale(e.quad||new ht(0,0,1,1))})}s(vr,"Ke"),A(vr,"tn"),V(vr,"drawSprite");function Yt(e,n,a,l,b,c=1){l=Or(l%360),b=Or(b%360),b<=l&&(b+=Math.PI*2);let x=Math.ceil(Math.max(Math.sqrt(n+a)*3*(c||1),16)),T=(b-l)/x,C=[];for(let k=l;k<b;k+=T)C.push(e.add(n*Math.cos(k),a*Math.sin(k)));return C.push(e.add(n*Math.cos(b),a*Math.sin(b))),C}s(Yt,"Nt"),A(Yt,"Xe"),V(Yt,"getArcPts");function ze(e){if(e.width===void 0||e.height===void 0)throw new Error('drawRect() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let n=e.width,a=e.height,l=Wi(e.anchor||go).add(1,1).scale(B(n,a).scale(-.5)),b=[B(0,0),B(n,0),B(n,a),B(0,a)];if(e.radius){let c=Math.min(Math.min(n,a)/2,e.radius);b=[B(c,0),B(n-c,0),...Yt(B(n-c,c),c,c,270,360),B(n,c),B(n,a-c),...Yt(B(n-c,a-c),c,c,0,90),B(n-c,a),B(c,a),...Yt(B(c,a-c),c,c,90,180),B(0,a-c),B(0,c),...Yt(B(c,c),c,c,180,270)]}Gt({...e,offset:l,pts:b,...e.gradient?{colors:e.horizontal?[e.gradient[0],e.gradient[1],e.gradient[1],e.gradient[0]]:[e.gradient[0],e.gradient[0],e.gradient[1],e.gradient[1]]}:{}})}s(ze,"Z"),A(ze,"K"),V(ze,"drawRect");function vt(e){let{p1:n,p2:a}=e;if(!n||!a)throw new Error('drawLine() requires properties "p1" and "p2".');let l=e.width||1,b=a.sub(n).unit().normal().scale(l*.5),c=[n.sub(b),n.add(b),a.add(b),a.sub(b)].map(x=>({pos:Hi(x.x,x.y,0),uv:B(0),color:e.color??le.WHITE,opacity:e.opacity??1}));Vr(c,[0,1,3,1,2,3],e.fixed,P.defTex,e.shader,e.uniform)}s(vt,"Dt"),A(vt,"Ke"),V(vt,"drawLine");function Er(e){let n=e.pts;if(!n)throw new Error('drawLines() requires property "pts".');if(!(n.length<2))if(e.radius&&n.length>=3){let a=n[0].dist(n[1]);for(let b=1;b<n.length-1;b++)a=Math.min(n[b].dist(n[b+1]),a);let l=Math.min(e.radius,a/2);vt({...e,p1:n[0],p2:n[1]});for(let b=1;b<n.length-2;b++){let c=n[b],x=n[b+1];vt({...e,p1:c,p2:x})}vt({...e,p1:n[n.length-2],p2:n[n.length-1]})}else for(let a=0;a<n.length-1;a++)vt({...e,p1:n[a],p2:n[a+1]}),e.join!=="none"&&gt({...e,pos:n[a],radius:e.width/2})}s(Er,"ke"),A(Er,"nn"),V(Er,"drawLines");function Gr(e){if(!e.p1||!e.p2||!e.p3)throw new Error('drawPolygon() requires properties "p1", "p2" and "p3".');return Gt({...e,pts:[e.p1,e.p2,e.p3]})}s(Gr,"Le"),A(Gr,"rn"),V(Gr,"drawTriangle");function gt(e){if(!e.radius)throw new Error('drawCircle() requires property "radius".');e.radius!==0&&xr({...e,radiusX:e.radius,radiusY:e.radius,angle:0})}s(gt,"gt"),A(gt,"be"),V(gt,"drawCircle");function xr(e){if(e.radiusX===void 0||e.radiusY===void 0)throw new Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(e.radiusX===0||e.radiusY===0)return;let n=e.start??0,a=e.end??360,l=Yt(B(0),e.radiusX,e.radiusY,n,a,e.resolution);l.unshift(B(0));let b={...e,pts:l,radius:0,...e.gradient?{colors:[e.gradient[0],...Array(l.length-1).fill(e.gradient[1])]}:{}};if(a-n>=360&&e.outline){e.fill!==!1&&Gt({...b,outline:null}),Gt({...b,pts:l.slice(1),fill:!1});return}Gt(b)}s(xr,"Je"),A(xr,"sn"),V(xr,"drawEllipse");function Gt(e){if(!e.pts)throw new Error('drawPolygon() requires property "pts".');let n=e.pts.length;if(!(n<3)){if(Le(),de(e.pos),Re(e.scale),ot(e.angle),de(e.offset),e.fill!==!1){let a=e.color??le.WHITE,l=e.pts.map((c,x)=>({pos:Hi(c.x,c.y,0),uv:B(0,0),color:e.colors?e.colors[x]??a:a,opacity:e.opacity??1})),b=[...Array(n-2).keys()].map(c=>[0,c+1,c+2]).flat();Vr(l,e.indices??b,e.fixed,P.defTex,e.shader,e.uniform)}e.outline&&Er({pts:[...e.pts,e.pts[0]],radius:e.radius,width:e.outline.width,color:e.outline.color,join:e.outline.join,uniform:e.uniform,fixed:e.fixed,opacity:e.opacity}),Ie()}}s(Gt,"wt"),A(Gt,"ve"),V(Gt,"drawPolygon");function Ei(e,n,a){Ze(),v.clear(v.STENCIL_BUFFER_BIT),v.enable(v.STENCIL_TEST),v.stencilFunc(v.NEVER,1,255),v.stencilOp(v.REPLACE,v.REPLACE,v.REPLACE),n(),Ze(),v.stencilFunc(a,1,255),v.stencilOp(v.KEEP,v.KEEP,v.KEEP),e(),Ze(),v.disable(v.STENCIL_TEST)}s(Ei,"ze"),A(Ei,"on"),V(Ei,"drawStenciled");function br(e,n){Ei(e,n,v.EQUAL)}s(br,"en"),A(br,"Gr"),V(br,"drawMasked");function Pn(e,n){Ei(e,n,v.NOTEQUAL)}s(Pn,"rn"),A(Pn,"Ir"),V(Pn,"drawSubtracted");function on(){return(P.viewport.width+P.viewport.height)/(P.width+P.height)}s(on,"Ge"),A(on,"an"),V(on,"getViewportScale");function Et(e){Ze();let n=P.width,a=P.height;P.width=P.viewport.width,P.height=P.viewport.height,e(),Ze(),P.width=n,P.height=a}s(Et,"ht"),A(Et,"ae"),V(Et,"drawUnscaled");function xi(e,n){n.pos&&(e.pos=e.pos.add(n.pos)),n.scale&&(e.scale=e.scale.scale(B(n.scale))),n.angle&&(e.angle+=n.angle),n.color&&(e.color=e.color.mult(n.color)),n.opacity&&(e.opacity*=n.opacity)}s(xi,"Ye"),A(xi,"un"),V(xi,"applyCharTransform");let $n=/\[(?<text>[^\]]*)\]\.(?<style>[\w\.]+)+/g;function kn(e){let n={},a=e.replace($n,"$1"),l=0;for(let b of e.matchAll($n)){let c=b.groups.style.split("."),x=b.index-l;for(let T=x;T<b.index+b.groups.text.length;T++)n[T]={localIdx:T-x,styles:c};l+=3+b.groups.style.length}return{charStyleMap:n,text:a}}s(kn,"on"),A(kn,"Nr"),V(kn,"compileStyledText");let Cn={};function Ut(e){if(e.text===void 0)throw new Error('formatText() requires property "text".');let n=zr(e.font);if(e.text===""||n instanceof ee||!n)return{width:0,height:0,chars:[],opt:e};let{charStyleMap:a,text:l}=kn(e.text+""),b=l.split("");if(n instanceof FontFace||typeof n=="string"){let Fe=n instanceof FontFace?n.family:n,he=Cn[Fe]??{font:{tex:new h(Vo,Vo,{filter:"linear"}),map:{},size:Aa},cursor:B(0)};Cn[Fe]||(Cn[Fe]=he),n=he.font;for(let qe of b)if(!he.font.map[qe]){let pt=y.canvas2.getContext("2d");pt.font=`${n.size}px ${Fe}`,pt.clearRect(0,0,y.canvas2.width,y.canvas2.height),pt.textBaseline="top",pt.textAlign="left",pt.fillStyle="rgb(255, 255, 255)",pt.fillText(qe,0,0);let tr=pt.measureText(qe),rr=Math.ceil(tr.width),ir=pt.getImageData(0,0,rr,n.size);if(he.cursor.x+rr>Vo&&(he.cursor.x=0,he.cursor.y+=n.size,he.cursor.y>Vo))throw new Error("Font atlas exceeds character limit");n.tex.update(he.cursor.x,he.cursor.y,ir),n.map[qe]=new ht(he.cursor.x,he.cursor.y,rr,n.size),he.cursor.x+=rr}}let c=e.size||n.size,x=B(e.scale??1).scale(c/n.size),T=e.lineSpacing??0,C=e.letterSpacing??0,k=0,L=0,H=0,we=[],fe=[],De=0,et=null,re=null;for(;De<b.length;){let Fe=b[De];if(Fe===`
`)H+=c+T,we.push({width:k-C,chars:fe}),et=null,re=null,k=0,fe=[];else{let he=n.map[Fe];if(he){let qe=he.w*x.x;e.width&&k+qe>e.width&&(H+=c+T,et!=null&&(De-=fe.length-et,Fe=b[De],he=n.map[Fe],qe=he.w*x.x,fe=fe.slice(0,et-1),k=re),et=null,re=null,we.push({width:k-C,chars:fe}),k=0,fe=[]),fe.push({tex:n.tex,width:he.w,height:he.h,quad:new ht(he.x/n.tex.width,he.y/n.tex.height,he.w/n.tex.width,he.h/n.tex.height),ch:Fe,pos:B(k,H),opacity:e.opacity??1,color:e.color??le.WHITE,scale:B(x),angle:0}),Fe===" "&&(et=fe.length,re=k),k+=qe,L=Math.max(L,k),k+=C}}De++}we.push({width:k-C,chars:fe}),H+=c,e.width&&(L=e.width);let ke=[];for(let Fe of we){let he=(L-Fe.width)*na(e.align??"left");for(let qe of Fe.chars){let pt=n.map[qe.ch],tr=ke.length,rr=new Oe(pt.w*x.x*.5,pt.h*x.y*.5);if(qe.pos=qe.pos.add(he,0).add(rr),e.transform){let ir=typeof e.transform=="function"?e.transform(tr,qe.ch):e.transform;ir&&xi(qe,ir)}if(a[tr]){let{styles:ir,localIdx:An}=a[tr];for(let gr of ir){let ci=e.styles[gr],mn=typeof ci=="function"?ci(An,qe.ch):ci;mn&&xi(qe,mn)}}ke.push(qe)}}return{width:L,height:H,chars:ke,opt:e}}s(Ut,"Vt"),A(Ut,"ye"),V(Ut,"formatText");function Sr(e){Qt(Ut(e))}s(Sr,"Wt"),A(Sr,"it"),V(Sr,"drawText");function Qt(e){Le(),de(e.opt.pos),ot(e.opt.angle),de(Wi(e.opt.anchor??"topleft").add(1,1).scale(e.width,e.height).scale(-.5)),e.chars.forEach(n=>{Xe({tex:n.tex,width:n.width,height:n.height,pos:n.pos,scale:n.scale,angle:n.angle,color:n.color,opacity:n.opacity,quad:n.quad,anchor:"center",uniform:e.opt.uniform,shader:e.opt.shader,fixed:e.opt.fixed})}),Ie()}s(Qt,"yt"),A(Qt,"Ue"),V(Qt,"drawFormattedText");function sn(){if(y.stretchToParent&&!jt()){let b=y.canvas.parentElement.offsetWidth,c=y.canvas.parentElement.offsetHeight;if(b!==y.lastParentWidth||c!==y.lastParentHeight){y.canvas.width=b*y.pixelDensity,y.canvas.height=c*y.pixelDensity,y.canvas.style.width=b+"px",y.canvas.style.height=c+"px";let x=Ue(),T=ve();q.ev.onOnce("frameEnd",()=>{q.ev.trigger("resize",x,T,Ue(),ve())})}y.lastParentWidth=b,y.lastParentHeight=c}let e=y.pixelDensity,n=v.drawingBufferWidth/e,a=v.drawingBufferHeight/e;if(jt()){let b=window.innerWidth,c=window.innerHeight,x=b/c,T=n/a;if(x>T){let C=window.innerHeight*T;P.viewport={x:(b-C)/2,y:0,width:C,height:c}}else{let C=window.innerWidth/T;P.viewport={x:0,y:(c-C)/2,width:b,height:C}}return}if(i.letterbox){if(!i.width||!i.height)throw new Error("Letterboxing requires width and height defined.");let b=n/a,c=i.width/i.height;if(b>c){i.stretch||(P.width=a*c,P.height=a);let x=a*c,T=a,C=(n-x)/2;v.scissor(C*e,0,x*e,T*e),v.viewport(C*e,0,x*e,a*e),P.viewport={x:C,y:0,width:x,height:a}}else{i.stretch||(P.width=n,P.height=n/c);let x=n,T=n/c,C=(a-T)/2;v.scissor(0,C*e,x*e,T*e),v.viewport(0,C*e,n*e,T*e),P.viewport={x:0,y:C,width:n,height:T}}return}if(i.stretch){if(!i.width||!i.height)throw new Error("Stretching requires width and height defined.");v.viewport(0,0,n*e,a*e),P.viewport={x:0,y:0,width:n,height:a};return}let l=i.scale??1;P.width=n/l,P.height=a/l,v.viewport(0,0,n*e,a*e),P.viewport={x:0,y:0,width:n,height:a}}s(sn,"sn"),A(sn,"jr"),V(sn,"updateViewport");function Ue(){return P.width}s(Ue,"J"),A(Ue,"k"),V(Ue,"width");function ve(){return P.height}s(ve,"N"),A(ve,"L"),V(ve,"height");let st={},bi={},Qr={};function jr(e){return B((e.x-P.viewport.x)*Ue()/P.viewport.width,(e.y-P.viewport.y)*ve()/P.viewport.height)}s(jr,"$t"),A(jr,"st"),V(jr,"windowToContent");function Zr(e){return B(e.x*P.viewport.width/P.width,e.y*P.viewport.height/P.height)}s(Zr,"an"),A(Zr,"kr"),V(Zr,"contentToView");function Xr(e,n){let a=jr(B(e,n));y.mouseStarted&&(y.mouseDeltaPos=a.sub(y.mousePos)),y.mousePos=a,y.mouseStarted=!0,y.isMouseMoved=!0}s(Xr,"fe"),A(Xr,"xt"),V(Xr,"setMousePos"),st.mousemove=e=>{Xr(e.offsetX,e.offsetY)},st.mousedown=e=>{let n=la[e.button];n&&(y.mouseStates[n]="pressed")},st.mouseup=e=>{let n=la[e.button];n&&(y.mouseStates[n]="released")},st.keydown=e=>{let n=ha[e.key]||e.key.toLowerCase();eu.includes(n)&&e.preventDefault(),n.length===1&&y.charInputted.push(e.key),n==="space"&&y.charInputted.push(" "),e.repeat?(y.isKeyPressedRepeat=!0,y.keyStates[n]="rpressed"):(y.isKeyPressed=!0,y.keyStates[n]="pressed"),y.numKeyDown++},st.keyup=e=>{let n=ha[e.key]||e.key.toLowerCase();y.keyStates[n]="released",y.isKeyReleased=!0,y.numKeyDown--},st.touchstart=e=>{e.preventDefault();let n=[...e.changedTouches];n.forEach(a=>{q.ev.trigger("onTouchStart",jr(B(a.clientX,a.clientY)),a)}),i.touchToMouse!==!1&&(Xr(n[0].clientX,n[0].clientY),y.mouseStates.left="pressed")},st.touchmove=e=>{e.preventDefault();let n=[...e.changedTouches];n.forEach(a=>{q.ev.trigger("onTouchMove",jr(B(a.clientX,a.clientY)),a)}),i.touchToMouse!==!1&&Xr(n[0].clientX,n[0].clientY)},st.touchend=e=>{[...e.changedTouches].forEach(n=>{q.ev.trigger("onTouchEnd",jr(B(n.clientX,n.clientY)),n)}),i.touchToMouse!==!1&&(y.mouseStates.left="released")},st.touchcancel=()=>{i.touchToMouse!==!1&&(y.mouseStates.left="released")},st.contextmenu=function(e){e.preventDefault()},bi.visibilitychange=()=>{switch(document.visibilityState){case"visible":y.skipTime=!0,Ee.paused||j.ctx.resume();break;case"hidden":j.ctx.suspend();break}},Qr.error=e=>{e.error?Ir(e.error):Ir(new Error(e.message))},Qr.unhandledrejection=e=>Ir(e.reason);for(let e in st)y.canvas.addEventListener(e,st[e]);for(let e in bi)document.addEventListener(e,bi[e]);for(let e in Qr)window.addEventListener(e,Qr[e]);function at(){return y.mousePos.clone()}s(at,"et"),A(at,"ee"),V(at,"mousePos");function Rr(){return y.mouseDeltaPos.clone()}s(Rr,"Qe"),A(Rr,"ln"),V(Rr,"mouseDeltaPos");function ur(e="left"){return y.mouseStates[e]==="pressed"}s(ur,"Rt"),A(ur,"Fe"),V(ur,"isMousePressed");function Hr(e="left"){return y.mouseStates[e]==="pressed"||y.mouseStates[e]==="down"}s(Hr,"pe"),A(Hr,"Et"),V(Hr,"isMouseDown");function Pt(e="left"){return y.mouseStates[e]==="released"}s(Pt,"qt"),A(Pt,"Je"),V(Pt,"isMouseReleased");function Si(){return y.isMouseMoved}s(Si,"He"),A(Si,"hn"),V(Si,"isMouseMoved");function Wr(e){return e===void 0?y.isKeyPressed:y.keyStates[e]==="pressed"}s(Wr,"te"),A(Wr,"ot"),V(Wr,"isKeyPressed");function Ri(e){return e===void 0?y.isKeyPressedRepeat:y.keyStates[e]==="pressed"||y.keyStates[e]==="rpressed"}s(Ri,"Xe"),A(Ri,"dn"),V(Ri,"isKeyPressedRepeat");function Tr(e){return e===void 0?y.numKeyDown>0:y.keyStates[e]==="pressed"||y.keyStates[e]==="rpressed"||y.keyStates[e]==="down"}s(Tr,"Ze"),A(Tr,"fn"),V(Tr,"isKeyDown");function _r(e){return e===void 0?y.isKeyReleased:y.keyStates[e]==="released"}s(_r,"Ae"),A(_r,"St"),V(_r,"isKeyReleased");function Ti(e){return y.virtualButtonStates[e]==="pressed"}s(Ti,"We"),A(Ti,"mn"),V(Ti,"isVirtualButtonPressed");function Mi(e){return y.virtualButtonStates[e]==="pressed"||y.virtualButtonStates[e]==="down"}s(Mi,"_e"),A(Mi,"pn"),V(Mi,"isVirtualButtonDown");function an(e){return y.virtualButtonStates[e]==="released"}s(an,"$e"),A(an,"gn"),V(an,"isVirtualButtonReleased");function In(){return[...y.charInputted]}s(In,"un"),A(In,"_r"),V(In,"charInputted");function Mr(){return y.time}s(Mr,"me"),A(Mr,"Ct"),V(Mr,"time");function Fi(){return y.canvas.toDataURL()}s(Fi,"hn"),A(Fi,"qr"),V(Fi,"screenshot");function un(e){return e&&(y.canvas.style.cursor=e),y.canvas.style.cursor}s(un,"tr"),A(un,"wn"),V(un,"setCursor");function Nn(e=!0){e?ta(y.canvas):ra()}s(Nn,"ln"),A(Nn,"zr"),V(Nn,"setFullscreen");function jt(){return Boolean(ia())}s(jt,"ge"),A(jt,"Tt"),V(jt,"isFullscreen");function $r(){return y.isTouchScreen}s($r,"er"),A($r,"bn"),V($r,"isTouchScreen");let Ee={inspect:!1,timeScale:1,showLog:!0,fps:()=>y.fpsCounter.fps,numFrames:()=>y.numFrames,stepFrame:li,drawCalls:()=>P.drawCalls,clearLog:()=>q.logs=[],log:e=>{let n=i.logMax??au;q.logs.unshift(`${`[${Mr().toFixed(2)}].time `}[${e?.toString?e.toString():e}].${e instanceof Error?"error":"info"}`),q.logs.length>n&&(q.logs=q.logs.slice(0,n))},error:e=>Ee.log(new Error(e.toString?e.toString():e)),curRecording:null,get paused(){return y.paused},set paused(e){y.paused=e,e?j.ctx.suspend():j.ctx.resume()}};function Ye(){return y.dt*Ee.timeScale}s(Ye,"_"),A(Ye,"Q"),V(Ye,"dt");function Zt(...e){return e.length>0&&(q.cam.pos=B(...e)),q.cam.pos?q.cam.pos.clone():wt()}s(Zt,"dn"),A(Zt,"Hr"),V(Zt,"camPos");function Bi(...e){return e.length>0&&(q.cam.scale=B(...e)),q.cam.scale.clone()}s(Bi,"cn"),A(Bi,"$r"),V(Bi,"camScale");function Fr(e){return e!==void 0&&(q.cam.angle=e),q.cam.angle}s(Fr,"fn"),A(Fr,"Yr"),V(Fr,"camRot");function Dn(e=12){q.cam.shake=e}s(Dn,"pn"),A(Dn,"Xr"),V(Dn,"shake");function kt(e){return q.cam.transform.multVec2(e)}s(kt,"we"),A(kt,"At"),V(kt,"toScreen");function Ui(e){return q.cam.transform.invert().multVec2(e)}s(Ui,"rr"),A(Ui,"vn"),V(Ui,"toWorld");function Pi(e){let n=new Pe;return e.pos&&(n=n.translate(e.pos)),e.scale&&(n=n.scale(e.scale)),e.angle&&(n=n.rotateZ(e.angle)),e.parent?n.mult(e.parent.transform):n}s(Pi,"nr"),A(Pi,"yn"),V(Pi,"calcTransform");function ki(e){let n=new Map,a={},l=new Sn,b={id:ja(),hidden:!1,paused:!1,transform:new Pe,children:[],parent:null,add(c){let x=(()=>{if(Array.isArray(c))return ki(c);if(c.parent)throw new Error("Cannot add a game obj that already has a parent.");return c})();return x.parent=this,x.transform=Pi(x),this.children.push(x),x.trigger("add",this),q.ev.trigger("add",this),x},readd(c){let x=this.children.indexOf(c);return x!==-1&&(this.children.splice(x,1),this.children.push(c)),c},remove(c){let x=this.children.indexOf(c);x!==-1&&(c.parent=null,c.trigger("destroy"),q.ev.trigger("destroy",c),this.children.splice(x,1))},removeAll(c){this.get(c).forEach(x=>this.remove(x))},update(){this.paused||(this.get().forEach(c=>c.update()),this.trigger("update"))},draw(){this.hidden||(Le(),de(this.pos),Re(this.scale),ot(this.angle),this.trigger("draw"),this.get().forEach(c=>c.draw()),Ie())},drawInspect(){this.hidden||(Le(),de(this.pos),Re(this.scale),ot(this.angle),this.get().forEach(c=>c.drawInspect()),this.trigger("drawInspect"),Ie())},use(c){if(!c)return;if(typeof c=="string")return this.use({id:c});c.id&&(this.unuse(c.id),n.set(c.id,{cleanups:[]}));let x=c.id?n.get(c.id):a,T=c.id?x.cleanups:[],C=V(()=>{if(c.require){for(let k of c.require)if(!this.c(k))throw new Error(`Component "${c.id}" requires component "${k}"`)}},"checkDeps");c.destroy&&T.push(c.destroy),c.require&&!this.exists()&&x.cleanups&&T.push(this.on("add",C));for(let k in c)if(!lu.has(k)){if(typeof c[k]=="function"){let L=c[k].bind(this);if(du.has(k)){T.push(this.on(k,L)),x[k]=L;continue}else x[k]=L}else x[k]=c[k];if(this[k]===void 0)Object.defineProperty(this,k,{get:()=>x[k],set:L=>x[k]=L,configurable:!0,enumerable:!0});else throw new Error(`Duplicate component property: "${k}"`)}this.exists()&&(C(),c.add&&c.add.call(this))},unuse(c){if(n.has(c)){let x=n.get(c);x.cleanups.forEach(T=>T());for(let T in x)delete x[T]}n.delete(c)},c(c){return n.get(c)},get(c){return this.children.filter(x=>c?x.is(c):!0).sort((x,T)=>(x.z??0)-(T.z??0))},getAll(c){return this.children.sort((x,T)=>(x.z??0)-(T.z??0)).flatMap(x=>[x,...x.getAll(c)]).filter(x=>c?x.is(c):!0)},isAncestorOf(c){return c.parent?c.parent===this||this.isAncestorOf(c.parent):!1},exists(){return q.root.isAncestorOf(this)},is(c){if(c==="*")return!0;if(Array.isArray(c)){for(let x of c)if(!this.c(x))return!1;return!0}else return this.c(c)!=null},on(c,x){return l.on(c,x.bind(this))},trigger(c,...x){l.trigger(c,...x),q.objEvents.trigger(c,this,...x)},destroy(){this.parent&&this.parent.remove(this)},inspect(){let c={};for(let[x,T]of n)c[x]=T.inspect?T.inspect():null;return c},onAdd(c){return this.on("add",c)},onUpdate(c){return this.on("update",c)},onDraw(c){return this.on("draw",c)},onDestroy(c){return this.on("destroy",c)},clearEvents(){l.clear()}};for(let c of e)b.use(c);return b}s(ki,"ir"),A(ki,"Un"),V(ki,"make");function Xt(e,n,a){return q.objEvents[e]||(q.objEvents[e]=new Rn),q.objEvents.on(e,(l,...b)=>{l.is(n)&&a(l,...b)})}s(Xt,"Tt"),A(Xt,"Le"),V(Xt,"on");function ei(e,n){if(typeof e=="function"&&n===void 0){let a=qt([{update:e}]);return()=>a.destroy()}else if(typeof e=="string")return Xt("update",e,n)}s(ei,"or"),A(ei,"xn"),V(ei,"onUpdate");function hn(e,n){if(typeof e=="function"&&n===void 0){let a=qt([{draw:e}]);return()=>a.destroy()}else if(typeof e=="string")return Xt("draw",e,n)}s(hn,"An"),A(hn,"Kr"),V(hn,"onDraw");function ti(e,n){if(typeof e=="function"&&n===void 0){let a=qt([{draw:e}]);return()=>a.destroy()}else if(typeof e=="string")return Xt("add",e,n)}s(ti,"sr"),A(ti,"En"),V(ti,"onAdd");function qn(e,n){if(typeof e=="function"&&n===void 0){let a=qt([{draw:e}]);return()=>a.destroy()}else if(typeof e=="string")return Xt("destroy",e,n)}s(qn,"mn"),A(qn,"Qr"),V(qn,"onDestroy");function r(e,n,a){return Xt("collide",e,(l,b,c)=>b.is(n)&&a(l,b,c))}s(r,"gn"),A(r,"Jr"),V(r,"onCollide");function w(e,n){dn(e).forEach(n),ti(e,n)}s(w,"ee"),A(w,"at"),V(w,"forAllCurrentAndFuture");function m(e,n){if(typeof e=="function")return Te(e);{let a=[];return w(e,l=>{if(!l.area)throw new Error("onClick() requires the object to have area() component");a.push(l.onClick(()=>n(l)))}),()=>a.forEach(l=>l())}}s(m,"wn"),A(m,"Zr"),V(m,"onClick");function g(e,n){let a=[];return w(e,l=>{if(!l.area)throw new Error("onHover() requires the object to have area() component");a.push(l.onHover(()=>n(l)))}),()=>a.forEach(l=>l())}s(g,"Vn"),A(g,"Wr"),V(g,"onHover");function O(e,n){let a=[];return w(e,l=>{if(!l.area)throw new Error("onHoverUpdate() requires the object to have area() component");a.push(l.onHoverUpdate(()=>n(l)))}),()=>a.forEach(l=>l())}s(O,"yn"),A(O,"ei"),V(O,"onHoverUpdate");function U(e,n){let a=[];return w(e,l=>{if(!l.area)throw new Error("onHoverEnd() requires the object to have area() component");a.push(l.onHoverEnd(()=>n(l)))}),()=>a.forEach(l=>l())}s(U,"vn"),A(U,"ti"),V(U,"onHoverEnd");function Z(e,n){return new Promise(a=>{q.timers.push(new jn(e,()=>{n&&n(),a()}))})}s(Z,"ar"),A(Z,"Sn"),V(Z,"wait");function X(e,n){let a=!1,l=V(()=>{a||(n(),Z(e,l))},"newF");return l(),()=>a=!0}s(X,"xn"),A(X,"ni"),V(X,"loop");function Q(e,n){if(Array.isArray(e)){let a=e.map(l=>Q(l,n));return()=>a.forEach(l=>l())}return q.ev.on("input",()=>Tr(e)&&n())}s(Q,"ur"),A(Q,"Cn"),V(Q,"onKeyDown");function G(e,n){if(Array.isArray(e)){let a=e.map(l=>G(l,n));return()=>a.forEach(l=>l())}else return typeof e=="function"?q.ev.on("input",()=>Wr()&&e()):q.ev.on("input",()=>Wr(e)&&n())}s(G,"lt"),A(G,"ue"),V(G,"onKeyPress");function ce(e,n){if(Array.isArray(e)){let a=e.map(l=>ce(l,n));return()=>a.forEach(l=>l())}else return typeof e=="function"?q.ev.on("input",()=>Wr()&&e()):q.ev.on("input",()=>Ri(e)&&n())}s(ce,"hr"),A(ce,"Tn"),V(ce,"onKeyPressRepeat");function Y(e,n){if(Array.isArray(e)){let a=e.map(l=>Y(l,n));return()=>a.forEach(l=>l())}else return typeof e=="function"?q.ev.on("input",()=>_r()&&e()):q.ev.on("input",()=>_r(e)&&n())}s(Y,"lr"),A(Y,"An"),V(Y,"onKeyRelease");function D(e,n){return typeof e=="function"?q.ev.on("input",()=>Hr()&&e(at())):q.ev.on("input",()=>Hr(e)&&n(at()))}s(D,"En"),A(D,"ri"),V(D,"onMouseDown");function Te(e,n){return typeof e=="function"?q.ev.on("input",()=>ur()&&e(at())):q.ev.on("input",()=>ur(e)&&n(at()))}s(Te,"dr"),A(Te,"On"),V(Te,"onMousePress");function me(e,n){return typeof e=="function"?q.ev.on("input",()=>Pt()&&e(at())):q.ev.on("input",()=>Pt(e)&&n(at()))}s(me,"bn"),A(me,"ii"),V(me,"onMouseRelease");function xt(e){return q.ev.on("input",()=>Si()&&e(at(),Rr()))}s(xt,"Sn"),A(xt,"si"),V(xt,"onMouseMove");function lt(e){return q.ev.on("input",()=>In().forEach(n=>e(n)))}s(lt,"Rn"),A(lt,"oi"),V(lt,"onCharInput");function dt(e){return q.ev.on("onTouchStart",e)}s(dt,"Tn"),A(dt,"ai"),V(dt,"onTouchStart");function J(e){return q.ev.on("onTouchMove",e)}s(J,"Mn"),A(J,"ui"),V(J,"onTouchMove");function ae(e){return q.ev.on("onTouchEnd",e)}s(ae,"Fn"),A(ae,"ci"),V(ae,"onTouchEnd");function $e(e,n){return q.ev.on("input",()=>Ti(e)&&n())}s($e,"Bn"),A($e,"li"),V($e,"onVirtualButtonPress");function ct(e,n){return q.ev.on("input",()=>Mi(e)&&n())}s(ct,"Un"),A(ct,"hi"),V(ct,"onVirtualButtonDown");function ft(e,n){return q.ev.on("input",()=>an(e)&&n())}s(ft,"Pn"),A(ft,"di"),V(ft,"onVirtualButtonRelease");function Ht(){G("f1",()=>{Ee.inspect=!Ee.inspect}),G("f2",()=>{Ee.clearLog()}),G("f8",()=>{Ee.paused=!Ee.paused}),G("f7",()=>{Ee.timeScale=It(Ft(Ee.timeScale-.2,0,2),1)}),G("f9",()=>{Ee.timeScale=It(Ft(Ee.timeScale+.2,0,2),1)}),G("f10",()=>{Ee.stepFrame()})}s(Ht,"cr"),A(Ht,"Pn"),V(Ht,"enterDebugMode");function Br(){G("b",Yr)}s(Br,"fr"),A(Br,"Rn"),V(Br,"enterBurpMode");function Ct(e){return e!==void 0&&(q.gravity=e),q.gravity}s(Ct,"Cn"),A(Ct,"fi"),V(Ct,"gravity");function hr(...e){return{id:"pos",pos:B(...e),moveBy(...n){this.pos=this.pos.add(B(...n))},move(...n){this.moveBy(B(...n).scale(Ye()))},moveTo(...n){if(typeof n[0]=="number"&&typeof n[1]=="number")return this.moveTo(B(n[0],n[1]),n[2]);let a=n[0],l=n[1];if(l===void 0){this.pos=B(a);return}let b=a.sub(this.pos);if(b.len()<=l*Ye()){this.pos=B(a);return}this.move(b.unit().scale(l))},worldPos(){return this.parent?this.parent.transform.multVec2(this.pos):this.pos},screenPos(){return this.fixed?this.pos:kt(this.pos)},inspect(){return`(${Math.round(this.pos.x)}, ${Math.round(this.pos.y)})`},drawInspect(){gt({color:ie(255,0,0),radius:4/on()})}}}s(hr,"re"),A(hr,"ut"),V(hr,"pos");function lr(...e){return e.length===0?lr(1):{id:"scale",scale:B(...e),scaleTo(...n){this.scale=B(...n)},inspect(){return typeof this.scale=="number"?`${It(this.scale,2)}`:`(${It(this.scale.x,2)}, ${It(this.scale.y,2)})`}}}s(lr,"ne"),A(lr,"ct"),V(lr,"scale");function Ci(e){return{id:"rotate",angle:e??0,rotate(n){this.rotateBy(n*Ye())},rotateBy(n){this.angle+=n},inspect(){return`${Math.round(this.angle)}`}}}s(Ci,"In"),A(Ci,"mi"),V(Ci,"rotate");function Ii(...e){return{id:"color",color:ie(...e),inspect(){return this.color.toString()}}}s(Ii,"Nn"),A(Ii,"pi"),V(Ii,"color");function It(e,n){return Number(e.toFixed(n))}s(It,"Mt"),A(It,"Be"),V(It,"toFixed");function ri(e){return{id:"opacity",opacity:e??1,inspect(){return`${It(this.opacity,2)}`}}}s(ri,"Dn"),A(ri,"gi"),V(ri,"opacity");function dr(e){if(!e)throw new Error("Please define an anchor");return{id:"anchor",anchor:e,inspect(){return typeof this.anchor=="string"?this.anchor:this.anchor.toString()}}}s(dr,"Ve"),A(dr,"Ot"),V(dr,"anchor");function Ni(e){return{id:"z",z:e,inspect(){return`${this.z}`}}}s(Ni,"On"),A(Ni,"wi"),V(Ni,"z");function ii(e,n){return{id:"follow",require:["pos"],follow:{obj:e,offset:n??B(0)},add(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}s(ii,"qn"),A(ii,"bi"),V(ii,"follow");function ni(e,n){let a=typeof e=="number"?Oe.fromAngle(e):e.unit();return{id:"move",require:["pos"],update(){this.move(a.scale(n))}}}s(ni,"Kn"),A(ni,"vi"),V(ni,"move");function oi(e={}){let n=e.distance??64,a=!1;return{id:"outview",require:["pos"],isOutOfView(){let l=kt(this.pos),b=new rt(B(0),Ue(),ve());return!tn(b,l)&&b.distToPoint(l)>n},onExitView(l){return this.on("exitView",l)},onEnterView(l){return this.on("enterView",l)},update(){this.isOutOfView()?(a||(this.trigger("exitView"),a=!0),e.hide&&(this.hidden=!0),e.pause&&(this.paused=!0),e.destroy&&this.destroy()):(a&&(this.trigger("enterView"),a=!1),e.hide&&(this.hidden=!1),e.pause&&(this.paused=!1))},inspect(){return`${this.isOutOfView()}`}}}s(oi,"kn"),A(oi,"yi"),V(oi,"outview");function Di(e={}){let n=[];return{id:"area",colliding:{},collisionIgnore:e.collisionIgnore??[],add(){this.area.cursor&&n.push(this.onHover(()=>un(this.area.cursor))),n.push(this.onCollideUpdate((a,l)=>{this.colliding[a.id]||this.trigger("collide",a,l),this.colliding[a.id]=l}))},update(){for(let a in this.colliding){let l=this.colliding[a];this.checkCollision(l.target)||(delete this.colliding[a],this.trigger("collideEnd",l.target,l))}},drawInspect(){let a=this.localArea();Le(),Re(this.area.scale),de(this.area.offset);let l={outline:{width:4/on(),color:ie(0,0,255)},anchor:this.anchor,fill:!1,fixed:this.fixed};a instanceof rt?ze({...l,pos:a.pos,width:a.width,height:a.height}):a instanceof Tn?Gt({...l,pts:a.pts}):a instanceof Qn&&gt({...l,pos:a.center,radius:a.radius}),Ie()},destroy(){n.forEach(a=>a())},area:{shape:e.shape??null,scale:e.scale??B(1),offset:e.offset??B(0),cursor:e.cursor??null},isClicked(){return ur()&&this.isHovering()},isHovering(){let a=this.fixed?at():Ui(at());return this.hasPoint(a)},checkCollision(a){if(this===a||!a.area||!a.exists())return null;let l=this.worldArea(),b=a.worldArea();return Ws(l,b)},isColliding(a){let l=this.checkCollision(a);return l&&!l.isZero()},isTouching(a){return Boolean(this.checkCollision(a))},onClick(a){return this.onUpdate(()=>{this.isClicked()&&a()})},onHover(a){let l=!1;return this.onUpdate(()=>{l?l=this.isHovering():this.isHovering()&&(l=!0,a())})},onHoverUpdate(a){return this.onUpdate(()=>{this.isHovering()&&a()})},onHoverEnd(a){let l=!1;return this.onUpdate(()=>{l?this.isHovering()||(l=!1,a()):l=this.isHovering()})},onCollide(a,l){if(typeof a=="function"&&l===void 0)return this.on("collide",a);if(typeof a=="string")return this.onCollide((b,c)=>{b.is(a)&&l(b,c)})},onCollideUpdate(a,l){if(typeof a=="function"&&l===void 0)return this.on("collideUpdate",a);if(typeof a=="string")return this.on("collideUpdate",(b,c)=>b.is(a)&&l(b,c))},onCollideEnd(a,l){if(typeof a=="function"&&l===void 0)return this.on("collideEnd",a);if(typeof a=="string")return this.on("collideEnd",b=>b.is(a)&&l(b))},hasPoint(a){return Xs(this.worldArea(),a)},pushOut(a){let l=this.checkCollision(a);l&&(this.pos=this.pos.add(l))},pushOutAll(){q.root.getAll().forEach(this.pushOut)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){let a=this.localArea();if(!(a instanceof Tn||a instanceof rt))throw new Error("Only support polygon and rect shapes for now");let l=this.transform.scale(B(this.area.scale??1)).translate(this.area.offset);if(a instanceof rt){let b=a.bbox(),c=Wi(this.anchor||go).add(1,1).scale(-.5).scale(b.width,b.height);l=l.translate(c)}return a.transform(l)},screenArea(){let a=this.worldArea();return this.fixed?a:a.transform(q.cam.transform)}}}s(Di,"Ln"),A(Di,"Ui"),V(Di,"area");function Wt(e){return{color:e.color,opacity:e.opacity,anchor:e.anchor,outline:e.outline,fixed:e.fixed,shader:e.shader,uniform:e.uniform}}s(Wt,"Kt"),A(Wt,"Ze"),V(Wt,"getRenderProps");function cr(e,n={}){let a=null,l=null;if(!e)throw new Error("Please pass the resource name or data to sprite()");let b=V((c,x,T,C)=>{let k=B(1,1);return T&&C?(k.x=T/(c.width*x.w),k.y=C/(c.height*x.h)):T?(k.x=T/(c.width*x.w),k.y=k.x):C&&(k.y=C/(c.height*x.h),k.x=k.y),k},"calcTexScale");return{id:"sprite",width:0,height:0,frame:n.frame||0,quad:n.quad||new ht(0,0,1,1),animSpeed:n.animSpeed??1,draw(){!a||vr({...Wt(this),sprite:a,frame:this.frame,quad:this.quad,flipX:n.flipX,flipY:n.flipY,tiled:n.tiled,width:n.width,height:n.height})},update(){if(!a){let x=pi(e);if(!x||!x.data)return;let T=x.data.frames[0].clone();n.quad&&(T=T.scale(n.quad));let C=b(x.data.tex,T,n.width,n.height);this.width=x.data.tex.width*T.w*C.x,this.height=x.data.tex.height*T.h*C.y,n.anim&&this.play(n.anim),a=x.data,this.trigger("spriteLoaded",a)}if(!l)return;let c=a.anims[l.name];if(typeof c=="number"){this.frame=c;return}if(c.speed===0)throw new Error("Sprite anim speed cannot be 0");l.timer+=Ye()*this.animSpeed,l.timer>=1/l.speed&&(l.timer=0,c.from>c.to?(this.frame--,this.frame<c.to&&(l.loop?this.frame=c.from:(this.frame++,l.onEnd(),this.stop()))):(this.frame++,this.frame>c.to&&(l.loop?this.frame=c.from:(this.frame--,l.onEnd(),this.stop()))))},play(c,x={}){if(!a){this.on("spriteLoaded",()=>{this.play(c,x)});return}let T=a.anims[c];if(!T)throw new Error(`Anim not found: ${c}`);l&&this.stop(),l=typeof T=="number"?{name:c,timer:0,loop:!1,pingpong:!1,speed:0,onEnd:()=>{}}:{name:c,timer:0,loop:x.loop??T.loop??!1,pingpong:x.pingpong??T.pingpong??!1,speed:x.speed??T.speed??10,onEnd:x.onEnd??(()=>{})},this.frame=typeof T=="number"?T:T.from,this.trigger("animStart",c)},stop(){if(!l)return;let c=l.name;l=null,this.trigger("animEnd",c)},numFrames(){return a?a.frames.length:0},curAnim(){return l?.name},flipX(c){n.flipX=c},flipY(c){n.flipY=c},onAnimEnd(c,x){return this.on("animEnd",T=>{T===c&&x()})},onAnimStart(c,x){return this.on("animStart",T=>{T===c&&x()})},renderArea(){return new rt(B(0),this.width,this.height)},inspect(){if(typeof e=="string")return`"${e}"`}}}s(cr,"ye"),A(cr,"Pt"),V(cr,"sprite");function qi(e,n={}){function a(l){let b=Ut({...Wt(l),text:l.text+"",size:l.textSize,font:l.font,width:n.width&&l.width,align:l.align,letterSpacing:l.letterSpacing,lineSpacing:l.lineSpacing,transform:l.textTransform,styles:l.textStyles});return n.width||(l.width=b.width/(l.scale?.x||1)),l.height=b.height/(l.scale?.y||1),b}return s(a,"n"),A(a,"n"),V(a,"update"),{id:"text",text:e,textSize:n.size??su,font:n.font,width:n.width,height:0,align:n.align,lineSpacing:n.lineSpacing,letterSpacing:n.letterSpacing,textTransform:n.transform,textStyles:n.styles,add(){Gi(()=>a(this))},draw(){Qt(a(this))},renderArea(){return new rt(B(0),this.width,this.height)}}}s(qi,"Jn"),A(qi,"xi"),V(qi,"text");function _t(e,n,a={}){return{id:"rect",width:e,height:n,radius:a.radius||0,draw(){ze({...Wt(this),width:this.width,height:this.height,radius:this.radius})},renderArea(){return new rt(B(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}s(_t,"zn"),A(_t,"Ei"),V(_t,"rect");function si(e,n){return{id:"rect",width:e,height:n,draw(){Xe({...Wt(this),width:this.width,height:this.height})},renderArea(){return new rt(B(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}s(si,"Gn"),A(si,"Si"),V(si,"uvquad");function Ur(e){return{id:"circle",radius:e,draw(){gt({...Wt(this),radius:this.radius})},renderArea(){return new Qn(B(0),this.radius)},inspect(){return`${Math.ceil(this.radius)}`}}}s(Ur,"Yn"),A(Ur,"Ci"),V(Ur,"circle");function Oi(e=1,n=ie(0,0,0)){return{id:"outline",outline:{width:e,color:n}}}s(Oi,"jn"),A(Oi,"Ti"),V(Oi,"outline");function fr(e,n){let a=new Rn;return e&&n&&a.pushd(new jn(e,n)),{id:"timer",wait(l,b){return a.pushd(new jn(l,b))},update(){a.forEach((l,b)=>{l.tick(Ye())&&a.delete(b)})}}}s(fr,"pr"),A(fr,"Dn"),V(fr,"timer");let Nt=640,On=65536;function Ki(e={}){let n=0,a=null,l=null,b=!1,c=[];return{id:"body",require:["pos","area"],jumpForce:e.jumpForce??Nt,gravityScale:e.gravityScale??1,isStatic:e.isStatic??!1,mass:e.mass??0,add(){c.push(this.onCollideUpdate((x,T)=>{if(!x.is("body")||T.resolved||this.isStatic&&x.isStatic)return;let C=!this.isStatic&&x.isStatic?T:T.reverse();C.source.trigger("beforePhysicsResolve",C),C.target.trigger("beforePhysicsResolve",C.reverse()),!T.resolved&&(C.source.pos=C.source.pos.add(C.displacement),C.source.transform=Pi(C.source),T.resolved=!0,C.source.trigger("physicsResolve",C),C.target.trigger("physicsResolve",C.reverse()))})),c.push(this.onPhysicsResolve(x=>{q.gravity&&(x.isBottom()&&this.isFalling()?(n=0,a=x.target,l=x.target.pos,b?b=!1:this.trigger("ground",a)):x.isTop()&&this.isJumping()&&(n=0,this.trigger("headbutt",x.target)))}))},update(){if(!q.gravity||this.isStatic)return;if(b&&(a=null,l=null,this.trigger("fallOff"),b=!1),a)if(!this.isTouching(a)||!a.exists()||!a.is("body"))b=!0;else{!a.pos.eq(l)&&e.stickToPlatform!==!1&&this.moveBy(a.pos.sub(l)),l=a.pos;return}let x=n;n+=q.gravity*this.gravityScale*Ye(),n=Math.min(n,e.maxVelocity??On),x<0&&n>=0&&this.trigger("fall"),this.move(0,n)},destroy(){c.forEach(x=>x())},onPhysicsResolve(x){return this.on("physicsResolve",x)},onBeforePhysicsResolve(x){return this.on("beforePhysicsResolve",x)},curPlatform(){return a},isGrounded(){return a!==null},isFalling(){return n>0},isJumping(){return n<0},jump(x){a=null,l=null,n=-x||-this.jumpForce},onGround(x){return this.on("ground",x)},onFall(x){return this.on("fall",x)},onFallOff(x){return this.on("fallOff",x)},onHeadbutt(x){return this.on("headbutt",x)},inspect(){return`${this.isGrounded()?"grounded":this.isJumping()?"jumping":"falling"}`}}}s(Ki,"Qn"),A(Ki,"Pi"),V(Ki,"body");function Li(e=2){let n=e,a=[];return{id:"doubleJump",require:["body"],numJumps:e,add(){a.push(this.onGround(()=>{n=this.numJumps}))},destroy(){a.forEach(l=>l())},doubleJump(l){n<=0||(n<this.numJumps&&this.trigger("doubleJump"),n--,this.jump(l))},onDoubleJump(l){return this.on("doubleJump",l)},inspect(){return`${n}`}}}s(Li,"Hn"),A(Li,"Ri"),V(Li,"doubleJump");function Ji(e,n={}){return{id:"shader",shader:e,uniform:n}}s(Ji,"Xn"),A(Ji,"Di"),V(Ji,"shader");function xe(){return{id:"fixed",fixed:!0}}s(xe,"Zn"),A(xe,"Mi"),V(xe,"fixed");function bt(){return{id:"stay",stay:!0}}s(bt,"Ar"),A(bt,"Mn"),V(bt,"stay");function zi(e){if(e==null)throw new Error("health() requires the initial amount of hp");return{id:"health",hurt(n=1){this.setHP(e-n),this.trigger("hurt")},heal(n=1){this.setHP(e+n),this.trigger("heal")},hp(){return e},setHP(n){e=n,e<=0&&this.trigger("death")},onHurt(n){return this.on("hurt",n)},onHeal(n){return this.on("heal",n)},onDeath(n){return this.on("death",n)},inspect(){return`${e}`}}}s(zi,"Wn"),A(zi,"Fi"),V(zi,"health");function Yi(e,n={}){if(e==null)throw new Error("lifespan() requires time");let a=0,l=null,b=n.fade??0,c=Math.max(e-b,0);return{id:"lifespan",update(){a+=Ye(),a>=c&&(l===null&&(l=this.opacity??1),this.opacity=Wn(a,c,e,l,0)),a>=e&&this.destroy()}}}s(Yi,"_n"),A(Yi,"Li"),V(Yi,"lifespan");function St(e,n,a){if(!e)throw new Error("state() requires an initial state");let l={};function b(C){l[C]||(l[C]={enter:new qr,end:new qr,update:new qr,draw:new qr})}s(b,"c"),A(b,"h"),V(b,"initStateEvents");function c(C,k,L){return b(k),l[k][C].add(L)}s(c,"o"),A(c,"a"),V(c,"on");function x(C,k,...L){b(k),l[k][C].trigger(...L)}s(x,"d"),A(x,"l"),V(x,"trigger");let T=!1;return{id:"state",state:e,enterState(C,...k){if(T=!0,n&&!n.includes(C))throw new Error(`State not found: ${C}`);let L=this.state;if(a){if(!a?.[L])return;let H=typeof a[L]=="string"?[a[L]]:a[L];if(!H.includes(C))throw new Error(`Cannot transition state from "${L}" to "${C}". Available transitions: ${H.map(we=>`"${we}"`).join(", ")}`)}x("end",L,...k),this.state=C,x("enter",C,...k),x("enter",`${L} -> ${C}`,...k)},onStateTransition(C,k,L){return c("enter",`${C} -> ${k}`,L)},onStateEnter(C,k){return c("enter",C,k)},onStateUpdate(C,k){return c("update",C,k)},onStateDraw(C,k){return c("draw",C,k)},onStateEnd(C,k){return c("end",C,k)},update(){T||(x("enter",e),T=!0),x("update",this.state)},draw(){x("draw",this.state)},inspect(){return this.state}}}s(St,"$n"),A(St,"Bi"),V(St,"state");function Gi(e){p.loaded?e():q.ev.on("load",e)}s(Gi,"ve"),A(Gi,"Rt"),V(Gi,"onLoad");function He(e,n){q.scenes[e]=n}s(He,"ti"),A(He,"Vi"),V(He,"scene");function Ge(e,...n){if(!q.scenes[e])throw new Error(`Scene not found: ${e}`);q.ev.onOnce("frameEnd",()=>{q.ev=new Sn,q.objEvents=new Sn,q.root.get().forEach(a=>{a.stay||q.root.remove(a)}),q.root.clearEvents(),q.timers=new Rn,q.cam={pos:null,scale:B(1),angle:0,shake:0,transform:new Pe},q.gravity=0,q.scenes[e](...n),i.debug!==!1&&Ht(),i.burp&&Br()})}s(Ge,"ei"),A(Ge,"Gi"),V(Ge,"go");function Dt(e,n){try{return JSON.parse(window.localStorage[e])}catch{return n?(ai(e,n),n):null}}s(Dt,"ri"),A(Dt,"Ii"),V(Dt,"getData");function ai(e,n){window.localStorage[e]=JSON.stringify(n)}s(ai,"mr"),A(ai,"Fn"),V(ai,"setData");function Pr(e){let n=e(Kt);for(let a in n)Kt[a]=n[a],i.global!==!1&&(window[a]=n[a]);return Kt}s(Pr,"gr"),A(Pr,"Ln"),V(Pr,"plug");function wt(){return B(Ue()/2,ve()/2)}s(wt,"ie"),A(wt,"lt"),V(wt,"center");function Qe(e,n){return{id:"grid",gridPos:n.clone(),setGridPos(...a){let l=B(...a);this.gridPos=l.clone(),this.pos=B(this.gridPos.x*e.gridWidth(),this.gridPos.y*e.gridHeight())},moveLeft(){this.setGridPos(this.gridPos.add(B(-1,0)))},moveRight(){this.setGridPos(this.gridPos.add(B(1,0)))},moveUp(){this.setGridPos(this.gridPos.add(B(0,-1)))},moveDown(){this.setGridPos(this.gridPos.add(B(0,1)))}}}s(Qe,"ni"),A(Qe,"Ni"),V(Qe,"grid");function $t(e,n){if(!n.width||!n.height)throw new Error("Must provide level grid width & height.");let a=qt([hr(n.pos??B(0))]),l=0,b={id:"level",gridWidth(){return n.width},gridHeight(){return n.height},getPos(...c){let x=B(...c);return B(x.x*n.width,x.y*n.height)},spawn(c,...x){let T=B(...x),C=(()=>{if(n[c]){if(typeof n[c]!="function")throw new Error("Level symbol def must be a function returning a component list");return n[c](T)}else if(n.any)return n.any(c,T)})();if(!C)return;let k=B(T.x*n.width,T.y*n.height);for(let L of C)if(L.id==="pos"){k.x+=L.pos.x,k.y+=L.pos.y;break}return C.push(hr(k)),C.push(Qe(this,T)),a.add(C)},levelWidth(){return l*n.width},levelHeight(){return e.length*n.height}};return a.use(b),e.forEach((c,x)=>{let T=c.split("");l=Math.max(T.length,l),T.forEach((C,k)=>{a.spawn(C,B(k,x))})}),a}s($t,"ii"),A($t,"ji"),V($t,"addLevel");function ui(e){let n=y.canvas.captureStream(e),a=j.ctx.createMediaStreamDestination();j.masterNode.connect(a);let l=new MediaRecorder(n),b=[];return l.ondataavailable=c=>{c.data.size>0&&b.push(c.data)},l.onerror=()=>{j.masterNode.disconnect(a),n.getTracks().forEach(c=>c.stop())},l.start(),{resume(){l.resume()},pause(){l.pause()},stop(){return l.stop(),j.masterNode.disconnect(a),n.getTracks().forEach(c=>c.stop()),new Promise(c=>{l.onstop=()=>{c(new Blob(b,{type:"video/mp4"}))}})},download(c="kaboom.mp4"){this.stop().then(x=>Eo(c,x))}}}s(ui,"oi"),A(ui,"ki"),V(ui,"record");function hi(){return document.activeElement===y.canvas}s(hi,"si"),A(hi,"_i"),V(hi,"isFocused");function Rt(e){e.destroy()}s(Rt,"ai"),A(Rt,"qi"),V(Rt,"destroy");let qt=q.root.add.bind(q.root),er=q.root.readd.bind(q.root),ln=q.root.removeAll.bind(q.root),dn=q.root.get.bind(q.root),cn=q.root.getAll.bind(q.root);function kr(e=2,n=1){let a=0;return{id:"boom",require:["scale"],update(){let l=Math.sin(a*e)*n;l<0&&this.destroy(),this.scale=B(l),a+=Ye()}}}s(kr,"wr"),A(kr,"Gn"),V(kr,"boom");let Tt=nt(null,Wa),fn=nt(null,_a);function pn(e,n={}){let a=qt([hr(e),bt()]),l=(n.speed||1)*5,b=n.scale||1;a.add([cr(fn),lr(0),dr("center"),kr(l,b),...n.comps??[]]);let c=a.add([cr(Tt),lr(0),dr("center"),fr(.4/l,()=>c.use(kr(l,b))),...n.comps??[]]);return c.onDestroy(()=>a.destroy()),a}s(pn,"li"),A(pn,"Xi"),V(pn,"addKaboom");function li(){q.timers.forEach((e,n)=>{e.time-=Ye(),e.time<=0&&(e.action(),q.timers.delete(n))}),q.root.update()}s(li,"Vr"),A(li,"In"),V(li,"updateFrame");let Kn=64;class ut{source;target;displacement;resolved=!1;constructor(n,a,l,b=!1){this.source=n,this.target=a,this.displacement=l,this.resolved=b}reverse(){return new ut(this.target,this.source,this.displacement.scale(-1),this.resolved)}isLeft(){return this.displacement.x>0}isRight(){return this.displacement.x<0}isTop(){return this.displacement.y>0}isBottom(){return this.displacement.y<0}preventResolve(){this.resolved=!0}}s(ut,"oe"),A(ut,"ht"),V(ut,"Collision");function pr(){let e={},n=i.hashGridSize||Kn,a=new Pe,l=[];function b(c){if(l.push(a),c.pos&&(a=a.translate(c.pos)),c.scale&&(a=a.scale(c.scale)),c.angle&&(a=a.rotateZ(c.angle)),c.transform=a.clone(),c.c("area")&&!c.paused){let x=c,T=x.worldArea().bbox(),C=Math.floor(T.pos.x/n),k=Math.floor(T.pos.y/n),L=Math.ceil((T.pos.x+T.width)/n),H=Math.ceil((T.pos.y+T.height)/n),we=new Set;for(let fe=C;fe<=L;fe++)for(let De=k;De<=H;De++)if(!e[fe])e[fe]={},e[fe][De]=[x];else if(!e[fe][De])e[fe][De]=[x];else{let et=e[fe][De];for(let re of et){if(!re.exists()||we.has(re.id))continue;for(let Fe of x.collisionIgnore)re.is(Fe);for(let Fe of re.collisionIgnore)x.is(Fe);let ke=x.checkCollision(re);if(ke&&!ke.isZero()){let Fe=new ut(x,re,ke);x.trigger("collideUpdate",re,Fe);let he=Fe.reverse();he.resolved=Fe.resolved,re.trigger("collideUpdate",x,he)}we.add(re.id)}et.push(x)}}c.get().forEach(b),a=l.pop()}s(b,"c"),A(b,"h"),V(b,"checkObj"),b(q.root)}s(pr,"di"),A(pr,"Qi"),V(pr,"checkFrame");function Mt(){let e=q.cam,n=Oe.fromAngle(Fn(0,360)).scale(e.shake);e.shake=en(e.shake,0,5*Ye()),e.transform=new Pe().translate(wt()).scale(e.scale).rotateZ(e.angle).translate((e.pos??wt()).scale(-1).add(n)),q.root.draw(),Ze()}s(Mt,"ci"),A(Mt,"Ji"),V(Mt,"drawFrame");function Qi(){let e=Se();Et(()=>{let n=Ue()/2,a=24,l=B(Ue()/2,ve()/2).sub(B(n/2,a/2));ze({pos:B(0),width:Ue(),height:ve(),color:ie(0,0,0)}),ze({pos:l,width:n,height:a,fill:!1,outline:{width:4}}),ze({pos:l,width:n*e,height:a})}),q.ev.trigger("loading",e)}s(Qi,"fi"),A(Qi,"Zi"),V(Qi,"drawLoadScreen");function Me(e,n){Et(()=>{let a=B(8);Le(),de(e);let l=Ut({text:n,font:wo,size:16,pos:a,color:ie(255,255,255),fixed:!0}),b=l.width+a.x*2,c=l.height+a.x*2;e.x+b>=Ue()&&de(B(-b,0)),e.y+c>=ve()&&de(B(0,-c)),ze({width:b,height:c,color:ie(0,0,0),radius:4,opacity:.8,fixed:!0}),Qt(l),Ie()})}s(Me,"yr"),A(Me,"Nn"),V(Me,"drawInspectText");function ge(){if(Ee.inspect){let e=null;for(let n of cn())if(n.c("area")&&n.isHovering()){e=n;break}if(q.root.drawInspect(),e){let n=[],a=e.inspect();for(let l in a)a[l]?n.push(`${l}: ${a[l]}`):n.push(`${l}`);Me(Zr(at()),n.join(`
`))}Me(B(8),`FPS: ${Ee.fps()}`)}Ee.paused&&Et(()=>{Le(),de(Ue(),0),de(-8,8);let e=32;ze({width:e,height:e,anchor:"topright",color:ie(0,0,0),opacity:.8,radius:4,fixed:!0});for(let n=1;n<=2;n++)ze({width:4,height:e*.6,anchor:"center",pos:B(-e/3*n,e*.5),color:ie(255,255,255),radius:2,fixed:!0});Ie()}),Ee.timeScale!==1&&Et(()=>{Le(),de(Ue(),ve()),de(-8,-8);let e=8,n=Ut({text:Ee.timeScale.toFixed(1),font:wo,size:16,color:ie(255,255,255),pos:B(-e),anchor:"botright",fixed:!0});ze({width:n.width+e*2+e*4,height:n.height+e*2,anchor:"botright",color:ie(0,0,0),opacity:.8,radius:4,fixed:!0});for(let a=0;a<2;a++){let l=Ee.timeScale<1;Gr({p1:B(-n.width-e*(l?2:3.5),-e),p2:B(-n.width-e*(l?2:3.5),-e-n.height),p3:B(-n.width-e*(l?3.5:2),-e-n.height/2),pos:B(-a*e*1+(l?-e*.5:0),0),color:ie(255,255,255),fixed:!0})}Qt(n),Ie()}),Ee.curRecording&&Et(()=>{Le(),de(0,ve()),de(24,-24),gt({radius:12,color:ie(255,0,0),opacity:vo(0,1,Mr()*4),fixed:!0}),Ie()}),Ee.showLog&&q.logs.length>0&&Et(()=>{Le(),de(0,ve()),de(8,-8);let e=8,n=Ut({text:q.logs.join(`
`),font:wo,pos:B(e,-e),anchor:"botleft",size:16,width:Ue()*.6,lineSpacing:e/2,fixed:!0,styles:{time:{color:ie(127,127,127)},info:{color:ie(255,255,255)},error:{color:ie(255,0,127)}}});ze({width:n.width+e*2,height:n.height+e*2,anchor:"botleft",color:ie(0,0,0),radius:4,opacity:.8,fixed:!0}),Qt(n),Ie()})}s(ge,"pi"),A(ge,"Wi"),V(ge,"drawDebug");function We(){let e=at(),n=V((l,b,c)=>{gt({radius:80/2,pos:l,outline:{width:4,color:ie(0,0,0)},opacity:.5}),c&&Sr({text:c,pos:l,color:ie(0,0,0),size:40,anchor:"center",opacity:.5}),ur("left")&&Zs(new Qn(l,80/2),e)&&q.ev.onOnce("frameEnd",()=>{y.virtualButtonStates[b]="pressed",y.keyStates[b]="pressed"}),Pt("left")&&q.ev.onOnce("frameEnd",()=>{y.virtualButtonStates[b]="released",y.keyStates[b]="released"})},"drawCircleButton"),a=V((l,b,c)=>{ze({width:64,height:64,pos:l,outline:{width:4,color:ie(0,0,0)},radius:4,anchor:"center",opacity:.5}),c&&Sr({text:c,pos:l,color:ie(0,0,0),size:40,anchor:"center",opacity:.5}),ur("left")&&tn(new rt(l.add(-64/2,-64/2),64,64),e)&&q.ev.onOnce("frameEnd",()=>{y.virtualButtonStates[b]="pressed",y.keyStates[b]="pressed"}),Pt("left")&&q.ev.onOnce("frameEnd",()=>{y.virtualButtonStates[b]="released",y.keyStates[b]="released"})},"drawSquareButton");Et(()=>{n(B(Ue()-80,ve()-160),"a"),n(B(Ue()-160,ve()-80),"b"),a(B(60,ve()-124),"left"),a(B(188,ve()-124),"right"),a(B(124,ve()-188),"up"),a(B(124,ve()-60),"down")})}s(We,"Ai"),A(We,"es"),V(We,"drawVirtualControls"),i.debug!==!1&&Ht(),i.burp&&Br();function Cr(e){q.ev.on("loading",e)}s(Cr,"mi"),A(Cr,"ts"),V(Cr,"onLoadUpdate");function Ar(e){q.ev.on("resize",e)}s(Ar,"gi"),A(Ar,"ns"),V(Ar,"onResize");function mr(e){q.ev.on("error",e)}s(mr,"wi"),A(mr,"rs"),V(mr,"onError");function Ir(e){je(()=>{Et(()=>{let n=Ue(),a=ve(),l={size:36,width:n-32*2,letterSpacing:4,lineSpacing:4,font:wo,fixed:!0};ze({width:n,height:a,color:ie(0,0,255),fixed:!0});let b=Ut({...l,text:e.name,pos:B(32),color:ie(255,128,0),fixed:!0});Qt(b),Sr({...l,text:e.message,pos:B(32,32+b.height+16),fixed:!0}),Ie(),q.ev.trigger("error",e)})})}s(Ir,"xe"),A(Ir,"Dt"),V(Ir,"handleErr");function Nr(){for(let e in y.keyStates)y.keyStates[e]=Xn(y.keyStates[e]);for(let e in y.mouseStates)y.mouseStates[e]=Xn(y.mouseStates[e]);for(let e in y.virtualButtonStates)y.virtualButtonStates[e]=Xn(y.virtualButtonStates[e]);y.charInputted=[],y.isMouseMoved=!1,y.isKeyPressed=!1,y.isKeyPressedRepeat=!1,y.isKeyReleased=!1}s(Nr,"Vi"),A(Nr,"is"),V(Nr,"resetInputState");function je(e){y.loopID!==null&&cancelAnimationFrame(y.loopID);let n=V(a=>{if(y.stopped)return;if(document.visibilityState!=="visible"){y.loopID=requestAnimationFrame(n);return}let l=a/1e3,b=l-y.realTime;y.realTime=l,y.skipTime||(y.dt=b,y.time+=Ye(),y.fpsCounter.tick(y.dt)),y.skipTime=!1,y.numFrames++,wi(),e(),zt(),Nr(),q.ev.trigger("frameEnd"),y.loopID=requestAnimationFrame(n)},"frame");n(0)}s(je,"vr"),A(je,"jn"),V(je,"run");function di(){q.ev.onOnce("frameEnd",()=>{y.stopped=!0,v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT|v.STENCIL_BUFFER_BIT);let e=v.getParameter(v.MAX_TEXTURE_IMAGE_UNITS);for(let n=0;n<e;n++)v.activeTexture(v.TEXTURE0+n),v.bindTexture(v.TEXTURE_2D,null),v.bindTexture(v.TEXTURE_CUBE_MAP,null);v.bindBuffer(v.ARRAY_BUFFER,null),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,null),v.bindRenderbuffer(v.RENDERBUFFER,null),v.bindFramebuffer(v.FRAMEBUFFER,null),E.forEach(n=>n()),v.deleteBuffer(P.vbuf),v.deleteBuffer(P.ibuf);for(let n in st)y.canvas.removeEventListener(n,st[n]);for(let n in bi)document.removeEventListener(n,bi[n]);for(let n in Qr)window.removeEventListener(n,Qr[n])})}s(di,"yi"),A(di,"ss"),V(di,"quit"),ue("happy",Za,28,36),je(()=>{p.loaded||Se()===1&&(p.loaded=!0,q.ev.trigger("load")),!p.loaded&&i.loadingScreen!==!1?Qi():(q.ev.trigger("input"),Ee.paused||li(),pr(),Mt(),i.debug!==!1&&ge(),i.virtualControls&&$r()&&We())});function Ot(e,n,a,l,b=Zn.linear){let c=0,x=ei(()=>{c+=Ye();let T=Math.min(c/a,1);l(en(e,n,b(T))),T===1&&x()});return x}s(Ot,"vi"),A(Ot,"os"),V(Ot,"tween");let Kt={VERSION:$a,loadRoot:Je,loadProgress:Se,loadSprite:nt,loadSpriteAtlas:Kr,loadSound:Bn,loadBitmapFont:ue,loadFont:ye,loadShader:$,loadAseprite:oe,loadPedit:yt,loadBean:Ke,load:se,getSprite:Lr,getSound:pe,getFont:Jr,getBitmapFont:rn,getShader:nn,Asset:ee,SpriteData:W,SoundData:_,width:Ue,height:ve,center:wt,dt:Ye,time:Mr,screenshot:Fi,record:ui,isFocused:hi,setCursor:un,setFullscreen:Nn,isFullscreen:jt,isTouchScreen:$r,onLoad:Gi,onLoadUpdate:Cr,onResize:Ar,onError:mr,camPos:Zt,camScale:Bi,camRot:Fr,shake:Dn,toScreen:kt,toWorld:Ui,gravity:Ct,add:qt,destroy:Rt,destroyAll:ln,get:dn,getAll:cn,readd:er,pos:hr,scale:lr,rotate:Ci,color:Ii,opacity:ri,anchor:dr,area:Di,sprite:cr,text:qi,rect:_t,circle:Ur,uvquad:si,outline:Oi,body:Ki,doubleJump:Li,shader:Ji,timer:fr,fixed:xe,stay:bt,health:zi,lifespan:Yi,z:Ni,move:ni,outview:oi,follow:ii,state:St,on:Xt,onUpdate:ei,onDraw:hn,onAdd:ti,onDestroy:qn,onCollide:r,onClick:m,onHover:g,onHoverUpdate:O,onHoverEnd:U,onKeyDown:Q,onKeyPress:G,onKeyPressRepeat:ce,onKeyRelease:Y,onMouseDown:D,onMousePress:Te,onMouseRelease:me,onMouseMove:xt,onCharInput:lt,onTouchStart:dt,onTouchMove:J,onTouchEnd:ae,onVirtualButtonPress:$e,onVirtualButtonDown:ct,onVirtualButtonRelease:ft,mousePos:at,mouseDeltaPos:Rr,isKeyDown:Tr,isKeyPressed:Wr,isKeyPressedRepeat:Ri,isKeyReleased:_r,isMouseDown:Hr,isMousePressed:ur,isMouseReleased:Pt,isMouseMoved:Si,isVirtualButtonPressed:Ti,isVirtualButtonDown:Mi,isVirtualButtonReleased:an,loop:X,wait:Z,play:Bt,volume:sr,burp:Yr,audioCtx:j.ctx,Timer:jn,Line:$i,Rect:rt,Circle:Qn,Polygon:Tn,Vec2:Oe,Color:le,Mat4:Pe,Quad:ht,RNG:Ls,rand:Fn,randi:So,randSeed:Js,vec2:B,rgb:ie,hsl2rgb:Ya,quad:Ks,choose:Ys,chance:zs,lerp:en,tween:Ot,easings:Zn,map:Wn,mapc:qs,wave:vo,deg2rad:Or,rad2deg:bo,testLineLine:_i,testRectRect:Gs,testRectLine:js,testRectPoint:tn,drawSprite:vr,drawText:Sr,formatText:Ut,drawRect:ze,drawLine:vt,drawLines:Er,drawTriangle:Gr,drawCircle:gt,drawEllipse:xr,drawUVQuad:Xe,drawPolygon:Gt,drawFormattedText:Qt,drawMasked:br,drawSubtracted:Pn,pushTransform:Le,popTransform:Ie,pushTranslate:de,pushScale:Re,pushRotate:Un,pushRotateX:yr,pushRotateY:vi,pushRotateZ:ot,pushMatrix:yi,debug:Ee,scene:He,go:Ge,addLevel:$t,getData:Dt,setData:ai,download:_n,downloadJSON:ea,downloadText:To,downloadBlob:Eo,plug:Pr,ASCII_CHARS:da,canvas:y.canvas,addKaboom:pn,LEFT:Oe.LEFT,RIGHT:Oe.RIGHT,UP:Oe.UP,DOWN:Oe.DOWN,RED:le.RED,GREEN:le.GREEN,BLUE:le.BLUE,YELLOW:le.YELLOW,MAGENTA:le.MAGENTA,CYAN:le.CYAN,WHITE:le.WHITE,BLACK:le.BLACK,quit:di};if(i.plugins&&i.plugins.forEach(Pr),i.global!==!1)for(let e in Kt)window[e]=Kt[e];return Kt},"default");function Mn(i,E){return{id:"fade",add(){switch(i){case"in":this.fadeIn(E??1);break;case"out":this.fadeOut(E??1);break;default:break}},fadeIn(y=1){tween(this.opacity??0,1,y,v=>{this.opacity=v},easings.linear)},fadeOut(y=1){tween(this.opacity??1,0,y,v=>{this.opacity=v},easings.linear)}}}s(Mn,"Ct");A(Mn,"fade");function xa(i){return!i||i.length<2?null:vec2(i[0],i[1])}s(xa,"no");A(xa,"array2Vec2");function ba(i,E){let y=document.createElement("a");y.href=E,y.download=i,y.click()}s(ba,"io");A(ba,"download");function Sa(){let i,E;return{id:"kn_tb_comp",require:[],curChar:0,skipped:!1,addEx(){i=this.get("kn_tb_textbox")[0],E=this.get("kn_nb_namebox")[0]},write(y){return new Promise(v=>{i.text="";let h=loop(.05,()=>{if(this.skipped)return this.skipped=!1,i.text=y,this.curChar=0,v(),h();if(i.text+=y[this.curChar],this.curChar++,this.curChar==y.length)return this.curChar=0,v(),h()})})},setName(y,v){E.text=y,E.use(color(v?Color.fromHex(String(v)):rgb(255,255,255)))},skipText(){this.skipped||(this.skipped=!0)},show(y=1){this.children.forEach(v=>{v.use(Mn("in",y))})},hide(y=1){this.children.forEach(v=>{v.use(Mn("out",y))})}}}s(Sa,"zo");A(Sa,"textbox");function Ra(i,E={},y={}){let v={pos:xa(E.pos),width:E.width??i.width(),height:E.height??i.height()/8,sprite:E.sprite??null,size:E.size??42,font:E.font??"Sans-Serif",color:E.color?i.Color.fromHex(E.color):BLACK,border:E.border??[5,0,0,5]},h={border:y.border??[0,0,0,0],size:y.size??82},P=v.sprite?i.getSprite(v.sprite).data?.tex.height:v.height,W=v.sprite?i.getSprite(v.sprite).data?.tex.width:v.width,_=i.width()-(i.width()-W),j=i.add([i.pos(v.pos??i.vec2(i.center().x,i.height()-P/2)),i.z(999),i.anchor("center"),Sa()]);return j.add([i.pos(0,0),i.z(0),i.anchor("center"),v.sprite?i.sprite(v.sprite):i.rect(v.width,v.height),"kn_tb_background"]),j.add([i.pos(0-W/2+v.border[3],0-P/2+v.border[0]),i.z(1),i.anchor("topleft"),i.text("",{size:v.size,font:E.font,width:_-v.border[3],align:"left"}),i.color(v.color),"kn_tb_textbox"]),j.add([i.pos(0-W/2+h.border[3],0-P/2+h.border[0])]),j.add([i.pos(0-W/2+h.border[3],0-P/2+h.border[0]),i.z(1),i.anchor("botleft"),i.text("",{size:h.size}),"kn_nb_namebox"]),j.addEx(),j}s(Ra,"oo");A(Ra,"addTextbox");var Ns;function Ta(i={}){let E={width:i.width??1280,height:i.height??720,letterbox:i.letterbox??!0,stretch:i.stretch??!0,plugins:[Ma],textbox:i.textbox||{},namebox:i.namebox||{}};cu(E),Ns=E}s(Ta,"Go");A(Ta,"kanovel");function Ma(i){let E=new Map,y=new Map,v=new Map,h="start",P=-1,W=!1,_;async function j(){W=!0,P++;let K=y.get(h)[P];if(!K)return W=!1;await K.run(),W=!1,K.autoskip&&j()}s(j,"E"),A(j,"nextAction");function ee(){let K=y.get(h)[P];K.skip&&K.skip()}s(ee,"M"),A(ee,"skipAction");function Ae(K,ne){if(y.get(K))throw new Error(`You can't repeat the chapter name! "${K}"`);y.set(K,ne())}s(Ae,"C"),A(Ae,"addChapter");function p(K){if(!y.get(K))throw new Error(`Chapter not found: ${K}`);h=K,P=-1}s(p,"x"),A(p,"changeChapter");function q(K){let ne=i.play(K);v.set(K,ne)}s(q,"w"),A(q,"addAudio");function se(K){v.get(K)?.stop(),v.delete(K)}s(se,"z"),A(se,"removeAudio");function Se(K,ne,_e){let ye=E.get(K);if(!ye)throw Error("Character's id not found.");let ue=ye.opt.expressions?.[ne];if(!ue)throw Error(`Character's expression ${ne} not found.`);let F={left:[i.anchor("botleft"),i.pos(0,i.height())],center:[i.anchor("bot"),i.pos(i.center().x,i.height())],right:[i.anchor("botright"),i.pos(i.width(),i.height())]};i.add([...F[_e],i.z(100),i.sprite(ue),i.opacity(0),Mn("in",.4),ye.id])}s(Se,"q"),A(Se,"showCharacter");function Je(K){let ne=E.get(K);if(!ne)throw Error("Character's id not found.");i.get(ne.id)[0].destroy()}s(Je,"xt"),A(Je,"hideCharacter");function it(K){i.add([i.pos(i.center()),i.anchor("center"),i.sprite(K),Mn(),"bg"])}s(it,"dt"),A(it,"showBackground");function Be(K,ne){i.add([i.pos(i.center()),i.anchor("center"),i.rect(i.width(),i.height()),i.color(Color.fromHex(K)),ne?Mn("in"):{},"kn_game_background"])}return s(Be,"ct"),A(Be,"showBackgroundColor"),i.scene("kanovel",()=>{if(i.volume(.5),!y.get("start"))throw Error("Should define a start chapter.");_=Ra(i,Ns.textbox??{},Ns.namebox),j(),i.onUpdate(()=>{if((i.isMousePressed("left")||i.isKeyPressed("space"))&&(W?ee():j()),i.isKeyPressed("s")){let K=onDraw(()=>{ba("screenshot.png",i.screenshot()),K()})}})}),i.onLoad(()=>{i.go("kanovel")}),{chapter(K,ne){Ae(K,ne)},character(K,ne,_e){E.set(K,{id:K,name:ne,opt:_e})},say(...K){if(K.length===2){let ne=E.get(K[0]);if(!ne)throw Error("Character not found");return{id:"say",async run(){_.setName(ne.name,ne.opt?.color),await _.write(K[1])},skip(){_.skipText()}}}else return{id:"say",async run(){_.setName(" "),await _.write(K[0])},skip(){_.skipText()}}},show(K,ne,_e="center"){return{id:"show",autoskip:!0,run(){Se(K,ne,_e)},noSkip(){return this.autoskip=!1,this}}},hide(K){return{id:"hide",run(){Je(K)}}},jump(K){return{id:"jump",autoskip:!0,run(){p(K)}}},showBackground(){return{id:"showBackground",autoskip:!0,run(){it("a")}}},showBackgroundColor(K,ne){return{id:"showBackgroundColor",autoskip:!0,run(){Be(K,ne)}}},showTextbox(K){return{id:"showTextbox",run(){_.show(K)}}},hideTextbox(K){return{id:"hideTextbox",run(){_.hide(K)}}},playMusic(K){return{id:"play",autoskip:!0,async run(){q(K)}}},stopMusic(K){return{id:"stop",autoskip:!0,async run(){se(K)}}}}}s(Ma,"Yo");A(Ma,"kanovelPlugin");var Fa=Ta;var Uu=(()=>{var i=Object.defineProperty,E=Object.getOwnPropertyDescriptor,y=Object.getOwnPropertyNames,v=Object.prototype.hasOwnProperty,h=s((r,w)=>i(r,"name",{value:w,configurable:!0}),"s"),P=s((r,w)=>{for(var m in w)i(r,m,{get:w[m],enumerable:!0})},"xo"),W=s((r,w,m,g)=>{if(w&&typeof w=="object"||typeof w=="function")for(let O of y(w))!v.call(r,O)&&O!==m&&i(r,O,{get:()=>w[O],enumerable:!(g=E(w,O))||g.enumerable});return r},"Eo"),_=s(r=>W(i({},"__esModule",{value:!0}),r),"bo"),j={};P(j,{default:()=>qn,kanovelPlugin:()=>ti});var ee=Object.defineProperty,Ae=h((r,w,m)=>w in r?ee(r,w,{enumerable:!0,configurable:!0,writable:!0,value:m}):r[w]=m,"cs"),p=h((r,w)=>ee(r,"name",{value:w,configurable:!0}),"u"),q=h((r,w)=>{for(var m in w)ee(r,m,{get:w[m],enumerable:!0})},"ls"),se=h((r,w,m)=>(Ae(r,typeof w!="symbol"?w+"":w,m),m),"Z"),Se=(()=>{for(var r=new Uint8Array(128),w=0;w<64;w++)r[w<26?w+65:w<52?w+71:w<62?w-4:w*4-205]=w;return m=>{for(var g=m.length,O=new Uint8Array((g-(m[g-1]=="=")-(m[g-2]=="="))*3/4|0),U=0,Z=0;U<g;){var X=r[m.charCodeAt(U++)],Q=r[m.charCodeAt(U++)],G=r[m.charCodeAt(U++)],ce=r[m.charCodeAt(U++)];O[Z++]=X<<2|Q>>4,O[Z++]=Q<<4|G>>2,O[Z++]=G<<6|ce}return O}})();function Je(r){return r*Math.PI/180}s(Je,"vt"),h(Je,"me"),p(Je,"deg2rad");function it(r){return r*180/Math.PI}s(it,"Ur"),h(it,"Bt"),p(it,"rad2deg");function Be(r,w,m){return w>m?Be(r,m,w):Math.min(Math.max(r,w),m)}s(Be,"ot"),h(Be,"te"),p(Be,"clamp");function K(r,w,m){return r+(w-r)*m}s(K,"Qt"),h(K,"ze"),p(K,"lerp");function ne(r,w,m,g,O){return g+(r-w)/(m-w)*(O-g)}s(ne,"Be"),h(ne,"dt"),p(ne,"map");function _e(r,w,m,g,O){return Be(ne(r,w,m,g,O),g,O)}s(_e,"Ni"),h(_e,"qn"),p(_e,"mapc");var ye=h(class{x=0;y=0;constructor(r=0,w=r){this.x=r,this.y=w}static fromAngle(r){let w=Je(r);return new ye(Math.cos(w),Math.sin(w))}clone(){return new ye(this.x,this.y)}add(...r){let w=F(...r);return new ye(this.x+w.x,this.y+w.y)}sub(...r){let w=F(...r);return new ye(this.x-w.x,this.y-w.y)}scale(...r){let w=F(...r);return new ye(this.x*w.x,this.y*w.y)}dist(...r){let w=F(...r);return Math.sqrt((this.x-w.x)*(this.x-w.x)+(this.y-w.y)*(this.y-w.y))}len(){return this.dist(new ye(0,0))}unit(){let r=this.len();return r===0?new ye(0):this.scale(1/r)}normal(){return new ye(this.y,-this.x)}dot(r){return this.x*r.x+this.y*r.y}angle(...r){let w=F(...r);return it(Math.atan2(this.y-w.y,this.x-w.x))}lerp(r,w){return new ye(K(this.x,r.x,w),K(this.y,r.y,w))}isZero(){return this.x===0&&this.y===0}toFixed(r){return new ye(Number(this.x.toFixed(r)),Number(this.y.toFixed(r)))}eq(r){return this.x===r.x&&this.y===r.y}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}},"H"),ue=ye;p(ue,"Vec2"),se(ue,"LEFT",new ye(-1,0)),se(ue,"RIGHT",new ye(1,0)),se(ue,"UP",new ye(0,-1)),se(ue,"DOWN",new ye(0,1));function F(...r){if(r.length===1){if(r[0]instanceof ue)return F(r[0].x,r[0].y);if(Array.isArray(r[0])&&r[0].length===2)return F(...r[0])}return new ue(...r)}s(F,"p"),h(F,"f"),p(F,"vec2");var Kr=h(class{x=0;y=0;z=0;constructor(r,w,m){this.x=r,this.y=w,this.z=m}xy(){return F(this.x,this.y)}},"je");p(Kr,"Vec3");var nt=p((r,w,m)=>new Kr(r,w,m),"vec3"),yt=h(class{r=255;g=255;b=255;constructor(r,w,m){this.r=Be(r,0,255),this.g=Be(w,0,255),this.b=Be(m,0,255)}static fromArray(r){return new yt(r[0],r[1],r[2])}static fromHex(r){if(typeof r=="number")return new yt(r>>16&255,r>>8&255,r>>0&255);{let w=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return new yt(parseInt(w[1],16),parseInt(w[2],16),parseInt(w[3],16))}}static fromHSL(r,w,m){if(w==0)return $(255*m,255*m,255*m);let g=p((G,ce,Y)=>(Y<0&&(Y+=1),Y>1&&(Y-=1),Y<1/6?G+(ce-G)*6*Y:Y<1/2?ce:Y<2/3?G+(ce-G)*(2/3-Y)*6:G),"hue2rgb"),O=m<.5?m*(1+w):m+w-m*w,U=2*m-O,Z=g(U,O,r+1/3),X=g(U,O,r),Q=g(U,O,r-1/3);return new yt(Math.round(Z*255),Math.round(X*255),Math.round(Q*255))}clone(){return new yt(this.r,this.g,this.b)}lighten(r){return new yt(this.r+r,this.g+r,this.b+r)}darken(r){return this.lighten(-r)}invert(){return new yt(255-this.r,255-this.g,255-this.b)}mult(r){return new yt(this.r*r.r/255,this.g*r.g/255,this.b*r.b/255)}eq(r){return this.r===r.r&&this.g===r.g&&this.b===r.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}toHex(){return"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}},"se"),oe=yt;p(oe,"Color"),se(oe,"RED",$(255,0,0)),se(oe,"GREEN",$(0,255,0)),se(oe,"BLUE",$(0,0,255)),se(oe,"YELLOW",$(255,255,0)),se(oe,"MAGENTA",$(255,0,255)),se(oe,"CYAN",$(0,255,255)),se(oe,"WHITE",$(255,255,255)),se(oe,"BLACK",$(0,0,0));function $(...r){if(r.length===0)return new oe(255,255,255);if(r.length===1){if(r[0]instanceof oe)return r[0].clone();if(Array.isArray(r[0])&&r[0].length===3)return oe.fromArray(r[0])}return new oe(...r)}s($,"T"),h($,"x"),p($,"rgb");var Bn=p((r,w,m)=>oe.fromHSL(r,w,m),"hsl2rgb"),Ke=h(class{x=0;y=0;w=1;h=1;constructor(r,w,m,g){this.x=r,this.y=w,this.w=m,this.h=g}scale(r){return new Ke(this.x+this.w*r.x,this.y+this.h*r.y,this.w*r.w,this.h*r.h)}clone(){return new Ke(this.x,this.y,this.w,this.h)}eq(r){return this.x===r.x&&this.y===r.y&&this.w===r.w&&this.h===r.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}},"j");p(Ke,"Quad");function Lr(r,w,m,g){return new Ke(r,w,m,g)}s(Lr,"Di"),h(Lr,"Hn"),p(Lr,"quad");var pe=h(class{m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];constructor(r){r&&(this.m=r)}static translate(r){return new pe([1,0,0,0,0,1,0,0,0,0,1,0,r.x,r.y,0,1])}static scale(r){return new pe([r.x,0,0,0,0,r.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(r){return r=Je(-r),new pe([1,0,0,0,0,Math.cos(r),-Math.sin(r),0,0,Math.sin(r),Math.cos(r),0,0,0,0,1])}static rotateY(r){return r=Je(-r),new pe([Math.cos(r),0,Math.sin(r),0,0,1,0,0,-Math.sin(r),0,Math.cos(r),0,0,0,0,1])}static rotateZ(r){return r=Je(-r),new pe([Math.cos(r),-Math.sin(r),0,0,Math.sin(r),Math.cos(r),0,0,0,0,1,0,0,0,0,1])}translate(r){return this.mult(pe.translate(r))}scale(r){return this.mult(pe.scale(r))}rotateX(r){return this.mult(pe.rotateX(r))}rotateY(r){return this.mult(pe.rotateY(r))}rotateZ(r){return this.mult(pe.rotateZ(r))}mult(r){let w=[];for(let m=0;m<4;m++)for(let g=0;g<4;g++)w[m*4+g]=this.m[0*4+g]*r.m[m*4+0]+this.m[1*4+g]*r.m[m*4+1]+this.m[2*4+g]*r.m[m*4+2]+this.m[3*4+g]*r.m[m*4+3];return new pe(w)}multVec4(r){return{x:r.x*this.m[0]+r.y*this.m[4]+r.z*this.m[8]+r.w*this.m[12],y:r.x*this.m[1]+r.y*this.m[5]+r.z*this.m[9]+r.w*this.m[13],z:r.x*this.m[2]+r.y*this.m[6]+r.z*this.m[10]+r.w*this.m[14],w:r.x*this.m[3]+r.y*this.m[7]+r.z*this.m[11]+r.w*this.m[15]}}multVec3(r){let w=this.multVec4({x:r.x,y:r.y,z:r.z,w:1});return nt(w.x,w.y,w.z)}multVec2(r){return F(r.x*this.m[0]+r.y*this.m[4]+0*this.m[8]+1*this.m[12],r.x*this.m[1]+r.y*this.m[5]+0*this.m[9]+1*this.m[13])}invert(){let r=[],w=this.m[10]*this.m[15]-this.m[14]*this.m[11],m=this.m[9]*this.m[15]-this.m[13]*this.m[11],g=this.m[9]*this.m[14]-this.m[13]*this.m[10],O=this.m[8]*this.m[15]-this.m[12]*this.m[11],U=this.m[8]*this.m[14]-this.m[12]*this.m[10],Z=this.m[8]*this.m[13]-this.m[12]*this.m[9],X=this.m[6]*this.m[15]-this.m[14]*this.m[7],Q=this.m[5]*this.m[15]-this.m[13]*this.m[7],G=this.m[5]*this.m[14]-this.m[13]*this.m[6],ce=this.m[4]*this.m[15]-this.m[12]*this.m[7],Y=this.m[4]*this.m[14]-this.m[12]*this.m[6],D=this.m[5]*this.m[15]-this.m[13]*this.m[7],Te=this.m[4]*this.m[13]-this.m[12]*this.m[5],me=this.m[6]*this.m[11]-this.m[10]*this.m[7],xt=this.m[5]*this.m[11]-this.m[9]*this.m[7],lt=this.m[5]*this.m[10]-this.m[9]*this.m[6],dt=this.m[4]*this.m[11]-this.m[8]*this.m[7],J=this.m[4]*this.m[10]-this.m[8]*this.m[6],ae=this.m[4]*this.m[9]-this.m[8]*this.m[5];r[0]=this.m[5]*w-this.m[6]*m+this.m[7]*g,r[4]=-(this.m[4]*w-this.m[6]*O+this.m[7]*U),r[8]=this.m[4]*m-this.m[5]*O+this.m[7]*Z,r[12]=-(this.m[4]*g-this.m[5]*U+this.m[6]*Z),r[1]=-(this.m[1]*w-this.m[2]*m+this.m[3]*g),r[5]=this.m[0]*w-this.m[2]*O+this.m[3]*U,r[9]=-(this.m[0]*m-this.m[1]*O+this.m[3]*Z),r[13]=this.m[0]*g-this.m[1]*U+this.m[2]*Z,r[2]=this.m[1]*X-this.m[2]*Q+this.m[3]*G,r[6]=-(this.m[0]*X-this.m[2]*ce+this.m[3]*Y),r[10]=this.m[0]*D-this.m[1]*ce+this.m[3]*Te,r[14]=-(this.m[0]*G-this.m[1]*Y+this.m[2]*Te),r[3]=-(this.m[1]*me-this.m[2]*xt+this.m[3]*lt),r[7]=this.m[0]*me-this.m[2]*dt+this.m[3]*J,r[11]=-(this.m[0]*xt-this.m[1]*dt+this.m[3]*ae),r[15]=this.m[0]*lt-this.m[1]*J+this.m[2]*ae;let $e=this.m[0]*r[0]+this.m[1]*r[4]+this.m[2]*r[8]+this.m[3]*r[12];for(let ct=0;ct<4;ct++)for(let ft=0;ft<4;ft++)r[ct*4+ft]*=1/$e;return new pe(r)}clone(){return new pe(this.m)}toString(){return this.m.toString()}},"A");p(pe,"Mat4");function Jr(r,w,m,g=Math.sin){return r+(g(m)+1)/2*(w-r)}s(Jr,"Rr"),h(Jr,"Vt"),p(Jr,"wave");var rn=1103515245,nn=12345,pi=2147483648,Ai=h(class{seed;constructor(r){this.seed=r}gen(){return this.seed=(rn*this.seed+nn)%pi,this.seed/pi}genNumber(r,w){return r+this.gen()*(w-r)}genVec2(r,w){return new ue(this.genNumber(r.x,w.x),this.genNumber(r.y,w.y))}genColor(r,w){return new oe(this.genNumber(r.r,w.r),this.genNumber(r.g,w.g),this.genNumber(r.b,w.b))}genAny(...r){if(r.length===0)return this.gen();if(r.length===1){if(typeof r[0]=="number")return this.genNumber(0,r[0]);if(r[0]instanceof ue)return this.genVec2(F(0,0),r[0]);if(r[0]instanceof oe)return this.genColor($(0,0,0),r[0])}else if(r.length===2){if(typeof r[0]=="number"&&typeof r[1]=="number")return this.genNumber(r[0],r[1]);if(r[0]instanceof ue&&r[1]instanceof ue)return this.genVec2(r[0],r[1]);if(r[0]instanceof oe&&r[1]instanceof oe)return this.genColor(r[0],r[1])}}},"ke");p(Ai,"RNG");var mi=new Ai(Date.now());function zr(r){return r!=null&&(mi.seed=r),mi.seed}s(zr,"Oi"),h(zr,"$n"),p(zr,"randSeed");function sr(...r){return mi.genAny(...r)}s(sr,"le"),h(sr,"et"),p(sr,"rand");function Bt(...r){return Math.floor(sr(...r))}s(Bt,"Ir"),h(Bt,"Gt"),p(Bt,"randi");function Yr(r){return sr()<=r}s(Yr,"qi"),h(Yr,"Yn"),p(Yr,"chance");function wr(r){return r[Bt(r.length)]}s(wr,"Ki"),h(wr,"Xn"),p(wr,"choose");function gi(r,w){return r.pos.x+r.width>w.pos.x&&r.pos.x<w.pos.x+w.width&&r.pos.y+r.height>w.pos.y&&r.pos.y<w.pos.y+w.height}s(gi,"ki"),h(gi,"Kn"),p(gi,"testRectRect");function Vr(r,w){if(r.p1.x===r.p2.x&&r.p1.y===r.p2.y||w.p1.x===w.p2.x&&w.p1.y===w.p2.y)return null;let m=(w.p2.y-w.p1.y)*(r.p2.x-r.p1.x)-(w.p2.x-w.p1.x)*(r.p2.y-r.p1.y);if(m===0)return null;let g=((w.p2.x-w.p1.x)*(r.p1.y-w.p1.y)-(w.p2.y-w.p1.y)*(r.p1.x-w.p1.x))/m,O=((r.p2.x-r.p1.x)*(r.p1.y-w.p1.y)-(r.p2.y-r.p1.y)*(r.p1.x-w.p1.x))/m;return g<0||g>1||O<0||O>1?null:g}s(Vr,"Li"),h(Vr,"ms"),p(Vr,"testLineLineT");function Ze(r,w){let m=Vr(r,w);return m?F(r.p1.x+m*(r.p2.x-r.p1.x),r.p1.y+m*(r.p2.y-r.p1.y)):null}s(Ze,"Yt"),h(Ze,"Ne"),p(Ze,"testLineLine");function wi(r,w){if(zt(r,w.p1)||zt(r,w.p2))return!0;let m=r.points();return!!Ze(w,new de(m[0],m[1]))||!!Ze(w,new de(m[1],m[2]))||!!Ze(w,new de(m[2],m[3]))||!!Ze(w,new de(m[3],m[0]))}s(wi,"Ji"),h(wi,"Qn"),p(wi,"testRectLine");function zt(r,w){return w.x>r.pos.x&&w.x<r.pos.x+r.width&&w.y>r.pos.y&&w.y<r.pos.y+r.height}s(zt,"Ht"),h(zt,"He"),p(zt,"testRectPoint");function Vi(r,w){return r.center.dist(w)<r.radius}s(Vi,"zi"),h(Vi,"Jn"),p(Vi,"testCirclePoint");function yi(r,w){let m=!1,g=r.pts;for(let O=0,U=g.length-1;O<g.length;U=O++)g[O].y>w.y!=g[U].y>w.y&&w.x<(g[U].x-g[O].x)*(w.y-g[O].y)/(g[U].y-g[O].y)+g[O].x&&(m=!m);return m}s(yi,"Gi"),h(yi,"Zn"),p(yi,"testPolygonPoint");var de=h(class{p1;p2;constructor(r,w){this.p1=r,this.p2=w}transform(r){return new de(r.multVec2(this.p1),r.multVec2(this.p2))}bbox(){return Re.fromPoints(this.p1,this.p2)}},"ie");p(de,"Line");var Re=h(class{pos;width;height;constructor(r,w,m){this.pos=r,this.width=w,this.height=m}static fromPoints(r,w){return new Re(r.clone(),w.x-r.x,w.y-r.y)}center(){return new ue(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(r){return new ot(this.points().map(w=>r.multVec2(w)))}bbox(){return new Re(this.pos.clone(),this.width,this.height)}distToPoint(r){let w=this.pos,m=this.pos.add(this.width,this.height),g=Math.max(w.x-r.x,0,r.x-m.x),O=Math.max(w.y-r.y,0,r.y-m.y);return Math.sqrt(g*g+O*O)}},"I");p(Re,"Rect");var yr=h(class{center;radius;constructor(r,w){this.center=r,this.radius=w}transform(r){return new vi(this.center,this.radius,this.radius).transform(r)}bbox(){return Re.fromPoints(this.center.sub(F(this.radius)),this.center.add(F(this.radius)))}},"pe");p(yr,"Circle");var vi=h(class{center;radiusX;radiusY;constructor(r,w,m){this.center=r,this.radiusX=w,this.radiusY=m}transform(r){return new vi(r.multVec2(this.center),r.m[0]*this.radiusX,r.m[5]*this.radiusY)}bbox(){return Re.fromPoints(this.center.sub(F(this.radiusX,this.radiusY)),this.center.add(F(this.radiusX,this.radiusY)))}},"_e");p(vi,"Ellipse");var ot=h(class{pts;constructor(r){if(r.length<3)throw new Error("Polygons should have at least 3 vertices");this.pts=r}transform(r){return new ot(this.pts.map(w=>r.multVec2(w)))}bbox(){let r=F(Number.MAX_VALUE),w=F(-Number.MAX_VALUE);for(let m of this.pts)r.x=Math.min(r.x,m.x),w.x=Math.max(w.x,m.x),r.y=Math.min(r.y,m.y),w.y=Math.max(w.y,m.y);return Re.fromPoints(r,w)}},"oe");p(ot,"Polygon");function Un(r,w){let m=Number.MAX_VALUE,g=F(0);for(let O of[r,w])for(let U=0;U<O.pts.length;U++){let Z=O.pts[U],X=O.pts[(U+1)%O.pts.length].sub(Z).normal().unit(),Q=Number.MAX_VALUE,G=-Number.MAX_VALUE;for(let Te=0;Te<r.pts.length;Te++){let me=r.pts[Te].dot(X);Q=Math.min(Q,me),G=Math.max(G,me)}let ce=Number.MAX_VALUE,Y=-Number.MAX_VALUE;for(let Te=0;Te<w.pts.length;Te++){let me=w.pts[Te].dot(X);ce=Math.min(ce,me),Y=Math.max(Y,me)}let D=Math.min(G,Y)-Math.max(Q,ce);if(D<0)return null;if(D<Math.abs(m)){let Te=Y-Q,me=ce-G;m=Math.abs(Te)<Math.abs(me)?Te:me,g=X.scale(m)}}return g}s(Un,"Yi"),h(Un,"Wn"),p(Un,"sat");var Le={linear:r=>r,easeInSine:r=>1-Math.cos(r*Math.PI/2),easeOutSine:r=>Math.sin(r*Math.PI/2),easeInOutSine:r=>-(Math.cos(Math.PI*r)-1)/2,easeInQuad:r=>r*r,easeOutQuad:r=>1-(1-r)*(1-r),easeInOutQuad:r=>r<.5?2*r*r:1-Math.pow(-2*r+2,2)/2,easeInCubic:r=>r*r*r,easeOutCubic:r=>1-Math.pow(1-r,3),easeInOutCubic:r=>r<.5?4*r*r*r:1-Math.pow(-2*r+2,3)/2,easeInQuart:r=>r*r*r*r,easeOutQuart:r=>1-Math.pow(1-r,4),easeInOutQuart:r=>r<.5?8*r*r*r*r:1-Math.pow(-2*r+2,4)/2,easeInQuint:r=>r*r*r*r*r,easeOutQuint:r=>1-Math.pow(1-r,5),easeInOutQuint:r=>r<.5?16*r*r*r*r*r:1-Math.pow(-2*r+2,5)/2,easeInExpo:r=>r===0?0:Math.pow(2,10*r-10),easeOutExpo:r=>r===1?1:1-Math.pow(2,-10*r),easeInOutExpo:r=>r===0?0:r===1?1:r<.5?Math.pow(2,20*r-10)/2:(2-Math.pow(2,-20*r+10))/2,easeInCirc:r=>1-Math.sqrt(1-Math.pow(r,2)),easeOutCirc:r=>Math.sqrt(1-Math.pow(r-1,2)),easeInOutCirc:r=>r<.5?(1-Math.sqrt(1-Math.pow(2*r,2)))/2:(Math.sqrt(1-Math.pow(-2*r+2,2))+1)/2,easeInBack:r=>2.70158*r*r*r-1.70158*r*r,easeOutBack:r=>1+2.70158*Math.pow(r-1,3)+1.70158*Math.pow(r-1,2),easeInOutBack:r=>{let w=2.5949095;return r<.5?Math.pow(2*r,2)*((w+1)*2*r-w)/2:(Math.pow(2*r-2,2)*((w+1)*(r*2-2)+w)+2)/2},easeInBounce:r=>1-Le.easeOutBounce(1-r),easeOutBounce:r=>r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375,easeInOutBounce:r=>r<.5?(1-Le.easeOutBounce(1-2*r))/2:(1+Le.easeOutBounce(2*r-1))/2},Ie=h(class extends Map{lastID;constructor(...r){super(...r),this.lastID=0}push(r){let w=this.lastID;return this.set(w,r),this.lastID++,w}pushd(r){let w=this.push(r);return()=>this.delete(w)}},"ce");p(Ie,"IDList");var Xe=h(class{handlers=new Ie;add(r){return this.handlers.pushd(r)}addOnce(r){let w=this.add((...m)=>{r(...m),w()});return w}trigger(...r){this.handlers.forEach(w=>w(...r))}numListeners(){return this.handlers.size}},"ne");p(Xe,"Event");var ar=h(class{handlers=new Map;on(r,w){return this.handlers.get(r)||this.handlers.set(r,new Xe),this.handlers.get(r).add(w)}onOnce(r,w){let m=this.on(r,(...g)=>{w(...g),m()});return m}trigger(r,...w){this.handlers.get(r)&&this.handlers.get(r).trigger(...w)}remove(r){this.handlers.delete(r)}clear(){this.handlers=new Map}numListeners(r){return this.handlers.get(r)?.numListeners()??0}},"le");p(ar,"EventHandler");function vr(r,w){let m=typeof r,g=typeof w;if(m!==g)return!1;if(m==="object"&&g==="object"){let O=Object.keys(r),U=Object.keys(w);if(O.length!==U.length)return!1;for(let Z of O){let X=r[Z],Q=w[Z];if(!(typeof X=="function"&&typeof Q=="function")&&!vr(X,Q))return!1}return!0}return r===w}s(vr,"Dr"),h(vr,"It"),p(vr,"deepEq");function Yt(r){let w=window.atob(r),m=w.length,g=new Uint8Array(m);for(let O=0;O<m;O++)g[O]=w.charCodeAt(O);return g.buffer}s(Yt,"ji"),h(Yt,"ps"),p(Yt,"base64ToArrayBuffer");function ze(r){return Yt(r.split(",")[1])}s(ze,"Qi"),h(ze,"er"),p(ze,"dataURLToArrayBuffer");function vt(r,w){let m=document.createElement("a");m.href=w,m.download=r,m.click()}s(vt,"Ue"),h(vt,"ft"),p(vt,"download");function Er(r,w){vt(r,"data:text/plain;charset=utf-8,"+w)}s(Er,"Or"),h(Er,"Nt"),p(Er,"downloadText");function Gr(r,w){Er(r,JSON.stringify(w))}s(Gr,"Hi"),h(Gr,"tr"),p(Gr,"downloadJSON");function gt(r,w){let m=URL.createObjectURL(w);vt(r,m),URL.revokeObjectURL(m)}s(gt,"Mr"),h(gt,"jt"),p(gt,"downloadBlob");function xr(r){return r.match(/^data:\w+\/\w+;base64,.+/)}s(xr,"Fr"),h(xr,"kt"),p(xr,"isDataURL");var Gt=(()=>{let r=0;return()=>r++})(),Ei=h(class{dts=[];timer=0;fps=0;tick(r){this.dts.push(r),this.timer+=r,this.timer>=1&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((w,m)=>w+m)/this.dts.length)),this.dts=[])}},"$e");p(Ei,"FPSCounter");var br=h(class{time;action;finished=!1;paused=!1;constructor(r,w){this.time=r,this.action=w}tick(r){return this.finished||this.paused?!1:(this.time-=r,this.time<=0?(this.action(),this.finished=!0,this.time=0,!0):!1)}reset(r){this.time=r,this.finished=!1}},"he");p(br,"Timer");var Pn="data:image/png;base64,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",on="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA1CAYAAADyMeOEAAAAAXNSR0IArs4c6QAAAoVJREFUaIHdm7txwkAQhheGAqACiCHzOKQDQrqgILpwSAeEDBnEUAF0gCMxZ7G72qce/mec2Lpf9+3unaS78wgSNZ8uX5729+d1FNWXUuGmXlBOUUEIMckEpeQJgBu6C+BSFngztBR2vd+ovY+7g+p6LbgaWgJrAeUkDYIUXgXdBBwNi6kpABJwMTQH3AZsXRR8GHTfgEth8E3gjdAUcNewpbTgY85sCMCUuOokozE0YM0YRzM9NGAAXd8+omAF5h4lnmBRvpSnZHyLoLEbaN+aKB9KWv/KWw0tAbbANnlG+UvB2dm77NxxdwgBpjrF/d7rW9cbmpvio2A5z8iAYpVU8pGZlo6/2+MSco2lHfd3rv9jAP038e1xef9o2mjvYb2OqpqKE81028/jeietlSEVO5FRWsxWsJit1G3aFpW8iWe5RwpiCZAk25QvV6nz6fIlynRGuTd5WqpJ4guAlDfVKBK87hXljflgv1ON6fV+4+5gVlA17SfeG0heKqQd4l4jI/wrmaA9N9R4ar+wpHJDZyrrfcH0nB66PqAzPi76pn+faSyJk/vzOorYhGurQrzj/P68jtBMawHaHBIR9xoD5O34dy0qQOSYHvqExq2TpT2nf76+w7y251OYF0CRaU+J920TwLUa6inx6OxE6g80lu2ux7Y2eJLF/rCXE6zEPdnenk9o+4ih9AEdnW2q81HXl5LuU6OTl2fXUhqganbXAGq3g6jJOWV/OnoesO6YqqEB/GdNsjf7uHtwj2DzmRNpp7iOZfm6D9oAxB6Yi1gC4oIYeo4MIPdopEQRB+cAko5J1tW386HpB2Kz1eop4Epdwls/kgZ1sh8gZsEjdcWkr//D8Qu3Z3l5Nl1NtAAAAABJRU5ErkJggg==",Et={};q(Et,{default:()=>xi});var xi=Se("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L5QNSqT5iiySS9Ja2SV//5ME0ak//+4KgAAABgQBAADAMDgYCAEgCteQ0fZH6+ICXA357+MPfhR/+ywRf/U///LVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+5JknQAFoWhGLm5gBClBmT3GiAAAAAGkHAAAIAAANIOAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"),$n="data:image/png;base64,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",kn="data:image/png;base64,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",Cn="3000.0.0-alpha.4",Ut={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"},Sr=["left","middle","right","back","forward"],Qt=["space","left","right","up","down","tab","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","s"],sn=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",Ue=0,ve=3,st=0,bi=3,Qr=-1200,jr=1200,Zr="topleft",Xr=64,at="happy",Rr="monospace",ur=36,Hr=64,Pt=1024,Si=.1,Wr=1,Ri=[{name:"a_pos",size:3},{name:"a_uv",size:2},{name:"a_color",size:4}],Tr=Ri.reduce((r,w)=>r+w.size,0),_r=2048,Ti=_r*4*Tr,Mi=_r*6,an=`
attribute vec3 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,In=`
precision mediump float;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	return v_color * texture2D(u_tex, v_uv);
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,Mr=`
vec4 vert(vec3 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,Fi=`
vec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`,un=new Set(["id","require"]),Nn=new Set(["add","update","draw","destroy","inspect","drawInspect"]);function jt(r){return r==="pressed"||r==="rpressed"?"down":r==="released"?"up":r}s(jt,"Me"),h(jt,"Ht"),p(jt,"processButtonState");function $r(r){r.requestFullscreen?r.requestFullscreen():r.webkitRequestFullscreen&&r.webkitRequestFullscreen()}s($r,"$i"),h($r,"Bs"),p($r,"enterFullscreen");function Ee(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}s(Ee,"to"),h(Ee,"Vs"),p(Ee,"exitFullscreen");function Ye(){return document.fullscreenElement||document.webkitFullscreenElement}s(Ye,"eo"),h(Ye,"Gs"),p(Ye,"getFullscreenElement");function Zt(r){switch(r){case"topleft":return F(-1,-1);case"top":return F(0,-1);case"topright":return F(1,-1);case"left":return F(-1,0);case"center":return F(0,0);case"right":return F(1,0);case"botleft":return F(-1,1);case"bot":return F(0,1);case"botright":return F(1,1);default:return r}}s(Zt,"Gt"),h(Zt,"tt"),p(Zt,"anchorPt");function Bi(r){switch(r){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}s(Bi,"ro"),h(Bi,"Is"),p(Bi,"alignPt");function Fr(){return new AudioBuffer({length:1,numberOfChannels:1,sampleRate:44100})}s(Fr,"Fe"),h(Fr,"$t"),p(Fr,"createEmptyAudioBuffer");var Dn=p((r={})=>{let w=[],m=(()=>{let t=r.root??document.body;t===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");let o=r.canvas??(()=>{let z=document.createElement("canvas");return t.appendChild(z),z})(),u=r.scale??1,d=!(r.width&&r.height&&!r.stretch&&!r.letterbox),R=o.parentElement.offsetWidth,f=o.parentElement.offsetHeight;d?(o.width=R,o.height=f):(o.width=r.width*u,o.height=r.height*u);let S=o.width,M=o.height,N=r.pixelDensity||window.devicePixelRatio;o.width*=N,o.height*=N;let I=[`width: ${S}px`,`height: ${M}px`,"outline: none","cursor: default"];return r.crisp&&(I.push("image-rendering: pixelated"),I.push("image-rendering: crisp-edges")),o.style.cssText=I.join(";"),o.tabIndex=0,{canvas:o,canvas2:o.cloneNode(),pixelDensity:N,stretchToParent:d,lastParentWidth:R,lastParentHeight:f,keyStates:{},mouseStates:{},virtualButtonStates:{},charInputted:[],numKeyDown:0,isMouseMoved:!1,isKeyPressed:!1,isKeyPressedRepeat:!1,isKeyReleased:!1,mouseStarted:!1,mousePos:F(0,0),mouseDeltaPos:F(0,0),time:0,realTime:0,skipTime:!1,dt:0,numFrames:0,isTouchScreen:"ontouchstart"in window||navigator.maxTouchPoints>0,loopID:null,stopped:!1,paused:!1,fpsCounter:new Ei}})(),g=m.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});class O{glTex;width;height;constructor(o,u,d={}){this.glTex=g.createTexture(),w.push(()=>this.free()),this.bind(),o&&u&&g.texImage2D(g.TEXTURE_2D,0,g.RGBA,o,u,0,g.RGBA,g.UNSIGNED_BYTE,null),this.width=o,this.height=u;let R=(()=>{switch(d.filter??r.texFilter){case"linear":return g.LINEAR;case"nearest":return g.NEAREST;default:return g.NEAREST}})(),f=(()=>{switch(d.wrap){case"repeat":return g.REPEAT;case"clampToEdge":return g.CLAMP_TO_EDGE;default:return g.CLAMP_TO_EDGE}})();g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,R),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,R),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,f),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,f),this.unbind()}static fromImage(o,u={}){let d=new O(0,0,u);return d.bind(),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,o),d.width=o.width,d.height=o.height,d.unbind(),d}update(o,u,d){this.bind(),g.texSubImage2D(g.TEXTURE_2D,0,o,u,g.RGBA,g.UNSIGNED_BYTE,d),this.unbind()}bind(){g.bindTexture(g.TEXTURE_2D,this.glTex)}unbind(){g.bindTexture(g.TEXTURE_2D,null)}free(){g.deleteTexture(this.glTex)}}s(O,"V"),h(O,"b"),p(O,"Texture");let U=(()=>{let t=Ur(Mr,Fi),o=O.fromImage(new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1));if(r.background){let f=oe.fromArray(r.background);g.clearColor(f.r/255,f.g/255,f.b/255,r.background[3]??1)}g.enable(g.BLEND),g.enable(g.SCISSOR_TEST),g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA);let u=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,u),g.bufferData(g.ARRAY_BUFFER,Ti*4,g.DYNAMIC_DRAW),Ri.reduce((f,S,M)=>(g.vertexAttribPointer(M,S.size,g.FLOAT,!1,Tr*4,f),g.enableVertexAttribArray(M),f+S.size*4),0),g.bindBuffer(g.ARRAY_BUFFER,null);let d=g.createBuffer();g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,d),g.bufferData(g.ELEMENT_ARRAY_BUFFER,Mi*4,g.DYNAMIC_DRAW),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,null);let R=O.fromImage(new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"});return{drawCalls:0,lastDrawCalls:0,defShader:t,curShader:t,defTex:o,curTex:o,curUniform:{},vbuf:u,ibuf:d,vqueue:[],iqueue:[],transform:new pe,transformStack:[],bgTex:R,width:r.width,height:r.height,viewport:{x:0,y:0,width:g.drawingBufferWidth,height:g.drawingBufferHeight}}})();class Z{tex;frames=[new Ke(0,0,1,1)];anims={};constructor(o,u,d={}){this.tex=o,u&&(this.frames=u),this.anims=d}static from(o,u={}){return typeof o=="string"?Z.fromURL(o,u):Promise.resolve(Z.fromImage(o,u))}static fromImage(o,u={}){return new Z(O.fromImage(o,u),Ht(u.sliceX||1,u.sliceY||1),u.anims??{})}static fromURL(o,u={}){return $e(o).then(d=>Z.fromImage(d,u))}}s(Z,"b"),h(Z,"C"),p(Z,"SpriteData");class X{buf;constructor(o){this.buf=o}static fromArrayBuffer(o){return new Promise((u,d)=>Q.ctx.decodeAudioData(o,u,d)).then(u=>new X(u))}static fromURL(o){return xr(o)?X.fromArrayBuffer(ze(o)):ae(o).then(u=>X.fromArrayBuffer(u))}}s(X,"S"),h(X,"R"),p(X,"SoundData");let Q=(()=>{let t=new(window.AudioContext||window.webkitAudioContext),o=t.createGain();o.connect(t.destination);let u=new X(Fr());return t.decodeAudioData(xi.buffer.slice(0)).then(d=>{u.buf=d}).catch(d=>{console.error("Failed to load burp: ",d)}),{ctx:t,masterNode:o,burpSnd:u}})();class G{done=!1;data=null;error=null;onLoadEvents=new Xe;onErrorEvents=new Xe;onFinishEvents=new Xe;constructor(o){o.then(u=>{this.data=u,this.onLoadEvents.trigger(u)}).catch(u=>{if(this.error=u,this.onErrorEvents.numListeners()>0)this.onErrorEvents.trigger(u);else throw u}).finally(()=>{this.onFinishEvents.trigger(),this.done=!0})}static loaded(o){let u=new G(Promise.resolve(o));return u.data=o,u.done=!0,u}onLoad(o){return this.onLoadEvents.add(o),this}onError(o){return this.onErrorEvents.add(o),this}onFinish(o){return this.onFinishEvents.add(o),this}then(o){return this.onLoad(o)}catch(o){return this.onError(o)}finally(o){return this.onFinish(o)}}s(G,"M"),h(G,"O"),p(G,"Asset");class ce{assets=new Map;lastUID=0;add(o,u){let d=o??this.lastUID+++"",R=new G(u);return this.assets.set(d,R),R}addLoaded(o,u){let d=o??this.lastUID+++"",R=G.loaded(u);this.assets.set(d,R)}get(o){return this.assets.get(o)}progress(){if(this.assets.size===0)return 1;let o=0;return this.assets.forEach(u=>{u.done&&o++}),o/this.assets.size}}s(ce,"C"),h(ce,"M"),p(ce,"AssetBucket");let Y={urlPrefix:"",sprites:new ce,fonts:new ce,bitmapFonts:new ce,sounds:new ce,shaders:new ce,custom:new ce,loaded:!1},D={ev:new ar,objEvents:new ar,root:An([]),timers:new Ie,gravity:0,scenes:{},logs:[],cam:{pos:null,scale:F(1),angle:0,shake:0,transform:new pe}};function Te(t){return Y.custom.add(null,t)}s(Te,"z"),h(Te,"de"),p(Te,"load");function me(){let t=[Y.sprites,Y.sounds,Y.shaders,Y.fonts,Y.bitmapFonts,Y.custom];return t.reduce((o,u)=>o+u.progress(),0)/t.length}s(me,"q"),h(me,"V"),p(me,"loadProgress");function xt(t){return t!==void 0&&(Y.urlPrefix=t),Y.urlPrefix}s(xt,"xt"),h(xt,"Y"),p(xt,"loadRoot");function lt(t){let o=Y.urlPrefix+t;return fetch(o).then(u=>{if(!u.ok)throw new Error(`Failed to fetch ${o}`);return u})}s(lt,"dt"),h(lt,"Se"),p(lt,"fetchURL");function dt(t){return lt(t).then(o=>o.json())}s(dt,"ct"),h(dt,"Ce"),p(dt,"fetchJSON");function J(t){return lt(t).then(o=>o.text())}s(J,"y"),h(J,"nt"),p(J,"fetchText");function ae(t){return lt(t).then(o=>o.arrayBuffer())}s(ae,"B"),h(ae,"rt"),p(ae,"fetchArrayBuffer");function $e(t){let o=new Image;return o.crossOrigin="anonymous",o.src=xr(t)?t:Y.urlPrefix+t,new Promise((u,d)=>{o.onload=()=>u(o),o.onerror=()=>d(new Error(`Failed to load image from "${t}"`))})}s($e,"rt"),h($e,"Te"),p($e,"loadImg");function ct(t,o){let u=new FontFace(t,typeof o=="string"?`url(${o})`:o);return document.fonts.add(u),Y.fonts.add(t,u.load().catch(()=>{throw new Error(`Failed to load font from "${o}"`)}))}s(ct,"at"),h(ct,"bt"),p(ct,"loadFont");function ft(t,o,u,d,R={}){return Y.bitmapFonts.add(t,$e(o).then(f=>Oi(O.fromImage(f,R),u,d,R.chars??sn)))}s(ft,"ut"),h(ft,"Ae"),p(ft,"loadBitmapFont");function Ht(t=1,o=1,u=0,d=0,R=1,f=1){let S=[],M=R/t,N=f/o;for(let I=0;I<o;I++)for(let z=0;z<t;z++)S.push(new Ke(u+z*M,d+I*N,M,N));return S}s(Ht,"Zt"),h(Ht,"Oe"),p(Ht,"slice");function Br(t,o){return Te(typeof o=="string"?new Promise((u,d)=>{dt(o).then(R=>{Br(t,R).onLoad(u).onError(d)})}):Z.from(t).then(u=>{let d={};for(let R in o){let f=u.tex.width,S=u.tex.height,M=o[R],N=new Z(u.tex,Ht(M.sliceX,M.sliceY,M.x/f,M.y/S,M.width/f,M.height/S),M.anims);Y.sprites.addLoaded(R,N),d[R]=N}return d}))}s(Br,"Pe"),h(Br,"Yt"),p(Br,"loadSpriteAtlas");function Ct(t,o,u={sliceX:1,sliceY:1,anims:{}}){return Y.sprites.add(t,typeof o=="string"?Z.fromURL(o,u):Promise.resolve(Z.fromImage(o,u)))}s(Ct,"Et"),h(Ct,"Pe"),p(Ct,"loadSprite");function hr(t,o){return Y.sprites.add(t,new Promise(async u=>{let d=typeof o=="string"?await dt(o):o,R=await Promise.all(d.frames.map($e)),f=document.createElement("canvas");f.width=d.width,f.height=d.height*d.frames.length;let S=f.getContext("2d");R.forEach((N,I)=>{S.drawImage(N,0,I*d.height)});let M=await Ct(null,f,{sliceY:d.frames.length,anims:d.anims});u(M)}))}s(hr,"Kr"),h(hr,"vr"),p(hr,"loadPedit");function lr(t,o,u){return Y.sprites.add(t,new Promise(async d=>{let R=await Ct(null,o),f=typeof u=="string"?await dt(u):u,S=f.meta.size;R.frames=f.frames.map(M=>new Ke(M.frame.x/S.w,M.frame.y/S.h,M.frame.w/S.w,M.frame.h/S.h));for(let M of f.meta.frameTags)M.from===M.to?R.anims[M.name]=M.from:R.anims[M.name]={from:M.from,to:M.to,speed:10,loop:!0,pingpong:M.direction==="pingpong"};d(R)}))}s(lr,"kr"),h(lr,"yr"),p(lr,"loadAseprite");function Ci(t,o,u,d=!1){return Y.shaders.add(t,new Promise((R,f)=>{let S=p(M=>M?J(M):new Promise(N=>N(null)),"resolveUrl");if(d)Promise.all([S(o),S(u)]).then(([M,N])=>{R(Ur(M,N))}).catch(f);else try{R(Ur(o,u))}catch(M){f(M)}}))}s(Ci,"Lr"),h(Ci,"Ur"),p(Ci,"loadShader");function Ii(t,o){return Y.sounds.add(t,typeof o=="string"?X.fromURL(o):X.fromArrayBuffer(o))}s(Ii,"Jr"),h(Ii,"xr"),p(Ii,"loadSound");function It(t="bean"){return Ct(t,on)}s(It,"zr"),h(It,"Er"),p(It,"loadBean");function ri(t){return Y.sprites.get(t)}s(ri,"Ce"),h(ri,"Xt"),p(ri,"getSprite");function dr(t){return Y.sounds.get(t)}s(dr,"Ie"),h(dr,"Kt"),p(dr,"getSound");function Ni(t){return Y.fonts.get(t)}s(Ni,"Gr"),h(Ni,"Sr"),p(Ni,"getFont");function ii(t){return Y.bitmapFonts.get(t)}s(ii,"Ne"),h(ii,"Qt"),p(ii,"getBitmapFont");function ni(t){return Y.shaders.get(t)}s(ni,"De"),h(ni,"Jt"),p(ni,"getShader");function oi(t){if(typeof t=="string"){let o=ri(t);if(o)return o;if(me()<1)return null;throw new Error(`Sprite not found: ${t}`)}else{if(t instanceof Z)return G.loaded(t);if(t instanceof G)return t;throw new Error(`Invalid sprite: ${t}`)}}s(oi,"Oe"),h(oi,"Zt"),p(oi,"resolveSprite");function Di(t){if(typeof t=="string"){let o=dr(t);if(o)return o.data?o.data:o;if(me()<1)return null;throw new Error(`Sound not found: ${t}`)}else{if(t instanceof X)return t;if(t instanceof G)return t.data?t.data:t;throw new Error(`Invalid sound: ${t}`)}}s(Di,"Yr"),h(Di,"Cr"),p(Di,"resolveSound");function Wt(t){if(!t)return U.defShader;if(typeof t=="string"){let o=ni(t);if(o)return o.data?o.data:o;if(me()<1)return null;throw new Error(`Shader not found: ${t}`)}else if(t instanceof G)return t.data?t.data:t;return t}s(Wt,"jr"),h(Wt,"Tr"),p(Wt,"resolveShader");function cr(t){if(!t)return cr(r.font??at);if(typeof t=="string"){let o=ii(t);if(o)return o.data?o.data:o;if(document.fonts.check(`${Hr}px ${t}`))return t;if(me()<1)return null;throw new Error(`Font not found: ${t}`)}else if(t instanceof G)return t.data?t.data:t;return t}s(cr,"qe"),h(cr,"Wt"),p(cr,"resolveFont");function qi(t){return t!==void 0&&(Q.masterNode.gain.value=Be(t,Ue,ve)),Q.masterNode.gain.value}s(qi,"Qr"),h(qi,"Ar"),p(qi,"volume");function _t(t,o={loop:!1,volume:1,speed:1,detune:0,seek:0}){let u=Di(t);if(u instanceof G){let te=_t(new X(Fr())),Ce=p(be=>{let At=_t(be,o);for(let Lt in At)te[Lt]=At[Lt]},"doPlay");return u.onLoad(Ce),te}else if(u===null){let te=_t(new X(Fr()));return zn(()=>{}),te}let d=Q.ctx,R=!1,f=d.createBufferSource();f.buffer=u.buf,f.loop=!!o.loop;let S=d.createGain();f.connect(S),S.connect(Q.masterNode);let M=o.seek??0;f.start(0,M);let N=d.currentTime-M,I=null,z={stop(){R||(this.pause(),N=d.currentTime)},play(te){if(!R)return;let Ce=f;f=d.createBufferSource(),f.buffer=Ce.buffer,f.loop=Ce.loop,f.playbackRate.value=Ce.playbackRate.value,f.detune&&(f.detune.value=Ce.detune.value),f.connect(S);let be=te??this.time();f.start(0,be),N=d.currentTime-be,R=!1,I=null},pause(){R||(f.stop(),R=!0,I=d.currentTime)},isPaused(){return R},isStopped(){return R},speed(te){return te!==void 0&&(f.playbackRate.value=Be(te,st,bi)),f.playbackRate.value},detune(te){return f.detune?(te!==void 0&&(f.detune.value=Be(te,Qr,jr)),f.detune.value):0},volume(te){return te!==void 0&&(S.gain.value=Be(te,Ue,ve)),S.gain.value},loop(){f.loop=!0},unloop(){f.loop=!1},duration(){return u.buf.duration},time(){return R?I-N:d.currentTime-N}};return z.speed(o.speed),z.detune(o.detune),z.volume(o.volume),z}s(_t,"It"),h(_t,"Ye"),p(_t,"play");function si(t){return _t(Q.burpSnd,t)}s(si,"Ke"),h(si,"en"),p(si,"burp");function Ur(t=Mr,o=Fi){let u=an.replace("{{user}}",t??Mr),d=In.replace("{{user}}",o??Fi),R=g.createShader(g.VERTEX_SHADER),f=g.createShader(g.FRAGMENT_SHADER);g.shaderSource(R,u),g.shaderSource(f,d),g.compileShader(R),g.compileShader(f);let S=g.createProgram();if(w.push(()=>g.deleteProgram(S)),g.attachShader(S,R),g.attachShader(S,f),g.bindAttribLocation(S,0,"a_pos"),g.bindAttribLocation(S,1,"a_uv"),g.bindAttribLocation(S,2,"a_color"),g.linkProgram(S),!g.getProgramParameter(S,g.LINK_STATUS)){let M=p(te=>{let Ce=/^ERROR:\s0:(?<line>\d+):\s(?<msg>.+)/,be=te.match(Ce);return{line:Number(be.groups.line),msg:be.groups.msg.replace(/\n\0$/,"")}},"formatShaderError"),N=g.getShaderInfoLog(R),I=g.getShaderInfoLog(f),z="";if(N){let te=M(N);z+=`Vertex shader line ${te.line-14}: ${te.msg}`}if(I){let te=M(I);z+=`Fragment shader line ${te.line-14}: ${te.msg}`}throw new Error(z)}return g.deleteShader(R),g.deleteShader(f),{bind(){g.useProgram(S)},unbind(){g.useProgram(null)},free(){g.deleteProgram(S)},send(M){for(let N in M){let I=M[N],z=g.getUniformLocation(S,N);typeof I=="number"?g.uniform1f(z,I):I instanceof pe?g.uniformMatrix4fv(z,!1,new Float32Array(I.m)):I instanceof oe?g.uniform3f(z,I.r,I.g,I.b):I instanceof Kr?g.uniform3f(z,I.x,I.y,I.z):I instanceof ue&&g.uniform2f(z,I.x,I.y)}}}}s(Ur,"de"),h(Ur,"vt"),p(Ur,"makeShader");function Oi(t,o,u,d){let R=t.width/o,f={},S=d.split("").entries();for(let[M,N]of S)f[N]=new Ke(M%R*o,Math.floor(M/R)*u,o,u);return{tex:t,map:f,size:u}}s(Oi,"Hr"),h(Oi,"Or"),p(Oi,"makeFont");function fr(t,o,u,d=U.defTex,R=U.defShader,f={}){let S=Wt(R);if(!(!S||S instanceof G)){(d!==U.curTex||S!==U.curShader||!vr(U.curUniform,f)||U.vqueue.length+t.length*Tr>Ti||U.iqueue.length+o.length>Mi)&&Nt();for(let M of t){let N=u?U.transform:D.cam.transform.mult(U.transform),I=Li(N.multVec2(M.pos.xy()));U.vqueue.push(I.x,I.y,M.pos.z,M.uv.x,M.uv.y,M.color.r/255,M.color.g/255,M.color.b/255,M.opacity)}for(let M of o)U.iqueue.push(M+U.vqueue.length/Tr-t.length);U.curTex=d,U.curShader=S,U.curUniform=f}}s(fr,"ce"),h(fr,"yt"),p(fr,"drawRaw");function Nt(){!U.curTex||!U.curShader||U.vqueue.length===0||U.iqueue.length===0||(g.bindBuffer(g.ARRAY_BUFFER,U.vbuf),g.bufferSubData(g.ARRAY_BUFFER,0,new Float32Array(U.vqueue)),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,U.ibuf),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(U.iqueue)),U.curShader.bind(),U.curShader.send(U.curUniform),U.curTex.bind(),g.drawElements(g.TRIANGLES,U.iqueue.length,g.UNSIGNED_SHORT,0),U.curTex.unbind(),U.curShader.unbind(),g.bindBuffer(g.ARRAY_BUFFER,null),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,null),U.vqueue=[],U.iqueue=[],U.drawCalls++)}s(Nt,"ft"),h(Nt,"fe"),p(Nt,"flush");function On(){Qi(),g.clear(g.COLOR_BUFFER_BIT),r.background||Tt(()=>{Dt({width:Me(),height:ge(),quad:new Ke(0,0,Me()/Xr,ge()/Xr),tex:U.bgTex,fixed:!0})}),U.drawCalls=0,U.transformStack=[],U.transform=new pe}s(On,"Xr"),h(On,"Pr"),p(On,"frameStart");function Ki(){Nt(),U.lastDrawCalls=U.drawCalls}s(Ki,"Zr"),h(Ki,"Rr"),p(Ki,"frameEnd");function Li(t){return F(t.x/Me()*2-1,-t.y/ge()*2+1)}s(Li,"Wr"),h(Li,"Dr"),p(Li,"screen2ndc");function Ji(t){U.transform=t.clone()}s(Ji,"_r"),h(Ji,"Mr"),p(Ji,"pushMatrix");function xe(...t){if(t[0]===void 0)return;let o=F(...t);o.x===0&&o.y===0||(U.transform=U.transform.translate(o))}s(xe,"K"),h(xe,"G"),p(xe,"pushTranslate");function bt(...t){if(t[0]===void 0)return;let o=F(...t);o.x===1&&o.y===1||(U.transform=U.transform.scale(o))}s(bt,"bt"),h(bt,"Re"),p(bt,"pushScale");function zi(t){!t||(U.transform=U.transform.rotateX(t))}s(zi,"$r"),h(zi,"Fr"),p(zi,"pushRotateX");function Yi(t){!t||(U.transform=U.transform.rotateY(t))}s(Yi,"tn"),h(Yi,"Lr"),p(Yi,"pushRotateY");function St(t){!t||(U.transform=U.transform.rotateZ(t))}s(St,"mt"),h(St,"we"),p(St,"pushRotateZ");let Gi=St;function He(){U.transformStack.push(U.transform.clone())}s(He,"tt"),h(He,"W"),p(He,"pushTransform");function Ge(){U.transformStack.length>0&&(U.transform=U.transformStack.pop())}s(Ge,"X"),h(Ge,"X"),p(Ge,"popTransform");function Dt(t){if(t.width===void 0||t.height===void 0)throw new Error('drawUVQuad() requires property "width" and "height".');if(t.width<=0||t.height<=0)return;let o=t.width,u=t.height,d=Zt(t.anchor||Zr).scale(F(o,u).scale(-.5)),R=t.quad||new Ke(0,0,1,1),f=t.color||$(255,255,255),S=t.opacity??1,M=t.tex?Si/t.tex.width:0,N=t.tex?Si/t.tex.height:0,I=R.x+M,z=R.y+N,te=R.w-M*2,Ce=R.h-N*2;He(),xe(t.pos),St(t.angle),bt(t.scale),xe(d),fr([{pos:nt(-o/2,u/2,0),uv:F(t.flipX?I+te:I,t.flipY?z:z+Ce),color:f,opacity:S},{pos:nt(-o/2,-u/2,0),uv:F(t.flipX?I+te:I,t.flipY?z+Ce:z),color:f,opacity:S},{pos:nt(o/2,-u/2,0),uv:F(t.flipX?I:I+te,t.flipY?z+Ce:z),color:f,opacity:S},{pos:nt(o/2,u/2,0),uv:F(t.flipX?I:I+te,t.flipY?z:z+Ce),color:f,opacity:S}],[0,1,3,1,2,3],t.fixed,t.tex,t.shader,t.uniform),Ge()}s(Dt,"St"),h(Dt,"De"),p(Dt,"drawUVQuad");function ai(t){if(!t.tex)throw new Error('drawTexture() requires property "tex".');let o=t.quad??new Ke(0,0,1,1),u=t.tex.width*o.w,d=t.tex.height*o.h,R=F(1);if(t.tiled){let f=Math.ceil((t.width||u)/u),S=Math.ceil((t.height||d)/d),M=Zt(t.anchor||Zr).add(F(1,1)).scale(.5).scale(f*u,S*d);for(let N=0;N<f;N++)for(let I=0;I<S;I++)Dt({...t,pos:(t.pos||F(0)).add(F(u*N,d*I)).sub(M),scale:R.scale(t.scale||F(1)),tex:t.tex,quad:o,width:u,height:d,anchor:"topleft"})}else t.width&&t.height?(R.x=t.width/u,R.y=t.height/d):t.width?(R.x=t.width/u,R.y=R.x):t.height&&(R.y=t.height/d,R.x=R.y),Dt({...t,scale:R.scale(t.scale||F(1)),tex:t.tex,quad:o,width:u,height:d})}s(ai,"en"),h(ai,"Vr"),p(ai,"drawTexture");function Pr(t){if(!t.sprite)throw new Error('drawSprite() requires property "sprite"');let o=oi(t.sprite);if(!o||!o.data)return;let u=o.data.frames[t.frame??0];if(!u)throw new Error(`Frame not found: ${t.frame??0}`);ai({...t,tex:o.data.tex,quad:u.scale(t.quad||new Ke(0,0,1,1))})}s(Pr,"ke"),h(Pr,"tn"),p(Pr,"drawSprite");function wt(t,o,u,d,R,f=1){d=Je(d%360),R=Je(R%360),R<=d&&(R+=Math.PI*2);let S=Math.ceil(Math.max(Math.sqrt(o+u)*3*(f||1),16)),M=(R-d)/S,N=[];for(let I=d;I<R;I+=M)N.push(t.add(o*Math.cos(I),u*Math.sin(I)));return N.push(t.add(o*Math.cos(R),u*Math.sin(R))),N}s(wt,"Nt"),h(wt,"Xe"),p(wt,"getArcPts");function Qe(t){if(t.width===void 0||t.height===void 0)throw new Error('drawRect() requires property "width" and "height".');if(t.width<=0||t.height<=0)return;let o=t.width,u=t.height,d=Zt(t.anchor||Zr).add(1,1).scale(F(o,u).scale(-.5)),R=[F(0,0),F(o,0),F(o,u),F(0,u)];if(t.radius){let f=Math.min(Math.min(o,u)/2,t.radius);R=[F(f,0),F(o-f,0),...wt(F(o-f,f),f,f,270,360),F(o,f),F(o,u-f),...wt(F(o-f,u-f),f,f,0,90),F(o-f,u),F(f,u),...wt(F(f,u-f),f,f,90,180),F(0,u-f),F(0,f),...wt(F(f,f),f,f,180,270)]}er({...t,offset:d,pts:R,...t.gradient?{colors:t.horizontal?[t.gradient[0],t.gradient[1],t.gradient[1],t.gradient[0]]:[t.gradient[0],t.gradient[0],t.gradient[1],t.gradient[1]]}:{}})}s(Qe,"Z"),h(Qe,"K"),p(Qe,"drawRect");function $t(t){let{p1:o,p2:u}=t;if(!o||!u)throw new Error('drawLine() requires properties "p1" and "p2".');let d=t.width||1,R=u.sub(o).unit().normal().scale(d*.5),f=[o.sub(R),o.add(R),u.add(R),u.sub(R)].map(S=>({pos:nt(S.x,S.y,0),uv:F(0),color:t.color??oe.WHITE,opacity:t.opacity??1}));fr(f,[0,1,3,1,2,3],t.fixed,U.defTex,t.shader,t.uniform)}s($t,"Dt"),h($t,"Ke"),p($t,"drawLine");function ui(t){let o=t.pts;if(!o)throw new Error('drawLines() requires property "pts".');if(!(o.length<2))if(t.radius&&o.length>=3){let u=o[0].dist(o[1]);for(let R=1;R<o.length-1;R++)u=Math.min(o[R].dist(o[R+1]),u);let d=Math.min(t.radius,u/2);$t({...t,p1:o[0],p2:o[1]});for(let R=1;R<o.length-2;R++){let f=o[R],S=o[R+1];$t({...t,p1:f,p2:S})}$t({...t,p1:o[o.length-2],p2:o[o.length-1]})}else for(let u=0;u<o.length-1;u++)$t({...t,p1:o[u],p2:o[u+1]}),t.join!=="none"&&Rt({...t,pos:o[u],radius:t.width/2})}s(ui,"Le"),h(ui,"nn"),p(ui,"drawLines");function hi(t){if(!t.p1||!t.p2||!t.p3)throw new Error('drawPolygon() requires properties "p1", "p2" and "p3".');return er({...t,pts:[t.p1,t.p2,t.p3]})}s(hi,"Je"),h(hi,"rn"),p(hi,"drawTriangle");function Rt(t){if(!t.radius)throw new Error('drawCircle() requires property "radius".');t.radius!==0&&qt({...t,radiusX:t.radius,radiusY:t.radius,angle:0})}s(Rt,"gt"),h(Rt,"be"),p(Rt,"drawCircle");function qt(t){if(t.radiusX===void 0||t.radiusY===void 0)throw new Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(t.radiusX===0||t.radiusY===0)return;let o=t.start??0,u=t.end??360,d=wt(F(0),t.radiusX,t.radiusY,o,u,t.resolution);d.unshift(F(0));let R={...t,pts:d,radius:0,...t.gradient?{colors:[t.gradient[0],...Array(d.length-1).fill(t.gradient[1])]}:{}};if(u-o>=360&&t.outline){t.fill!==!1&&er({...R,outline:null}),er({...R,pts:d.slice(1),fill:!1});return}er(R)}s(qt,"ze"),h(qt,"sn"),p(qt,"drawEllipse");function er(t){if(!t.pts)throw new Error('drawPolygon() requires property "pts".');let o=t.pts.length;if(!(o<3)){if(He(),xe(t.pos),bt(t.scale),St(t.angle),xe(t.offset),t.fill!==!1){let u=t.color??oe.WHITE,d=t.pts.map((f,S)=>({pos:nt(f.x,f.y,0),uv:F(0,0),color:t.colors?t.colors[S]??u:u,opacity:t.opacity??1})),R=[...Array(o-2).keys()].map(f=>[0,f+1,f+2]).flat();fr(d,t.indices??R,t.fixed,U.defTex,t.shader,t.uniform)}t.outline&&ui({pts:[...t.pts,t.pts[0]],radius:t.radius,width:t.outline.width,color:t.outline.color,join:t.outline.join,uniform:t.uniform,fixed:t.fixed,opacity:t.opacity}),Ge()}}s(er,"wt"),h(er,"ve"),p(er,"drawPolygon");function ln(t,o,u){Nt(),g.clear(g.STENCIL_BUFFER_BIT),g.enable(g.STENCIL_TEST),g.stencilFunc(g.NEVER,1,255),g.stencilOp(g.REPLACE,g.REPLACE,g.REPLACE),o(),Nt(),g.stencilFunc(u,1,255),g.stencilOp(g.KEEP,g.KEEP,g.KEEP),t(),Nt(),g.disable(g.STENCIL_TEST)}s(ln,"Ge"),h(ln,"on"),p(ln,"drawStenciled");function dn(t,o){ln(t,o,g.EQUAL)}s(dn,"rn"),h(dn,"Gr"),p(dn,"drawMasked");function cn(t,o){ln(t,o,g.NOTEQUAL)}s(cn,"nn"),h(cn,"Ir"),p(cn,"drawSubtracted");function kr(){return(U.viewport.width+U.viewport.height)/(U.width+U.height)}s(kr,"Ye"),h(kr,"an"),p(kr,"getViewportScale");function Tt(t){Nt();let o=U.width,u=U.height;U.width=U.viewport.width,U.height=U.viewport.height,t(),Nt(),U.width=o,U.height=u}s(Tt,"ht"),h(Tt,"ae"),p(Tt,"drawUnscaled");function fn(t,o){o.pos&&(t.pos=t.pos.add(o.pos)),o.scale&&(t.scale=t.scale.scale(F(o.scale))),o.angle&&(t.angle+=o.angle),o.color&&(t.color=t.color.mult(o.color)),o.opacity&&(t.opacity*=o.opacity)}s(fn,"je"),h(fn,"un"),p(fn,"applyCharTransform");let pn=/\[(?<text>[^\]]*)\]\.(?<style>[\w\.]+)+/g;function li(t){let o={},u=t.replace(pn,"$1"),d=0;for(let R of t.matchAll(pn)){let f=R.groups.style.split("."),S=R.index-d;for(let M=S;M<R.index+R.groups.text.length;M++)o[M]={localIdx:M-S,styles:f};d+=3+R.groups.style.length}return{charStyleMap:o,text:u}}s(li,"sn"),h(li,"Nr"),p(li,"compileStyledText");let Kn={};function ut(t){if(t.text===void 0)throw new Error('formatText() requires property "text".');let o=cr(t.font);if(t.text===""||o instanceof G||!o)return{width:0,height:0,chars:[],opt:t};let{charStyleMap:u,text:d}=li(t.text+""),R=d.split("");if(o instanceof FontFace||typeof o=="string"){let Ne=o instanceof FontFace?o.family:o,Ve=Kn[Ne]??{font:{tex:new O(Pt,Pt,{filter:"linear"}),map:{},size:Hr},cursor:F(0)};Kn[Ne]||(Kn[Ne]=Ve),o=Ve.font;for(let tt of R)if(!Ve.font.map[tt]){let or=m.canvas2.getContext("2d");or.font=`${o.size}px ${Ne}`,or.clearRect(0,0,m.canvas2.width,m.canvas2.height),or.textBaseline="top",or.textAlign="left",or.fillStyle="rgb(255, 255, 255)",or.fillText(tt,0,0);let Gn=or.measureText(tt),xn=Math.ceil(Gn.width),bn=or.getImageData(0,0,xn,o.size);if(Ve.cursor.x+xn>Pt&&(Ve.cursor.x=0,Ve.cursor.y+=o.size,Ve.cursor.y>Pt))throw new Error("Font atlas exceeds character limit");o.tex.update(Ve.cursor.x,Ve.cursor.y,bn),o.map[tt]=new Ke(Ve.cursor.x,Ve.cursor.y,xn,o.size),Ve.cursor.x+=xn}}let f=t.size||o.size,S=F(t.scale??1).scale(f/o.size),M=t.lineSpacing??0,N=t.letterSpacing??0,I=0,z=0,te=0,Ce=[],be=[],At=0,Lt=null,Vt=null;for(;At<R.length;){let Ne=R[At];if(Ne===`
`)te+=f+M,Ce.push({width:I-N,chars:be}),Lt=null,Vt=null,I=0,be=[];else{let Ve=o.map[Ne];if(Ve){let tt=Ve.w*S.x;t.width&&I+tt>t.width&&(te+=f+M,Lt!=null&&(At-=be.length-Lt,Ne=R[At],Ve=o.map[Ne],tt=Ve.w*S.x,be=be.slice(0,Lt-1),I=Vt),Lt=null,Vt=null,Ce.push({width:I-N,chars:be}),I=0,be=[]),be.push({tex:o.tex,width:Ve.w,height:Ve.h,quad:new Ke(Ve.x/o.tex.width,Ve.y/o.tex.height,Ve.w/o.tex.width,Ve.h/o.tex.height),ch:Ne,pos:F(I,te),opacity:t.opacity??1,color:t.color??oe.WHITE,scale:F(S),angle:0}),Ne===" "&&(Lt=be.length,Vt=I),I+=tt,z=Math.max(z,I),I+=N}}At++}Ce.push({width:I-N,chars:be}),te+=f,t.width&&(z=t.width);let Xi=[];for(let Ne of Ce){let Ve=(z-Ne.width)*Bi(t.align??"left");for(let tt of Ne.chars){let or=o.map[tt.ch],Gn=Xi.length,xn=new ue(or.w*S.x*.5,or.h*S.y*.5);if(tt.pos=tt.pos.add(Ve,0).add(xn),t.transform){let bn=typeof t.transform=="function"?t.transform(Gn,tt.ch):t.transform;bn&&fn(tt,bn)}if(u[Gn]){let{styles:bn,localIdx:Da}=u[Gn];for(let qa of bn){let Ps=t.styles[qa],aa=typeof Ps=="function"?Ps(Da,tt.ch):Ps;aa&&fn(tt,aa)}}Xi.push(tt)}}return{width:z,height:te,chars:Xi,opt:t}}s(ut,"Vt"),h(ut,"ye"),p(ut,"formatText");function pr(t){Mt(ut(t))}s(pr,"Wt"),h(pr,"it"),p(pr,"drawText");function Mt(t){He(),xe(t.opt.pos),St(t.opt.angle),xe(Zt(t.opt.anchor??"topleft").add(1,1).scale(t.width,t.height).scale(-.5)),t.chars.forEach(o=>{Dt({tex:o.tex,width:o.width,height:o.height,pos:o.pos,scale:o.scale,angle:o.angle,color:o.color,opacity:o.opacity,quad:o.quad,anchor:"center",uniform:t.opt.uniform,shader:t.opt.shader,fixed:t.opt.fixed})}),Ge()}s(Mt,"yt"),h(Mt,"Ue"),p(Mt,"drawFormattedText");function Qi(){if(m.stretchToParent&&!De()){let R=m.canvas.parentElement.offsetWidth,f=m.canvas.parentElement.offsetHeight;if(R!==m.lastParentWidth||f!==m.lastParentHeight){m.canvas.width=R*m.pixelDensity,m.canvas.height=f*m.pixelDensity,m.canvas.style.width=R+"px",m.canvas.style.height=f+"px";let S=Me(),M=ge();D.ev.onOnce("frameEnd",()=>{D.ev.trigger("resize",S,M,Me(),ge())})}m.lastParentWidth=R,m.lastParentHeight=f}let t=m.pixelDensity,o=g.drawingBufferWidth/t,u=g.drawingBufferHeight/t;if(De()){let R=window.innerWidth,f=window.innerHeight,S=R/f,M=o/u;if(S>M){let N=window.innerHeight*M;U.viewport={x:(R-N)/2,y:0,width:N,height:f}}else{let N=window.innerWidth/M;U.viewport={x:0,y:(f-N)/2,width:R,height:N}}return}if(r.letterbox){if(!r.width||!r.height)throw new Error("Letterboxing requires width and height defined.");let R=o/u,f=r.width/r.height;if(R>f){r.stretch||(U.width=u*f,U.height=u);let S=u*f,M=u,N=(o-S)/2;g.scissor(N*t,0,S*t,M*t),g.viewport(N*t,0,S*t,u*t),U.viewport={x:N,y:0,width:S,height:u}}else{r.stretch||(U.width=o,U.height=o/f);let S=o,M=o/f,N=(u-M)/2;g.scissor(0,N*t,S*t,M*t),g.viewport(0,N*t,o*t,M*t),U.viewport={x:0,y:N,width:o,height:M}}return}if(r.stretch){if(!r.width||!r.height)throw new Error("Stretching requires width and height defined.");g.viewport(0,0,o*t,u*t),U.viewport={x:0,y:0,width:o,height:u};return}let d=r.scale??1;U.width=o/d,U.height=u/d,g.viewport(0,0,o*t,u*t),U.viewport={x:0,y:0,width:o,height:u}}s(Qi,"an"),h(Qi,"jr"),p(Qi,"updateViewport");function Me(){return U.width}s(Me,"J"),h(Me,"k"),p(Me,"width");function ge(){return U.height}s(ge,"N"),h(ge,"L"),p(ge,"height");let We={},Cr={},Ar={};function mr(t){return F((t.x-U.viewport.x)*Me()/U.viewport.width,(t.y-U.viewport.y)*ge()/U.viewport.height)}s(mr,"$t"),h(mr,"st"),p(mr,"windowToContent");function Ir(t){return F(t.x*U.viewport.width/U.width,t.y*U.viewport.height/U.height)}s(Ir,"un"),h(Ir,"kr"),p(Ir,"contentToView");function Nr(t,o){let u=mr(F(t,o));m.mouseStarted&&(m.mouseDeltaPos=u.sub(m.mousePos)),m.mousePos=u,m.mouseStarted=!0,m.isMouseMoved=!0}s(Nr,"fe"),h(Nr,"xt"),p(Nr,"setMousePos"),We.mousemove=t=>{Nr(t.offsetX,t.offsetY)},We.mousedown=t=>{let o=Sr[t.button];o&&(m.mouseStates[o]="pressed")},We.mouseup=t=>{let o=Sr[t.button];o&&(m.mouseStates[o]="released")},We.keydown=t=>{let o=Ut[t.key]||t.key.toLowerCase();Qt.includes(o)&&t.preventDefault(),o.length===1&&m.charInputted.push(t.key),o==="space"&&m.charInputted.push(" "),t.repeat?(m.isKeyPressedRepeat=!0,m.keyStates[o]="rpressed"):(m.isKeyPressed=!0,m.keyStates[o]="pressed"),m.numKeyDown++},We.keyup=t=>{let o=Ut[t.key]||t.key.toLowerCase();m.keyStates[o]="released",m.isKeyReleased=!0,m.numKeyDown--},We.touchstart=t=>{t.preventDefault();let o=[...t.changedTouches];o.forEach(u=>{D.ev.trigger("onTouchStart",mr(F(u.clientX,u.clientY)),u)}),r.touchToMouse!==!1&&(Nr(o[0].clientX,o[0].clientY),m.mouseStates.left="pressed")},We.touchmove=t=>{t.preventDefault();let o=[...t.changedTouches];o.forEach(u=>{D.ev.trigger("onTouchMove",mr(F(u.clientX,u.clientY)),u)}),r.touchToMouse!==!1&&Nr(o[0].clientX,o[0].clientY)},We.touchend=t=>{[...t.changedTouches].forEach(o=>{D.ev.trigger("onTouchEnd",mr(F(o.clientX,o.clientY)),o)}),r.touchToMouse!==!1&&(m.mouseStates.left="released")},We.touchcancel=()=>{r.touchToMouse!==!1&&(m.mouseStates.left="released")},We.contextmenu=function(t){t.preventDefault()},Cr.visibilitychange=()=>{switch(document.visibilityState){case"visible":m.skipTime=!0,re.paused||Q.ctx.resume();break;case"hidden":Q.ctx.suspend();break}},Ar.error=t=>{t.error?Yn(t.error):Yn(new Error(t.message))},Ar.unhandledrejection=t=>Yn(t.reason);for(let t in We)m.canvas.addEventListener(t,We[t]);for(let t in Cr)document.addEventListener(t,Cr[t]);for(let t in Ar)window.addEventListener(t,Ar[t]);function je(){return m.mousePos.clone()}s(je,"et"),h(je,"ee"),p(je,"mousePos");function di(){return m.mouseDeltaPos.clone()}s(di,"He"),h(di,"ln"),p(di,"mouseDeltaPos");function Ot(t="left"){return m.mouseStates[t]==="pressed"}s(Ot,"Rt"),h(Ot,"Fe"),p(Ot,"isMousePressed");function Kt(t="left"){return m.mouseStates[t]==="pressed"||m.mouseStates[t]==="down"}s(Kt,"pe"),h(Kt,"Et"),p(Kt,"isMouseDown");function e(t="left"){return m.mouseStates[t]==="released"}s(e,"qt"),h(e,"Je"),p(e,"isMouseReleased");function n(){return m.isMouseMoved}s(n,"Xe"),h(n,"hn"),p(n,"isMouseMoved");function a(t){return t===void 0?m.isKeyPressed:m.keyStates[t]==="pressed"}s(a,"te"),h(a,"ot"),p(a,"isKeyPressed");function l(t){return t===void 0?m.isKeyPressedRepeat:m.keyStates[t]==="pressed"||m.keyStates[t]==="rpressed"}s(l,"Ze"),h(l,"dn"),p(l,"isKeyPressedRepeat");function b(t){return t===void 0?m.numKeyDown>0:m.keyStates[t]==="pressed"||m.keyStates[t]==="rpressed"||m.keyStates[t]==="down"}s(b,"We"),h(b,"fn"),p(b,"isKeyDown");function c(t){return t===void 0?m.isKeyReleased:m.keyStates[t]==="released"}s(c,"Ae"),h(c,"St"),p(c,"isKeyReleased");function x(t){return m.virtualButtonStates[t]==="pressed"}s(x,"_e"),h(x,"mn"),p(x,"isVirtualButtonPressed");function T(t){return m.virtualButtonStates[t]==="pressed"||m.virtualButtonStates[t]==="down"}s(T,"$e"),h(T,"pn"),p(T,"isVirtualButtonDown");function C(t){return m.virtualButtonStates[t]==="released"}s(C,"tr"),h(C,"gn"),p(C,"isVirtualButtonReleased");function k(){return[...m.charInputted]}s(k,"hn"),h(k,"_r"),p(k,"charInputted");function L(){return m.time}s(L,"me"),h(L,"Ct"),p(L,"time");function H(){return m.canvas.toDataURL()}s(H,"ln"),h(H,"qr"),p(H,"screenshot");function we(t){return t&&(m.canvas.style.cursor=t),m.canvas.style.cursor}s(we,"er"),h(we,"wn"),p(we,"setCursor");function fe(t=!0){t?$r(m.canvas):Ee()}s(fe,"dn"),h(fe,"zr"),p(fe,"setFullscreen");function De(){return Boolean(Ye())}s(De,"ge"),h(De,"Tt"),p(De,"isFullscreen");function et(){return m.isTouchScreen}s(et,"rr"),h(et,"bn"),p(et,"isTouchScreen");let re={inspect:!1,timeScale:1,showLog:!0,fps:()=>m.fpsCounter.fps,numFrames:()=>m.numFrames,stepFrame:po,drawCalls:()=>U.drawCalls,clearLog:()=>D.logs=[],log:t=>{let o=r.logMax??Wr;D.logs.unshift(`${`[${L().toFixed(2)}].time `}[${t?.toString?t.toString():t}].${t instanceof Error?"error":"info"}`),D.logs.length>o&&(D.logs=D.logs.slice(0,o))},error:t=>re.log(new Error(t.toString?t.toString():t)),curRecording:null,get paused(){return m.paused},set paused(t){m.paused=t,t?Q.ctx.suspend():Q.ctx.resume()}};function ke(){return m.dt*re.timeScale}s(ke,"_"),h(ke,"Q"),p(ke,"dt");function Fe(...t){return t.length>0&&(D.cam.pos=F(...t)),D.cam.pos?D.cam.pos.clone():yn()}s(Fe,"cn"),h(Fe,"Hr"),p(Fe,"camPos");function he(...t){return t.length>0&&(D.cam.scale=F(...t)),D.cam.scale.clone()}s(he,"fn"),h(he,"$r"),p(he,"camScale");function qe(t){return t!==void 0&&(D.cam.angle=t),D.cam.angle}s(qe,"pn"),h(qe,"Yr"),p(qe,"camRot");function pt(t=12){D.cam.shake=t}s(pt,"An"),h(pt,"Xr"),p(pt,"shake");function tr(t){return D.cam.transform.multVec2(t)}s(tr,"we"),h(tr,"At"),p(tr,"toScreen");function rr(t){return D.cam.transform.invert().multVec2(t)}s(rr,"nr"),h(rr,"vn"),p(rr,"toWorld");function ir(t){let o=new pe;return t.pos&&(o=o.translate(t.pos)),t.scale&&(o=o.scale(t.scale)),t.angle&&(o=o.rotateZ(t.angle)),t.parent?o.mult(t.parent.transform):o}s(ir,"ir"),h(ir,"yn"),p(ir,"calcTransform");function An(t){let o=new Map,u={},d=new ar,R={id:Gt(),hidden:!1,paused:!1,transform:new pe,children:[],parent:null,add(f){let S=(()=>{if(Array.isArray(f))return An(f);if(f.parent)throw new Error("Cannot add a game obj that already has a parent.");return f})();return S.parent=this,S.transform=ir(S),this.children.push(S),S.trigger("add",this),D.ev.trigger("add",this),S},readd(f){let S=this.children.indexOf(f);return S!==-1&&(this.children.splice(S,1),this.children.push(f)),f},remove(f){let S=this.children.indexOf(f);S!==-1&&(f.parent=null,f.trigger("destroy"),D.ev.trigger("destroy",f),this.children.splice(S,1))},removeAll(f){this.get(f).forEach(S=>this.remove(S))},update(){this.paused||(this.get().forEach(f=>f.update()),this.trigger("update"))},draw(){this.hidden||(He(),xe(this.pos),bt(this.scale),St(this.angle),this.trigger("draw"),this.get().forEach(f=>f.draw()),Ge())},drawInspect(){this.hidden||(He(),xe(this.pos),bt(this.scale),St(this.angle),this.get().forEach(f=>f.drawInspect()),this.trigger("drawInspect"),Ge())},use(f){if(!f)return;if(typeof f=="string")return this.use({id:f});f.id&&(this.unuse(f.id),o.set(f.id,{cleanups:[]}));let S=f.id?o.get(f.id):u,M=f.id?S.cleanups:[],N=p(()=>{if(f.require){for(let I of f.require)if(!this.c(I))throw new Error(`Component "${f.id}" requires component "${I}"`)}},"checkDeps");f.destroy&&M.push(f.destroy),f.require&&!this.exists()&&S.cleanups&&M.push(this.on("add",N));for(let I in f)if(!un.has(I)){if(typeof f[I]=="function"){let z=f[I].bind(this);if(Nn.has(I)){M.push(this.on(I,z)),S[I]=z;continue}else S[I]=z}else S[I]=f[I];if(this[I]===void 0)Object.defineProperty(this,I,{get:()=>S[I],set:z=>S[I]=z,configurable:!0,enumerable:!0});else throw new Error(`Duplicate component property: "${I}"`)}this.exists()&&(N(),f.add&&f.add.call(this))},unuse(f){if(o.has(f)){let S=o.get(f);S.cleanups.forEach(M=>M());for(let M in S)delete S[M]}o.delete(f)},c(f){return o.get(f)},get(f){return this.children.filter(S=>f?S.is(f):!0).sort((S,M)=>(S.z??0)-(M.z??0))},getAll(f){return this.children.sort((S,M)=>(S.z??0)-(M.z??0)).flatMap(S=>[S,...S.getAll(f)]).filter(S=>f?S.is(f):!0)},isAncestorOf(f){return f.parent?f.parent===this||this.isAncestorOf(f.parent):!1},exists(){return D.root.isAncestorOf(this)},is(f){if(f==="*")return!0;if(Array.isArray(f)){for(let S of f)if(!this.c(S))return!1;return!0}else return this.c(f)!=null},on(f,S){return d.on(f,S.bind(this))},trigger(f,...S){d.trigger(f,...S),D.objEvents.trigger(f,this,...S)},destroy(){this.parent&&this.parent.remove(this)},inspect(){let f={};for(let[S,M]of o)f[S]=M.inspect?M.inspect():null;return f},onAdd(f){return this.on("add",f)},onUpdate(f){return this.on("update",f)},onDraw(f){return this.on("draw",f)},onDestroy(f){return this.on("destroy",f)},clearEvents(){d.clear()}};for(let f of t)R.use(f);return R}s(An,"or"),h(An,"Un"),p(An,"make");function gr(t,o,u){return D.objEvents[t]||(D.objEvents[t]=new Ie),D.objEvents.on(t,(d,...R)=>{d.is(o)&&u(d,...R)})}s(gr,"Tt"),h(gr,"Le"),p(gr,"on");function ci(t,o){if(typeof t=="function"&&o===void 0){let u=Zi([{update:t}]);return()=>u.destroy()}else if(typeof t=="string")return gr("update",t,o)}s(ci,"sr"),h(ci,"xn"),p(ci,"onUpdate");function mn(t,o){if(typeof t=="function"&&o===void 0){let u=Zi([{draw:t}]);return()=>u.destroy()}else if(typeof t=="string")return gr("draw",t,o)}s(mn,"mn"),h(mn,"Kr"),p(mn,"onDraw");function eo(t,o){if(typeof t=="function"&&o===void 0){let u=Zi([{draw:t}]);return()=>u.destroy()}else if(typeof t=="string")return gr("add",t,o)}s(eo,"ar"),h(eo,"En"),p(eo,"onAdd");function Mo(t,o){if(typeof t=="function"&&o===void 0){let u=Zi([{draw:t}]);return()=>u.destroy()}else if(typeof t=="string")return gr("destroy",t,o)}s(Mo,"gn"),h(Mo,"Qr"),p(Mo,"onDestroy");function Fo(t,o,u){return gr("collide",t,(d,R,f)=>R.is(o)&&u(d,R,f))}s(Fo,"wn"),h(Fo,"Jr"),p(Fo,"onCollide");function gn(t,o){oa(t).forEach(o),eo(t,o)}s(gn,"ee"),h(gn,"at"),p(gn,"forAllCurrentAndFuture");function Bo(t,o){if(typeof t=="function")return oo(t);{let u=[];return gn(t,d=>{if(!d.area)throw new Error("onClick() requires the object to have area() component");u.push(d.onClick(()=>o(d)))}),()=>u.forEach(d=>d())}}s(Bo,"Vn"),h(Bo,"Zr"),p(Bo,"onClick");function Uo(t,o){let u=[];return gn(t,d=>{if(!d.area)throw new Error("onHover() requires the object to have area() component");u.push(d.onHover(()=>o(d)))}),()=>u.forEach(d=>d())}s(Uo,"yn"),h(Uo,"Wr"),p(Uo,"onHover");function Po(t,o){let u=[];return gn(t,d=>{if(!d.area)throw new Error("onHoverUpdate() requires the object to have area() component");u.push(d.onHoverUpdate(()=>o(d)))}),()=>u.forEach(d=>d())}s(Po,"vn"),h(Po,"ei"),p(Po,"onHoverUpdate");function ko(t,o){let u=[];return gn(t,d=>{if(!d.area)throw new Error("onHoverEnd() requires the object to have area() component");u.push(d.onHoverEnd(()=>o(d)))}),()=>u.forEach(d=>d())}s(ko,"xn"),h(ko,"ti"),p(ko,"onHoverEnd");function to(t,o){return new Promise(u=>{D.timers.push(new br(t,()=>{o&&o(),u()}))})}s(to,"ur"),h(to,"Sn"),p(to,"wait");function Co(t,o){let u=!1,d=p(()=>{u||(o(),to(t,d))},"newF");return d(),()=>u=!0}s(Co,"En"),h(Co,"ni"),p(Co,"loop");function ro(t,o){if(Array.isArray(t)){let u=t.map(d=>ro(d,o));return()=>u.forEach(d=>d())}return D.ev.on("input",()=>b(t)&&o())}s(ro,"hr"),h(ro,"Cn"),p(ro,"onKeyDown");function nr(t,o){if(Array.isArray(t)){let u=t.map(d=>nr(d,o));return()=>u.forEach(d=>d())}else return typeof t=="function"?D.ev.on("input",()=>a()&&t()):D.ev.on("input",()=>a(t)&&o())}s(nr,"lt"),h(nr,"ue"),p(nr,"onKeyPress");function io(t,o){if(Array.isArray(t)){let u=t.map(d=>io(d,o));return()=>u.forEach(d=>d())}else return typeof t=="function"?D.ev.on("input",()=>a()&&t()):D.ev.on("input",()=>l(t)&&o())}s(io,"lr"),h(io,"Tn"),p(io,"onKeyPressRepeat");function no(t,o){if(Array.isArray(t)){let u=t.map(d=>no(d,o));return()=>u.forEach(d=>d())}else return typeof t=="function"?D.ev.on("input",()=>c()&&t()):D.ev.on("input",()=>c(t)&&o())}s(no,"dr"),h(no,"An"),p(no,"onKeyRelease");function Io(t,o){return typeof t=="function"?D.ev.on("input",()=>Kt()&&t(je())):D.ev.on("input",()=>Kt(t)&&o(je()))}s(Io,"bn"),h(Io,"ri"),p(Io,"onMouseDown");function oo(t,o){return typeof t=="function"?D.ev.on("input",()=>Ot()&&t(je())):D.ev.on("input",()=>Ot(t)&&o(je()))}s(oo,"cr"),h(oo,"On"),p(oo,"onMousePress");function No(t,o){return typeof t=="function"?D.ev.on("input",()=>e()&&t(je())):D.ev.on("input",()=>e(t)&&o(je()))}s(No,"Sn"),h(No,"ii"),p(No,"onMouseRelease");function Do(t){return D.ev.on("input",()=>n()&&t(je(),di()))}s(Do,"Rn"),h(Do,"si"),p(Do,"onMouseMove");function qo(t){return D.ev.on("input",()=>k().forEach(o=>t(o)))}s(qo,"Tn"),h(qo,"oi"),p(qo,"onCharInput");function Oo(t){return D.ev.on("onTouchStart",t)}s(Oo,"Mn"),h(Oo,"ai"),p(Oo,"onTouchStart");function Ko(t){return D.ev.on("onTouchMove",t)}s(Ko,"Fn"),h(Ko,"ui"),p(Ko,"onTouchMove");function Lo(t){return D.ev.on("onTouchEnd",t)}s(Lo,"Bn"),h(Lo,"ci"),p(Lo,"onTouchEnd");function Jo(t,o){return D.ev.on("input",()=>x(t)&&o())}s(Jo,"Un"),h(Jo,"li"),p(Jo,"onVirtualButtonPress");function zo(t,o){return D.ev.on("input",()=>T(t)&&o())}s(zo,"Pn"),h(zo,"hi"),p(zo,"onVirtualButtonDown");function Yo(t,o){return D.ev.on("input",()=>C(t)&&o())}s(Yo,"Cn"),h(Yo,"di"),p(Yo,"onVirtualButtonRelease");function so(){nr("f1",()=>{re.inspect=!re.inspect}),nr("f2",()=>{re.clearLog()}),nr("f8",()=>{re.paused=!re.paused}),nr("f7",()=>{re.timeScale=fi(Be(re.timeScale-.2,0,2),1)}),nr("f9",()=>{re.timeScale=fi(Be(re.timeScale+.2,0,2),1)}),nr("f10",()=>{re.stepFrame()})}s(so,"fr"),h(so,"Pn"),p(so,"enterDebugMode");function ao(){nr("b",si)}s(ao,"pr"),h(ao,"Rn"),p(ao,"enterBurpMode");function Go(t){return t!==void 0&&(D.gravity=t),D.gravity}s(Go,"In"),h(Go,"fi"),p(Go,"gravity");function wn(...t){return{id:"pos",pos:F(...t),moveBy(...o){this.pos=this.pos.add(F(...o))},move(...o){this.moveBy(F(...o).scale(ke()))},moveTo(...o){if(typeof o[0]=="number"&&typeof o[1]=="number")return this.moveTo(F(o[0],o[1]),o[2]);let u=o[0],d=o[1];if(d===void 0){this.pos=F(u);return}let R=u.sub(this.pos);if(R.len()<=d*ke()){this.pos=F(u);return}this.move(R.unit().scale(d))},worldPos(){return this.parent?this.parent.transform.multVec2(this.pos):this.pos},screenPos(){return this.fixed?this.pos:tr(this.pos)},inspect(){return`(${Math.round(this.pos.x)}, ${Math.round(this.pos.y)})`},drawInspect(){Rt({color:$(255,0,0),radius:4/kr()})}}}s(wn,"re"),h(wn,"ut"),p(wn,"pos");function Vn(...t){return t.length===0?Vn(1):{id:"scale",scale:F(...t),scaleTo(...o){this.scale=F(...o)},inspect(){return typeof this.scale=="number"?`${fi(this.scale,2)}`:`(${fi(this.scale.x,2)}, ${fi(this.scale.y,2)})`}}}s(Vn,"ne"),h(Vn,"ct"),p(Vn,"scale");function Qo(t){return{id:"rotate",angle:t??0,rotate(o){this.rotateBy(o*ke())},rotateBy(o){this.angle+=o},inspect(){return`${Math.round(this.angle)}`}}}s(Qo,"Nn"),h(Qo,"mi"),p(Qo,"rotate");function jo(...t){return{id:"color",color:$(...t),inspect(){return this.color.toString()}}}s(jo,"Dn"),h(jo,"pi"),p(jo,"color");function fi(t,o){return Number(t.toFixed(o))}s(fi,"Mt"),h(fi,"Be"),p(fi,"toFixed");function Zo(t){return{id:"opacity",opacity:t??1,inspect(){return`${fi(this.opacity,2)}`}}}s(Zo,"On"),h(Zo,"gi"),p(Zo,"opacity");function Ln(t){if(!t)throw new Error("Please define an anchor");return{id:"anchor",anchor:t,inspect(){return typeof this.anchor=="string"?this.anchor:this.anchor.toString()}}}s(Ln,"Ve"),h(Ln,"Ot"),p(Ln,"anchor");function Xo(t){return{id:"z",z:t,inspect(){return`${this.z}`}}}s(Xo,"qn"),h(Xo,"wi"),p(Xo,"z");function Ho(t,o){return{id:"follow",require:["pos"],follow:{obj:t,offset:o??F(0)},add(){t.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){t.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}s(Ho,"Kn"),h(Ho,"bi"),p(Ho,"follow");function Wo(t,o){let u=typeof t=="number"?ue.fromAngle(t):t.unit();return{id:"move",require:["pos"],update(){this.move(u.scale(o))}}}s(Wo,"kn"),h(Wo,"vi"),p(Wo,"move");function _o(t={}){let o=t.distance??64,u=!1;return{id:"outview",require:["pos"],isOutOfView(){let d=tr(this.pos),R=new Re(F(0),Me(),ge());return!zt(R,d)&&R.distToPoint(d)>o},onExitView(d){return this.on("exitView",d)},onEnterView(d){return this.on("enterView",d)},update(){this.isOutOfView()?(u||(this.trigger("exitView"),u=!0),t.hide&&(this.hidden=!0),t.pause&&(this.paused=!0),t.destroy&&this.destroy()):(u&&(this.trigger("enterView"),u=!1),t.hide&&(this.hidden=!1),t.pause&&(this.paused=!1))},inspect(){return`${this.isOutOfView()}`}}}s(_o,"Ln"),h(_o,"yi"),p(_o,"outview");function $o(t={}){let o=[];return{id:"area",colliding:{},collisionIgnore:t.collisionIgnore??[],add(){this.area.cursor&&o.push(this.onHover(()=>we(this.area.cursor))),o.push(this.onCollideUpdate((u,d)=>{this.colliding[u.id]||this.trigger("collide",u,d),this.colliding[u.id]=d}))},update(){for(let u in this.colliding){let d=this.colliding[u];this.checkCollision(d.target)||(delete this.colliding[u],this.trigger("collideEnd",d.target,d))}},drawInspect(){let u=this.localArea();He(),bt(this.area.scale),xe(this.area.offset);let d={outline:{width:4/kr(),color:$(0,0,255)},anchor:this.anchor,fill:!1,fixed:this.fixed};u instanceof Re?Qe({...d,pos:u.pos,width:u.width,height:u.height}):u instanceof ot?er({...d,pts:u.pts}):u instanceof yr&&Rt({...d,pos:u.center,radius:u.radius}),Ge()},destroy(){o.forEach(u=>u())},area:{shape:t.shape??null,scale:t.scale??F(1),offset:t.offset??F(0),cursor:t.cursor??null},isClicked(){return Ot()&&this.isHovering()},isHovering(){let u=this.fixed?je():rr(je());return this.hasPoint(u)},checkCollision(u){if(this===u||!u.area||!u.exists())return null;let d=this.worldArea(),R=u.worldArea();return Un(d,R)},isColliding(u){let d=this.checkCollision(u);return d&&!d.isZero()},isTouching(u){return Boolean(this.checkCollision(u))},onClick(u){return this.onUpdate(()=>{this.isClicked()&&u()})},onHover(u){let d=!1;return this.onUpdate(()=>{d?d=this.isHovering():this.isHovering()&&(d=!0,u())})},onHoverUpdate(u){return this.onUpdate(()=>{this.isHovering()&&u()})},onHoverEnd(u){let d=!1;return this.onUpdate(()=>{d?this.isHovering()||(d=!1,u()):d=this.isHovering()})},onCollide(u,d){if(typeof u=="function"&&d===void 0)return this.on("collide",u);if(typeof u=="string")return this.onCollide((R,f)=>{R.is(u)&&d(R,f)})},onCollideUpdate(u,d){if(typeof u=="function"&&d===void 0)return this.on("collideUpdate",u);if(typeof u=="string")return this.on("collideUpdate",(R,f)=>R.is(u)&&d(R,f))},onCollideEnd(u,d){if(typeof u=="function"&&d===void 0)return this.on("collideEnd",u);if(typeof u=="string")return this.on("collideEnd",R=>R.is(u)&&d(R))},hasPoint(u){return yi(this.worldArea(),u)},pushOut(u){let d=this.checkCollision(u);d&&(this.pos=this.pos.add(d))},pushOutAll(){D.root.getAll().forEach(this.pushOut)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){let u=this.localArea();if(!(u instanceof ot||u instanceof Re))throw new Error("Only support polygon and rect shapes for now");let d=this.transform.scale(F(this.area.scale??1)).translate(this.area.offset);if(u instanceof Re){let R=u.bbox(),f=Zt(this.anchor||Zr).add(1,1).scale(-.5).scale(R.width,R.height);d=d.translate(f)}return u.transform(d)},screenArea(){let u=this.worldArea();return this.fixed?u:u.transform(D.cam.transform)}}}s($o,"Jn"),h($o,"Ui"),p($o,"area");function ji(t){return{color:t.color,opacity:t.opacity,anchor:t.anchor,outline:t.outline,fixed:t.fixed,shader:t.shader,uniform:t.uniform}}s(ji,"Kt"),h(ji,"Ze"),p(ji,"getRenderProps");function Jn(t,o={}){let u=null,d=null;if(!t)throw new Error("Please pass the resource name or data to sprite()");let R=p((f,S,M,N)=>{let I=F(1,1);return M&&N?(I.x=M/(f.width*S.w),I.y=N/(f.height*S.h)):M?(I.x=M/(f.width*S.w),I.y=I.x):N&&(I.y=N/(f.height*S.h),I.x=I.y),I},"calcTexScale");return{id:"sprite",width:0,height:0,frame:o.frame||0,quad:o.quad||new Ke(0,0,1,1),animSpeed:o.animSpeed??1,draw(){!u||Pr({...ji(this),sprite:u,frame:this.frame,quad:this.quad,flipX:o.flipX,flipY:o.flipY,tiled:o.tiled,width:o.width,height:o.height})},update(){if(!u){let S=oi(t);if(!S||!S.data)return;let M=S.data.frames[0].clone();o.quad&&(M=M.scale(o.quad));let N=R(S.data.tex,M,o.width,o.height);this.width=S.data.tex.width*M.w*N.x,this.height=S.data.tex.height*M.h*N.y,o.anim&&this.play(o.anim),u=S.data,this.trigger("spriteLoaded",u)}if(!d)return;let f=u.anims[d.name];if(typeof f=="number"){this.frame=f;return}if(f.speed===0)throw new Error("Sprite anim speed cannot be 0");d.timer+=ke()*this.animSpeed,d.timer>=1/d.speed&&(d.timer=0,f.from>f.to?(this.frame--,this.frame<f.to&&(d.loop?this.frame=f.from:(this.frame++,d.onEnd(),this.stop()))):(this.frame++,this.frame>f.to&&(d.loop?this.frame=f.from:(this.frame--,d.onEnd(),this.stop()))))},play(f,S={}){if(!u){this.on("spriteLoaded",()=>{this.play(f,S)});return}let M=u.anims[f];if(!M)throw new Error(`Anim not found: ${f}`);d&&this.stop(),d=typeof M=="number"?{name:f,timer:0,loop:!1,pingpong:!1,speed:0,onEnd:()=>{}}:{name:f,timer:0,loop:S.loop??M.loop??!1,pingpong:S.pingpong??M.pingpong??!1,speed:S.speed??M.speed??10,onEnd:S.onEnd??(()=>{})},this.frame=typeof M=="number"?M:M.from,this.trigger("animStart",f)},stop(){if(!d)return;let f=d.name;d=null,this.trigger("animEnd",f)},numFrames(){return u?u.frames.length:0},curAnim(){return d?.name},flipX(f){o.flipX=f},flipY(f){o.flipY=f},onAnimEnd(f,S){return this.on("animEnd",M=>{M===f&&S()})},onAnimStart(f,S){return this.on("animStart",M=>{M===f&&S()})},renderArea(){return new Re(F(0),this.width,this.height)},inspect(){if(typeof t=="string")return`"${t}"`}}}s(Jn,"ye"),h(Jn,"Pt"),p(Jn,"sprite");function es(t,o={}){function u(d){let R=ut({...ji(d),text:d.text+"",size:d.textSize,font:d.font,width:o.width&&d.width,align:d.align,letterSpacing:d.letterSpacing,lineSpacing:d.lineSpacing,transform:d.textTransform,styles:d.textStyles});return o.width||(d.width=R.width/(d.scale?.x||1)),d.height=R.height/(d.scale?.y||1),R}return s(u,"n"),h(u,"n"),p(u,"update"),{id:"text",text:t,textSize:o.size??ur,font:o.font,width:o.width,height:0,align:o.align,lineSpacing:o.lineSpacing,letterSpacing:o.letterSpacing,textTransform:o.transform,textStyles:o.styles,add(){zn(()=>u(this))},draw(){Mt(u(this))},renderArea(){return new Re(F(0),this.width,this.height)}}}s(es,"zn"),h(es,"xi"),p(es,"text");function ts(t,o,u={}){return{id:"rect",width:t,height:o,radius:u.radius||0,draw(){Qe({...ji(this),width:this.width,height:this.height,radius:this.radius})},renderArea(){return new Re(F(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}s(ts,"Gn"),h(ts,"Ei"),p(ts,"rect");function rs(t,o){return{id:"rect",width:t,height:o,draw(){Dt({...ji(this),width:this.width,height:this.height})},renderArea(){return new Re(F(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}s(rs,"Yn"),h(rs,"Si"),p(rs,"uvquad");function is(t){return{id:"circle",radius:t,draw(){Rt({...ji(this),radius:this.radius})},renderArea(){return new yr(F(0),this.radius)},inspect(){return`${Math.ceil(this.radius)}`}}}s(is,"jn"),h(is,"Ci"),p(is,"circle");function ns(t=1,o=$(0,0,0)){return{id:"outline",outline:{width:t,color:o}}}s(ns,"Qn"),h(ns,"Ti"),p(ns,"outline");function uo(t,o){let u=new Ie;return t&&o&&u.pushd(new br(t,o)),{id:"timer",wait(d,R){return u.pushd(new br(d,R))},update(){u.forEach((d,R)=>{d.tick(ke())&&u.delete(R)})}}}s(uo,"Ar"),h(uo,"Dn"),p(uo,"timer");let Ba=640,Ua=65536;function os(t={}){let o=0,u=null,d=null,R=!1,f=[];return{id:"body",require:["pos","area"],jumpForce:t.jumpForce??Ba,gravityScale:t.gravityScale??1,isStatic:t.isStatic??!1,mass:t.mass??0,add(){f.push(this.onCollideUpdate((S,M)=>{if(!S.is("body")||M.resolved||this.isStatic&&S.isStatic)return;let N=!this.isStatic&&S.isStatic?M:M.reverse();N.source.trigger("beforePhysicsResolve",N),N.target.trigger("beforePhysicsResolve",N.reverse()),!M.resolved&&(N.source.pos=N.source.pos.add(N.displacement),N.source.transform=ir(N.source),M.resolved=!0,N.source.trigger("physicsResolve",N),N.target.trigger("physicsResolve",N.reverse()))})),f.push(this.onPhysicsResolve(S=>{D.gravity&&(S.isBottom()&&this.isFalling()?(o=0,u=S.target,d=S.target.pos,R?R=!1:this.trigger("ground",u)):S.isTop()&&this.isJumping()&&(o=0,this.trigger("headbutt",S.target)))}))},update(){if(!D.gravity||this.isStatic)return;if(R&&(u=null,d=null,this.trigger("fallOff"),R=!1),u)if(!this.isTouching(u)||!u.exists()||!u.is("body"))R=!0;else{!u.pos.eq(d)&&t.stickToPlatform!==!1&&this.moveBy(u.pos.sub(d)),d=u.pos;return}let S=o;o+=D.gravity*this.gravityScale*ke(),o=Math.min(o,t.maxVelocity??Ua),S<0&&o>=0&&this.trigger("fall"),this.move(0,o)},destroy(){f.forEach(S=>S())},onPhysicsResolve(S){return this.on("physicsResolve",S)},onBeforePhysicsResolve(S){return this.on("beforePhysicsResolve",S)},curPlatform(){return u},isGrounded(){return u!==null},isFalling(){return o>0},isJumping(){return o<0},jump(S){u=null,d=null,o=-S||-this.jumpForce},onGround(S){return this.on("ground",S)},onFall(S){return this.on("fall",S)},onFallOff(S){return this.on("fallOff",S)},onHeadbutt(S){return this.on("headbutt",S)},inspect(){return`${this.isGrounded()?"grounded":this.isJumping()?"jumping":"falling"}`}}}s(os,"Hn"),h(os,"Pi"),p(os,"body");function ss(t=2){let o=t,u=[];return{id:"doubleJump",require:["body"],numJumps:t,add(){u.push(this.onGround(()=>{o=this.numJumps}))},destroy(){u.forEach(d=>d())},doubleJump(d){o<=0||(o<this.numJumps&&this.trigger("doubleJump"),o--,this.jump(d))},onDoubleJump(d){return this.on("doubleJump",d)},inspect(){return`${o}`}}}s(ss,"Xn"),h(ss,"Ri"),p(ss,"doubleJump");function as(t,o={}){return{id:"shader",shader:t,uniform:o}}s(as,"Zn"),h(as,"Di"),p(as,"shader");function us(){return{id:"fixed",fixed:!0}}s(us,"Wn"),h(us,"Mi"),p(us,"fixed");function ho(){return{id:"stay",stay:!0}}s(ho,"mr"),h(ho,"Mn"),p(ho,"stay");function hs(t){if(t==null)throw new Error("health() requires the initial amount of hp");return{id:"health",hurt(o=1){this.setHP(t-o),this.trigger("hurt")},heal(o=1){this.setHP(t+o),this.trigger("heal")},hp(){return t},setHP(o){t=o,t<=0&&this.trigger("death")},onHurt(o){return this.on("hurt",o)},onHeal(o){return this.on("heal",o)},onDeath(o){return this.on("death",o)},inspect(){return`${t}`}}}s(hs,"_n"),h(hs,"Fi"),p(hs,"health");function ls(t,o={}){if(t==null)throw new Error("lifespan() requires time");let u=0,d=null,R=o.fade??0,f=Math.max(t-R,0);return{id:"lifespan",update(){u+=ke(),u>=f&&(d===null&&(d=this.opacity??1),this.opacity=ne(u,f,t,d,0)),u>=t&&this.destroy()}}}s(ls,"$n"),h(ls,"Li"),p(ls,"lifespan");function ds(t,o,u){if(!t)throw new Error("state() requires an initial state");let d={};function R(N){d[N]||(d[N]={enter:new Xe,end:new Xe,update:new Xe,draw:new Xe})}s(R,"c"),h(R,"h"),p(R,"initStateEvents");function f(N,I,z){return R(I),d[I][N].add(z)}s(f,"o"),h(f,"a"),p(f,"on");function S(N,I,...z){R(I),d[I][N].trigger(...z)}s(S,"d"),h(S,"l"),p(S,"trigger");let M=!1;return{id:"state",state:t,enterState(N,...I){if(M=!0,o&&!o.includes(N))throw new Error(`State not found: ${N}`);let z=this.state;if(u){if(!u?.[z])return;let te=typeof u[z]=="string"?[u[z]]:u[z];if(!te.includes(N))throw new Error(`Cannot transition state from "${z}" to "${N}". Available transitions: ${te.map(Ce=>`"${Ce}"`).join(", ")}`)}S("end",z,...I),this.state=N,S("enter",N,...I),S("enter",`${z} -> ${N}`,...I)},onStateTransition(N,I,z){return f("enter",`${N} -> ${I}`,z)},onStateEnter(N,I){return f("enter",N,I)},onStateUpdate(N,I){return f("update",N,I)},onStateDraw(N,I){return f("draw",N,I)},onStateEnd(N,I){return f("end",N,I)},update(){M||(S("enter",t),M=!0),S("update",this.state)},draw(){S("draw",this.state)},inspect(){return this.state}}}s(ds,"ti"),h(ds,"Bi"),p(ds,"state");function zn(t){Y.loaded?t():D.ev.on("load",t)}s(zn,"ve"),h(zn,"Rt"),p(zn,"onLoad");function cs(t,o){D.scenes[t]=o}s(cs,"ei"),h(cs,"Vi"),p(cs,"scene");function fs(t,...o){if(!D.scenes[t])throw new Error(`Scene not found: ${t}`);D.ev.onOnce("frameEnd",()=>{D.ev=new ar,D.objEvents=new ar,D.root.get().forEach(u=>{u.stay||D.root.remove(u)}),D.root.clearEvents(),D.timers=new Ie,D.cam={pos:null,scale:F(1),angle:0,shake:0,transform:new pe},D.gravity=0,D.scenes[t](...o),r.debug!==!1&&so(),r.burp&&ao()})}s(fs,"ri"),h(fs,"Gi"),p(fs,"go");function ps(t,o){try{return JSON.parse(window.localStorage[t])}catch{return o?(lo(t,o),o):null}}s(ps,"ni"),h(ps,"Ii"),p(ps,"getData");function lo(t,o){window.localStorage[t]=JSON.stringify(o)}s(lo,"gr"),h(lo,"Fn"),p(lo,"setData");function co(t){let o=t(En);for(let u in o)En[u]=o[u],r.global!==!1&&(window[u]=o[u]);return En}s(co,"wr"),h(co,"Ln"),p(co,"plug");function yn(){return F(Me()/2,ge()/2)}s(yn,"ie"),h(yn,"lt"),p(yn,"center");function As(t,o){return{id:"grid",gridPos:o.clone(),setGridPos(...u){let d=F(...u);this.gridPos=d.clone(),this.pos=F(this.gridPos.x*t.gridWidth(),this.gridPos.y*t.gridHeight())},moveLeft(){this.setGridPos(this.gridPos.add(F(-1,0)))},moveRight(){this.setGridPos(this.gridPos.add(F(1,0)))},moveUp(){this.setGridPos(this.gridPos.add(F(0,-1)))},moveDown(){this.setGridPos(this.gridPos.add(F(0,1)))}}}s(As,"ii"),h(As,"Ni"),p(As,"grid");function ms(t,o){if(!o.width||!o.height)throw new Error("Must provide level grid width & height.");let u=Zi([wn(o.pos??F(0))]),d=0,R={id:"level",gridWidth(){return o.width},gridHeight(){return o.height},getPos(...f){let S=F(...f);return F(S.x*o.width,S.y*o.height)},spawn(f,...S){let M=F(...S),N=(()=>{if(o[f]){if(typeof o[f]!="function")throw new Error("Level symbol def must be a function returning a component list");return o[f](M)}else if(o.any)return o.any(f,M)})();if(!N)return;let I=F(M.x*o.width,M.y*o.height);for(let z of N)if(z.id==="pos"){I.x+=z.pos.x,I.y+=z.pos.y;break}return N.push(wn(I)),N.push(As(this,M)),u.add(N)},levelWidth(){return d*o.width},levelHeight(){return t.length*o.height}};return u.use(R),t.forEach((f,S)=>{let M=f.split("");d=Math.max(M.length,d),M.forEach((N,I)=>{u.spawn(N,F(I,S))})}),u}s(ms,"oi"),h(ms,"ji"),p(ms,"addLevel");function gs(t){let o=m.canvas.captureStream(t),u=Q.ctx.createMediaStreamDestination();Q.masterNode.connect(u);let d=new MediaRecorder(o),R=[];return d.ondataavailable=f=>{f.data.size>0&&R.push(f.data)},d.onerror=()=>{Q.masterNode.disconnect(u),o.getTracks().forEach(f=>f.stop())},d.start(),{resume(){d.resume()},pause(){d.pause()},stop(){return d.stop(),Q.masterNode.disconnect(u),o.getTracks().forEach(f=>f.stop()),new Promise(f=>{d.onstop=()=>{f(new Blob(R,{type:"video/mp4"}))}})},download(f="kaboom.mp4"){this.stop().then(S=>gt(f,S))}}}s(gs,"si"),h(gs,"ki"),p(gs,"record");function ws(){return document.activeElement===m.canvas}s(ws,"ai"),h(ws,"_i"),p(ws,"isFocused");function Vs(t){t.destroy()}s(Vs,"ui"),h(Vs,"qi"),p(Vs,"destroy");let Zi=D.root.add.bind(D.root),Pa=D.root.readd.bind(D.root),ka=D.root.removeAll.bind(D.root),oa=D.root.get.bind(D.root),sa=D.root.getAll.bind(D.root);function fo(t=2,o=1){let u=0;return{id:"boom",require:["scale"],update(){let d=Math.sin(u*t)*o;d<0&&this.destroy(),this.scale=F(d),u+=ke()}}}s(fo,"Vr"),h(fo,"Gn"),p(fo,"boom");let Ca=Ct(null,$n),Ia=Ct(null,kn);function ys(t,o={}){let u=Zi([wn(t),ho()]),d=(o.speed||1)*5,R=o.scale||1;u.add([Jn(Ia),Vn(0),Ln("center"),fo(d,R),...o.comps??[]]);let f=u.add([Jn(Ca),Vn(0),Ln("center"),uo(.4/d,()=>f.use(fo(d,R))),...o.comps??[]]);return f.onDestroy(()=>u.destroy()),u}s(ys,"di"),h(ys,"Xi"),p(ys,"addKaboom");function po(){D.timers.forEach((t,o)=>{t.time-=ke(),t.time<=0&&(t.action(),D.timers.delete(o))}),D.root.update()}s(po,"yr"),h(po,"In"),p(po,"updateFrame");let Na=64;class vn{source;target;displacement;resolved=!1;constructor(o,u,d,R=!1){this.source=o,this.target=u,this.displacement=d,this.resolved=R}reverse(){return new vn(this.target,this.source,this.displacement.scale(-1),this.resolved)}isLeft(){return this.displacement.x>0}isRight(){return this.displacement.x<0}isTop(){return this.displacement.y>0}isBottom(){return this.displacement.y<0}preventResolve(){this.resolved=!0}}s(vn,"oe"),h(vn,"ht"),p(vn,"Collision");function vs(){let t={},o=r.hashGridSize||Na,u=new pe,d=[];function R(f){if(d.push(u),f.pos&&(u=u.translate(f.pos)),f.scale&&(u=u.scale(f.scale)),f.angle&&(u=u.rotateZ(f.angle)),f.transform=u.clone(),f.c("area")&&!f.paused){let S=f,M=S.worldArea().bbox(),N=Math.floor(M.pos.x/o),I=Math.floor(M.pos.y/o),z=Math.ceil((M.pos.x+M.width)/o),te=Math.ceil((M.pos.y+M.height)/o),Ce=new Set;for(let be=N;be<=z;be++)for(let At=I;At<=te;At++)if(!t[be])t[be]={},t[be][At]=[S];else if(!t[be][At])t[be][At]=[S];else{let Lt=t[be][At];for(let Vt of Lt){if(!Vt.exists()||Ce.has(Vt.id))continue;for(let Ne of S.collisionIgnore)Vt.is(Ne);for(let Ne of Vt.collisionIgnore)S.is(Ne);let Xi=S.checkCollision(Vt);if(Xi&&!Xi.isZero()){let Ne=new vn(S,Vt,Xi);S.trigger("collideUpdate",Vt,Ne);let Ve=Ne.reverse();Ve.resolved=Ne.resolved,Vt.trigger("collideUpdate",S,Ve)}Ce.add(Vt.id)}Lt.push(S)}}f.get().forEach(R),u=d.pop()}s(R,"c"),h(R,"h"),p(R,"checkObj"),R(D.root)}s(vs,"ci"),h(vs,"Qi"),p(vs,"checkFrame");function Es(){let t=D.cam,o=ue.fromAngle(sr(0,360)).scale(t.shake);t.shake=K(t.shake,0,5*ke()),t.transform=new pe().translate(yn()).scale(t.scale).rotateZ(t.angle).translate((t.pos??yn()).scale(-1).add(o)),D.root.draw(),Nt()}s(Es,"fi"),h(Es,"Ji"),p(Es,"drawFrame");function xs(){let t=me();Tt(()=>{let o=Me()/2,u=24,d=F(Me()/2,ge()/2).sub(F(o/2,u/2));Qe({pos:F(0),width:Me(),height:ge(),color:$(0,0,0)}),Qe({pos:d,width:o,height:u,fill:!1,outline:{width:4}}),Qe({pos:d,width:o*t,height:u})}),D.ev.trigger("loading",t)}s(xs,"pi"),h(xs,"Zi"),p(xs,"drawLoadScreen");function Ao(t,o){Tt(()=>{let u=F(8);He(),xe(t);let d=ut({text:o,font:Rr,size:16,pos:u,color:$(255,255,255),fixed:!0}),R=d.width+u.x*2,f=d.height+u.x*2;t.x+R>=Me()&&xe(F(-R,0)),t.y+f>=ge()&&xe(F(0,-f)),Qe({width:R,height:f,color:$(0,0,0),radius:4,opacity:.8,fixed:!0}),Mt(d),Ge()})}s(Ao,"vr"),h(Ao,"Nn"),p(Ao,"drawInspectText");function bs(){if(re.inspect){let t=null;for(let o of sa())if(o.c("area")&&o.isHovering()){t=o;break}if(D.root.drawInspect(),t){let o=[],u=t.inspect();for(let d in u)u[d]?o.push(`${d}: ${u[d]}`):o.push(`${d}`);Ao(Ir(je()),o.join(`
`))}Ao(F(8),`FPS: ${re.fps()}`)}re.paused&&Tt(()=>{He(),xe(Me(),0),xe(-8,8);let t=32;Qe({width:t,height:t,anchor:"topright",color:$(0,0,0),opacity:.8,radius:4,fixed:!0});for(let o=1;o<=2;o++)Qe({width:4,height:t*.6,anchor:"center",pos:F(-t/3*o,t*.5),color:$(255,255,255),radius:2,fixed:!0});Ge()}),re.timeScale!==1&&Tt(()=>{He(),xe(Me(),ge()),xe(-8,-8);let t=8,o=ut({text:re.timeScale.toFixed(1),font:Rr,size:16,color:$(255,255,255),pos:F(-t),anchor:"botright",fixed:!0});Qe({width:o.width+t*2+t*4,height:o.height+t*2,anchor:"botright",color:$(0,0,0),opacity:.8,radius:4,fixed:!0});for(let u=0;u<2;u++){let d=re.timeScale<1;hi({p1:F(-o.width-t*(d?2:3.5),-t),p2:F(-o.width-t*(d?2:3.5),-t-o.height),p3:F(-o.width-t*(d?3.5:2),-t-o.height/2),pos:F(-u*t*1+(d?-t*.5:0),0),color:$(255,255,255),fixed:!0})}Mt(o),Ge()}),re.curRecording&&Tt(()=>{He(),xe(0,ge()),xe(24,-24),Rt({radius:12,color:$(255,0,0),opacity:Jr(0,1,L()*4),fixed:!0}),Ge()}),re.showLog&&D.logs.length>0&&Tt(()=>{He(),xe(0,ge()),xe(8,-8);let t=8,o=ut({text:D.logs.join(`
`),font:Rr,pos:F(t,-t),anchor:"botleft",size:16,width:Me()*.6,lineSpacing:t/2,fixed:!0,styles:{time:{color:$(127,127,127)},info:{color:$(255,255,255)},error:{color:$(255,0,127)}}});Qe({width:o.width+t*2,height:o.height+t*2,anchor:"botleft",color:$(0,0,0),radius:4,opacity:.8,fixed:!0}),Mt(o),Ge()})}s(bs,"Ai"),h(bs,"Wi"),p(bs,"drawDebug");function Ss(){let t=je(),o=p((d,R,f)=>{Rt({radius:80/2,pos:d,outline:{width:4,color:$(0,0,0)},opacity:.5}),f&&pr({text:f,pos:d,color:$(0,0,0),size:40,anchor:"center",opacity:.5}),Ot("left")&&Vi(new yr(d,80/2),t)&&D.ev.onOnce("frameEnd",()=>{m.virtualButtonStates[R]="pressed",m.keyStates[R]="pressed"}),e("left")&&D.ev.onOnce("frameEnd",()=>{m.virtualButtonStates[R]="released",m.keyStates[R]="released"})},"drawCircleButton"),u=p((d,R,f)=>{Qe({width:64,height:64,pos:d,outline:{width:4,color:$(0,0,0)},radius:4,anchor:"center",opacity:.5}),f&&pr({text:f,pos:d,color:$(0,0,0),size:40,anchor:"center",opacity:.5}),Ot("left")&&zt(new Re(d.add(-64/2,-64/2),64,64),t)&&D.ev.onOnce("frameEnd",()=>{m.virtualButtonStates[R]="pressed",m.keyStates[R]="pressed"}),e("left")&&D.ev.onOnce("frameEnd",()=>{m.virtualButtonStates[R]="released",m.keyStates[R]="released"})},"drawSquareButton");Tt(()=>{o(F(Me()-80,ge()-160),"a"),o(F(Me()-160,ge()-80),"b"),u(F(60,ge()-124),"left"),u(F(188,ge()-124),"right"),u(F(124,ge()-188),"up"),u(F(124,ge()-60),"down")})}s(Ss,"mi"),h(Ss,"es"),p(Ss,"drawVirtualControls"),r.debug!==!1&&so(),r.burp&&ao();function Rs(t){D.ev.on("loading",t)}s(Rs,"gi"),h(Rs,"ts"),p(Rs,"onLoadUpdate");function Ts(t){D.ev.on("resize",t)}s(Ts,"wi"),h(Ts,"ns"),p(Ts,"onResize");function Ms(t){D.ev.on("error",t)}s(Ms,"Vi"),h(Ms,"rs"),p(Ms,"onError");function Yn(t){mo(()=>{Tt(()=>{let o=Me(),u=ge(),d={size:36,width:o-32*2,letterSpacing:4,lineSpacing:4,font:Rr,fixed:!0};Qe({width:o,height:u,color:$(0,0,255),fixed:!0});let R=ut({...d,text:t.name,pos:F(32),color:$(255,128,0),fixed:!0});Mt(R),pr({...d,text:t.message,pos:F(32,32+R.height+16),fixed:!0}),Ge(),D.ev.trigger("error",t)})})}s(Yn,"xe"),h(Yn,"Dt"),p(Yn,"handleErr");function Fs(){for(let t in m.keyStates)m.keyStates[t]=jt(m.keyStates[t]);for(let t in m.mouseStates)m.mouseStates[t]=jt(m.mouseStates[t]);for(let t in m.virtualButtonStates)m.virtualButtonStates[t]=jt(m.virtualButtonStates[t]);m.charInputted=[],m.isMouseMoved=!1,m.isKeyPressed=!1,m.isKeyPressedRepeat=!1,m.isKeyReleased=!1}s(Fs,"yi"),h(Fs,"is"),p(Fs,"resetInputState");function mo(t){m.loopID!==null&&cancelAnimationFrame(m.loopID);let o=p(u=>{if(m.stopped)return;if(document.visibilityState!=="visible"){m.loopID=requestAnimationFrame(o);return}let d=u/1e3,R=d-m.realTime;m.realTime=d,m.skipTime||(m.dt=R,m.time+=ke(),m.fpsCounter.tick(m.dt)),m.skipTime=!1,m.numFrames++,On(),t(),Ki(),Fs(),D.ev.trigger("frameEnd"),m.loopID=requestAnimationFrame(o)},"frame");o(0)}s(mo,"xr"),h(mo,"jn"),p(mo,"run");function Bs(){D.ev.onOnce("frameEnd",()=>{m.stopped=!0,g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT);let t=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);for(let o=0;o<t;o++)g.activeTexture(g.TEXTURE0+o),g.bindTexture(g.TEXTURE_2D,null),g.bindTexture(g.TEXTURE_CUBE_MAP,null);g.bindBuffer(g.ARRAY_BUFFER,null),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,null),g.bindRenderbuffer(g.RENDERBUFFER,null),g.bindFramebuffer(g.FRAMEBUFFER,null),w.forEach(o=>o()),g.deleteBuffer(U.vbuf),g.deleteBuffer(U.ibuf);for(let o in We)m.canvas.removeEventListener(o,We[o]);for(let o in Cr)document.removeEventListener(o,Cr[o]);for(let o in Ar)window.removeEventListener(o,Ar[o])})}s(Bs,"vi"),h(Bs,"ss"),p(Bs,"quit"),ft("happy",Pn,28,36),mo(()=>{Y.loaded||me()===1&&(Y.loaded=!0,D.ev.trigger("load")),!Y.loaded&&r.loadingScreen!==!1?xs():(D.ev.trigger("input"),re.paused||po(),vs(),Es(),r.debug!==!1&&bs(),r.virtualControls&&et()&&Ss())});function Us(t,o,u,d,R=Le.linear){let f=0,S=ci(()=>{f+=ke();let M=Math.min(f/u,1);d(K(t,o,R(M))),M===1&&S()});return S}s(Us,"xi"),h(Us,"os"),p(Us,"tween");let En={VERSION:Cn,loadRoot:xt,loadProgress:me,loadSprite:Ct,loadSpriteAtlas:Br,loadSound:Ii,loadBitmapFont:ft,loadFont:ct,loadShader:Ci,loadAseprite:lr,loadPedit:hr,loadBean:It,load:Te,getSprite:ri,getSound:dr,getFont:Ni,getBitmapFont:ii,getShader:ni,Asset:G,SpriteData:Z,SoundData:X,width:Me,height:ge,center:yn,dt:ke,time:L,screenshot:H,record:gs,isFocused:ws,setCursor:we,setFullscreen:fe,isFullscreen:De,isTouchScreen:et,onLoad:zn,onLoadUpdate:Rs,onResize:Ts,onError:Ms,camPos:Fe,camScale:he,camRot:qe,shake:pt,toScreen:tr,toWorld:rr,gravity:Go,add:Zi,destroy:Vs,destroyAll:ka,get:oa,getAll:sa,readd:Pa,pos:wn,scale:Vn,rotate:Qo,color:jo,opacity:Zo,anchor:Ln,area:$o,sprite:Jn,text:es,rect:ts,circle:is,uvquad:rs,outline:ns,body:os,doubleJump:ss,shader:as,timer:uo,fixed:us,stay:ho,health:hs,lifespan:ls,z:Xo,move:Wo,outview:_o,follow:Ho,state:ds,on:gr,onUpdate:ci,onDraw:mn,onAdd:eo,onDestroy:Mo,onCollide:Fo,onClick:Bo,onHover:Uo,onHoverUpdate:Po,onHoverEnd:ko,onKeyDown:ro,onKeyPress:nr,onKeyPressRepeat:io,onKeyRelease:no,onMouseDown:Io,onMousePress:oo,onMouseRelease:No,onMouseMove:Do,onCharInput:qo,onTouchStart:Oo,onTouchMove:Ko,onTouchEnd:Lo,onVirtualButtonPress:Jo,onVirtualButtonDown:zo,onVirtualButtonRelease:Yo,mousePos:je,mouseDeltaPos:di,isKeyDown:b,isKeyPressed:a,isKeyPressedRepeat:l,isKeyReleased:c,isMouseDown:Kt,isMousePressed:Ot,isMouseReleased:e,isMouseMoved:n,isVirtualButtonPressed:x,isVirtualButtonDown:T,isVirtualButtonReleased:C,loop:Co,wait:to,play:_t,volume:qi,burp:si,audioCtx:Q.ctx,Timer:br,Line:de,Rect:Re,Circle:yr,Polygon:ot,Vec2:ue,Color:oe,Mat4:pe,Quad:Ke,RNG:Ai,rand:sr,randi:Bt,randSeed:zr,vec2:F,rgb:$,hsl2rgb:Bn,quad:Lr,choose:wr,chance:Yr,lerp:K,tween:Us,easings:Le,map:ne,mapc:_e,wave:Jr,deg2rad:Je,rad2deg:it,testLineLine:Ze,testRectRect:gi,testRectLine:wi,testRectPoint:zt,drawSprite:Pr,drawText:pr,formatText:ut,drawRect:Qe,drawLine:$t,drawLines:ui,drawTriangle:hi,drawCircle:Rt,drawEllipse:qt,drawUVQuad:Dt,drawPolygon:er,drawFormattedText:Mt,drawMasked:dn,drawSubtracted:cn,pushTransform:He,popTransform:Ge,pushTranslate:xe,pushScale:bt,pushRotate:Gi,pushRotateX:zi,pushRotateY:Yi,pushRotateZ:St,pushMatrix:Ji,debug:re,scene:cs,go:fs,addLevel:ms,getData:ps,setData:lo,download:vt,downloadJSON:Gr,downloadText:Er,downloadBlob:gt,plug:co,ASCII_CHARS:sn,canvas:m.canvas,addKaboom:ys,LEFT:ue.LEFT,RIGHT:ue.RIGHT,UP:ue.UP,DOWN:ue.DOWN,RED:oe.RED,GREEN:oe.GREEN,BLUE:oe.BLUE,YELLOW:oe.YELLOW,MAGENTA:oe.MAGENTA,CYAN:oe.CYAN,WHITE:oe.WHITE,BLACK:oe.BLACK,quit:Bs};if(r.plugins&&r.plugins.forEach(co),r.global!==!1)for(let t in En)window[t]=En[t];return En},"default");function kt(r,w){return{id:"fade",add(){switch(r){case"in":this.fadeIn(w??1);break;case"out":this.fadeOut(w??1);break;default:break}},fadeIn(m=1){tween(this.opacity??0,1,m,g=>{this.opacity=g},easings.linear)},fadeOut(m=1){tween(this.opacity??1,0,m,g=>{this.opacity=g},easings.linear)}}}s(kt,"Ct"),h(kt,"fade");function Ui(r){return!r||r.length<2?null:vec2(r[0],r[1])}s(Ui,"io"),h(Ui,"array2Vec2");function Pi(r,w){let m=document.createElement("a");m.href=w,m.download=r,m.click()}s(Pi,"oo"),h(Pi,"download");function ki(){let r,w;return{id:"kn_tb_comp",require:[],curChar:0,skipped:!1,addEx(){r=this.get("kn_tb_textbox")[0],w=this.get("kn_nb_namebox")[0]},write(m){return new Promise(g=>{r.text="";let O=loop(.05,()=>{if(this.skipped)return this.skipped=!1,r.text=m,this.curChar=0,g(),O();if(r.text+=m[this.curChar],this.curChar++,this.curChar==m.length)return this.curChar=0,g(),O()})})},setName(m,g){w.text=m,w.use(color(g?Color.fromHex(String(g)):rgb(255,255,255)))},skipText(){this.skipped||(this.skipped=!0)},show(m=1){this.children.forEach(g=>{g.use(kt("in",m))})},hide(m=1){this.children.forEach(g=>{g.use(kt("out",m))})}}}s(ki,"Zo"),h(ki,"textbox");function Xt(r,w={},m={}){let g={pos:Ui(w.pos),width:w.width??r.width(),height:w.height??r.height()/8,sprite:w.sprite??null,size:w.size??42,font:w.font??"Sans-Serif",color:w.color?r.Color.fromHex(w.color):BLACK,border:w.border??[5,0,0,5]},O={border:m.border??[0,0,0,0],size:m.size??82},U=g.sprite?r.getSprite(g.sprite).data?.tex.height:g.height,Z=g.sprite?r.getSprite(g.sprite).data?.tex.width:g.width,X=r.width()-(r.width()-Z),Q=r.add([r.pos(g.pos??r.vec2(r.center().x,r.height()-U/2)),r.z(999),r.anchor("center"),ki()]);return Q.add([r.pos(0,0),r.z(0),r.anchor("center"),g.sprite?r.sprite(g.sprite):r.rect(g.width,g.height),"kn_tb_background"]),Q.add([r.pos(0-Z/2+g.border[3],0-U/2+g.border[0]),r.z(1),r.anchor("topleft"),r.text("",{size:g.size,font:w.font,width:X-g.border[3],align:"left"}),r.color(g.color),"kn_tb_textbox"]),Q.add([r.pos(0-Z/2+O.border[3],0-U/2+O.border[0])]),Q.add([r.pos(0-Z/2+O.border[3],0-U/2+O.border[0]),r.z(1),r.anchor("botleft"),r.text("",{size:O.size}),"kn_nb_namebox"]),Q.addEx(),Q}s(Xt,"so"),h(Xt,"addTextbox");var ei;function hn(r={}){let w={width:r.width??1280,height:r.height??720,letterbox:r.letterbox??!0,stretch:r.stretch??!0,plugins:[ti],textbox:r.textbox||{},namebox:r.namebox||{}};Dn(w),ei=w}s(hn,"Wo"),h(hn,"kanovel");function ti(r){let w=new Map,m=new Map,g=new Map,O="start",U=-1,Z=!1,X;async function Q(){Z=!0,U++;let J=m.get(O)[U];if(!J)return Z=!1;await J.run(),Z=!1,J.autoskip&&Q()}s(Q,"E"),h(Q,"nextAction");function G(){let J=m.get(O)[U];J.skip&&J.skip()}s(G,"M"),h(G,"skipAction");function ce(J,ae){if(m.get(J))throw new Error(`You can't repeat the chapter name! "${J}"`);m.set(J,ae())}s(ce,"C"),h(ce,"addChapter");function Y(J){if(!m.get(J))throw new Error(`Chapter not found: ${J}`);O=J,U=-1}s(Y,"x"),h(Y,"changeChapter");function D(J){let ae=r.play(J);g.set(J,ae)}s(D,"w"),h(D,"addAudio");function Te(J){g.get(J)?.stop(),g.delete(J)}s(Te,"z"),h(Te,"removeAudio");function me(J,ae,$e){let ct=w.get(J);if(!ct)throw Error("Character's id not found.");let ft=ct.opt.expressions?.[ae];if(!ft)throw Error(`Character's expression ${ae} not found.`);let Ht={left:[r.anchor("botleft"),r.pos(0,r.height())],center:[r.anchor("bot"),r.pos(r.center().x,r.height())],right:[r.anchor("botright"),r.pos(r.width(),r.height())]};r.add([...Ht[$e],r.z(100),r.sprite(ft),r.opacity(0),kt("in",.4),ct.id])}s(me,"q"),h(me,"showCharacter");function xt(J){let ae=w.get(J);if(!ae)throw Error("Character's id not found.");r.get(ae.id)[0].destroy()}s(xt,"xt"),h(xt,"hideCharacter");function lt(J){r.add([r.pos(r.center()),r.anchor("center"),r.sprite(J),kt(),"bg"])}s(lt,"dt"),h(lt,"showBackground");function dt(J,ae){r.add([r.pos(r.center()),r.anchor("center"),r.rect(r.width(),r.height()),r.color(Color.fromHex(J)),ae?kt("in"):{},"kn_game_background"])}return s(dt,"ct"),h(dt,"showBackgroundColor"),r.scene("kanovel",()=>{if(r.volume(.5),!m.get("start"))throw Error("Should define a start chapter.");X=Xt(r,ei.textbox??{},ei.namebox),Q(),r.onUpdate(()=>{if((r.isMousePressed("left")||r.isKeyPressed("space"))&&(Z?G():Q()),r.isKeyPressed("s")){let J=onDraw(()=>{Pi("screenshot.png",r.screenshot()),J()})}})}),r.onLoad(()=>{r.go("kanovel")}),{chapter(J,ae){ce(J,ae)},character(J,ae,$e){w.set(J,{id:J,name:ae,opt:$e})},say(...J){if(J.length===2){let ae=w.get(J[0]);if(!ae)throw Error("Character not found");return{id:"say",async run(){X.setName(ae.name,ae.opt?.color),await X.write(J[1])},skip(){X.skipText()}}}else return{id:"say",async run(){X.setName(" "),await X.write(J[0])},skip(){X.skipText()}}},show(J,ae,$e="center"){return{id:"show",autoskip:!0,run(){me(J,ae,$e)},noSkip(){return this.autoskip=!1,this}}},hide(J){return{id:"hide",run(){xt(J)}}},jump(J){return{id:"jump",autoskip:!0,run(){Y(J)}}},showBackground(){return{id:"showBackground",autoskip:!0,run(){lt("a")}}},showBackgroundColor(J,ae){return{id:"showBackgroundColor",autoskip:!0,run(){dt(J,ae)}}},showTextbox(J){return{id:"showTextbox",run(){X.show(J)}}},hideTextbox(J){return{id:"hideTextbox",run(){X.hide(J)}}},playMusic(J){return{id:"play",autoskip:!0,async run(){D(J)}}},stopMusic(J){return{id:"stop",autoskip:!0,async run(){Te(J)}}}}}s(ti,"ao"),h(ti,"kanovelPlugin");var qn=hn;return _(j)})();Fa({width:600,height:300,textbox:{sprite:"textbox",size:14,width:500,height:40},namebox:{size:20}});loadSprite("tere-neutral","./sprites/expressions/tere-neutral.png");loadSprite("textbox","./sprites/textbox.png");character("t","Tere",{color:"#1f102a",expressions:{neutral:"tere-neutral"}});chapter("start",()=>[showBackgroundColor("#f0dada"),show("t","neutral"),say("t","Hey there! Welcome to this epic and great visual novel engine"),say("t","KaNovel!"),say("t","With KaNovel, you can make... Visual novels!"),jump("then")]);chapter("then",()=>[say("Visual Novels???"),say("t","Yes! And it's easy")]);})();
